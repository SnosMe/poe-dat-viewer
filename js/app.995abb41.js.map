{"version":3,"sources":["webpack://poe-dat-viewer/./src/assets/discord-badge.svg","webpack://poe-dat-viewer/./src/app/workbench/Workbench.vue","webpack://poe-dat-viewer/./src/app/workbench/Tabs.vue","webpack://poe-dat-viewer/./src/app/workbench/ImportDialog.vue","webpack://poe-dat-viewer/./src/app/patchcdn/cache.ts","webpack://poe-dat-viewer/./src/app/worker/script.ts","webpack://poe-dat-viewer/./src/app/worker/interface.ts","webpack://poe-dat-viewer/./src/app/patchcdn/index-store.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/db.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/components/DatViewer.vue","webpack://poe-dat-viewer/./src/ResizeObserver.vue","webpack://poe-dat-viewer/./src/ResizeObserver.vue?a792","webpack://poe-dat-viewer/./src/ResizeObserver.vue?cf99","webpack://poe-dat-viewer/./src/CanvasScroll.vue","webpack://poe-dat-viewer/./src/CanvasScroll.vue?f261","webpack://poe-dat-viewer/./src/CanvasScroll.vue?1322","webpack://poe-dat-viewer/./src/CanvasScroll.vue?74cb","webpack://poe-dat-viewer/./src/app/dat-viewer/selection.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/headers.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/Viewer.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/components/Actions.vue","webpack://poe-dat-viewer/./src/app/dat-viewer/components/Actions.vue?b7ad","webpack://poe-dat-viewer/./src/app/dat-viewer/components/Actions.vue?5f5c","webpack://poe-dat-viewer/./src/app/dat-viewer/components/Actions.vue?d227","webpack://poe-dat-viewer/./src/app/dat-viewer/components/ViewerHead.vue","webpack://poe-dat-viewer/./src/app/dat-viewer/sorting.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/rendering/content.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/rendering.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/rendering/header-columns.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/components/ViewerHead.vue?8993","webpack://poe-dat-viewer/./src/app/dat-viewer/components/ViewerHead.vue?7ebc","webpack://poe-dat-viewer/./src/app/dat-viewer/components/HeaderProps.vue","webpack://poe-dat-viewer/./src/app/dat-viewer/components/HeaderProps.vue?f7fd","webpack://poe-dat-viewer/./src/app/dat-viewer/components/HeaderProps.vue?f727","webpack://poe-dat-viewer/./src/app/dat-viewer/rendering/byte-columns.ts","webpack://poe-dat-viewer/./src/app/dat-viewer/components/DatViewer.vue?1d53","webpack://poe-dat-viewer/./src/app/dat-viewer/components/DatViewer.vue?55d3","webpack://poe-dat-viewer/./src/app/dat-viewer/components/DatViewer.vue?eecc","webpack://poe-dat-viewer/./src/app/workbench/ImportDialog.vue?fb9a","webpack://poe-dat-viewer/./src/app/workbench/ImportDialog.vue?9b8c","webpack://poe-dat-viewer/./src/app/workbench/ImportDialog.vue?73a9","webpack://poe-dat-viewer/./src/app/workbench/workbench-core.ts","webpack://poe-dat-viewer/./src/app/workbench/Tabs.vue?ddb9","webpack://poe-dat-viewer/./src/app/workbench/Tabs.vue?9eef","webpack://poe-dat-viewer/./src/app/workbench/Tabs.vue?8209","webpack://poe-dat-viewer/./src/app/workbench/IndexTree.vue","webpack://poe-dat-viewer/./src/VirtualScroll.vue","webpack://poe-dat-viewer/./src/VirtualScroll.vue?7b8c","webpack://poe-dat-viewer/./src/VirtualScroll.vue?382d","webpack://poe-dat-viewer/./src/perf.ts","webpack://poe-dat-viewer/./src/app/workbench/IndexTree.vue?d3d3","webpack://poe-dat-viewer/./src/app/workbench/IndexTree.vue?efb6","webpack://poe-dat-viewer/./src/app/workbench/IndexTree.vue?0845","webpack://poe-dat-viewer/./src/app/workbench/DownloadProgress.vue","webpack://poe-dat-viewer/./src/app/workbench/DownloadProgress.vue?c770","webpack://poe-dat-viewer/./src/app/workbench/DownloadProgress.vue?dead","webpack://poe-dat-viewer/./src/app/workbench/DownloadProgress.vue?1433","webpack://poe-dat-viewer/./src/app/workbench/Workbench.vue?9e13","webpack://poe-dat-viewer/./src/app/workbench/Workbench.vue?368e","webpack://poe-dat-viewer/./src/main.ts","webpack://poe-dat-viewer/webpack/bootstrap","webpack://poe-dat-viewer/webpack/runtime/chunk loaded","webpack://poe-dat-viewer/webpack/runtime/compat get default export","webpack://poe-dat-viewer/webpack/runtime/define property getters","webpack://poe-dat-viewer/webpack/runtime/global","webpack://poe-dat-viewer/webpack/runtime/hasOwnProperty shorthand","webpack://poe-dat-viewer/webpack/runtime/publicPath","webpack://poe-dat-viewer/webpack/runtime/jsonp chunk loading","webpack://poe-dat-viewer/webpack/startup"],"names":["class","href","src","activeTab","type","args","key","id","kaState","appVersion","title","$style","titlebar","tabs","tab","active","isActive","setActiveTab","closeTab","openImport","style","for","target","value","readonly","input","label","poePatch","placeholder","cdnImport","disabled","isCdnImportRunning","loading","accept","handleFile","BUNDLE_DIR","progress","totalSize","received","bundleName","async","fetchFile","patchVer","name","localStorage","getItem","Error","_fetchFile","e","window","alert","path","cache","caches","open","res","match","fetch","status","statusText","buf","Number","headers","get","reader","body","getReader","chunks","done","read","push","length","Uint8Array","bufPos","chunk","set","delete","put","Response","String","byteLength","buffer","arrayBuffer","Worker_fn","Worker","thread","decompressBundle","bundle","byteOffset","decompressSliceInBundle","bundleSlice","slice","decompressFileTransferBundle","offset","size","analyzeDatFile","datFile","index","loadFileContent","fullPath","location","bundlesInfo","filesInfo","bundleBin","loadIndex","indexBin","indexBundle","_index","dirsInfo","pathReps","pathRepsBundle","publicSchema","db","upgrade","createObjectStore","keyPath","findByName","record","fromJsonSchema","saveHeaders","serializeHeaders","map","header","string","array","boolean","decimal","integer","undefined","sch","find","s","columns","column","unsigned","foreign","textLength","handleResize","headerBlockStyle","headerOverlayContentStyle","left","scrollLeft","width","rowsWidth","renderColumns","ref","handleScroll","scrollableStyle","scrollablePaintSize","scrollableFullSize","handleCanvasClick","rowsOverlay","rowsOverlayStyle","renderItems","top","ids","rowIdx","i","LINE_HEIGHT","rowsNumberWidth","position","focusEditingHeader","tag","props","default","emits","setup","ctx","rootEl","resizeObserver","ResizeObserver","entries","emit","contentRect","height","observe","unobserve","scrollable","paintSize","handleMousedown","handleMousewheel","track","y","handleTrackMousedownY","scrollbarY","fixedSize","trackSize","thumb","x","handleTrackMousedownX","scrollbarX","MIN_THUMB_SIZE","SCROLL_DIR_THRESHOLD","WHEEL_SCROLL_SPEED","SCROLL_ACCELERATION_FN","dt","Math","max","pow","sign","scrollbar","scrollSize","otherScrollbar","scrollPos","thumbSize","floor","thumbRatio","thumbPos","round","useMouseMiddleButtonScroll","scrollByDelta","startY","startX","deltaY","deltaX","direction","rafTime","rafId","button","preventDefault","stopPropagation","document","cursor","clientY","clientX","requestAnimationFrame","scrollEachFrame","addEventListener","handleMouseMove","cancelScroll","cancelAnimationFrame","removeEventListener","removeProperty","dy","dx","abs","time","dtTime","useMouseWheelScroll","useScrollbarScroll","axis","scrollTo","start","rectProp","mEventProp","handleTrackMousedown","trackEl","currentTarget","getBoundingClientRect","thumbEl","Object","required","fullSize","widthY","widthX","min","deep","cssModules","selectColsByHeader","selection","toggleColsBetween","a","b","end","filter","hdr","byteView","some","clearColumnSelection","fill","getColumnSelections","ranges","last","idx","indexOf","curr","removeHeadersAtOffsets","offsets","removeHeader","createHeaderFromSelected","selections","selected","emptyHeader","updatedHeaders","splice","merged","mergeEmptyHeaders","h1","h2","createViewer","fileContent","parsed","viewer","rowLength","getNamePart","columnStats","columnSelection","Array","editHeader","selectedRow","rowSorting","then","stats","tryImportHeaders","message","serialized","hdrSerialized","headerLength","getHeaderLength","isValid","headerCreated","assign","exportAllRows","data","data_","every","row","entry","unknown","rid","unshift","rowCount","_","fromEntries","col","bar","defineColumn","range","exportDataJson","join","File","JSON","stringify","headersRowStyle","border","widthPx","transform","leftPx","handleHeaderWheel","$event","colsRowStyle","selectStart","selectContinue","text","statsRowStyle","stat","sortRows","order","rows","from","sort","ai","bi","localeCompare","numberToString","out","color","numberArrayToString","booleanToString","booleanArrayToString","stringToString","stringArrayToString","str","keySelfToString","keySelfArrayToString","keyForeignToString","keyForeignArrayToString","renderCellContent","getFieldReader","draw","textY","prevColor","fillStyle","fillText","drawByteView","begin","dataFixed","subarray","hexDump","byte","toString","padStart","CHAR_WIDTH","drawArrayVarData","refArray","entryMaxLength","keyForeign","fieldSize","KEY_FOREIGN","keySelf","KEY","STRING","longLong","LONGLONG","long","LONG","short","SHORT","maxReadBytes","ceil","arrayLength","readerFixed","getSizeT","varOffset","memsize","dataVariable","FONT_FAMILY","FONT_SIZE","getMonoFontWidth","XBASE_HEIGHT","getFontBaseLine","ROWNUM_MIN_LENGTH","BORDER_WIDTH","COLUMN_STAT_HEIGHT","COLUMN_BYTE_HEIGHT","HEADERS_HEIGHT","rowNumLength","maxLen","rowsNumWidth","fontSize","fontFamily","canvasEl","createElement","context","getContext","font","metrics","measureText","textBaseline","xBase","alphabeticBaseline","actualBoundingBoxDescent","getBaseLine","lineHeight","drawRows","params","fillRect","canvas","selectedIdx","save","translate","drawColumns","restore","renderers","getColumnRenderers","paintWidth","render","beginPath","rect","clip","exec","grdH","createLinearGradient","addColorStop","grdV","paintBegin","paintEnd","sizes","columnSizes","borderWidth","paddingWidth","hexBegin","hexEnd","hasBorder","getRowWidth","renderHeaderCols","activeHeader","sortOrder","selectionStart","colsBeforeSelection","cancelSelection","buttons","len","h","ctrlKey","$emit","close","spellcheck","viewModeOpts","opt","byteViewMode","remove","dataTypeOpts","dataType","arrayTypeOpts","arrayType","opts","ARRAY","refString","bMax","headerRef","watchStop","mode","isVisible","BYTE_WIDTH","renderByteCols","textLeft","thisWidth","renderColStats","nullable","zero","k","nullableMemsize","components","CanvasScroll","ViewerActions","ViewerHead","HeaderProps","canvasRef","canvasScroll","rowIndices","paintHeight","sz","pos","rowsFullWidth","rowsFullHeight","rowsOverlayWidth","rowsHeight","dpr","devicePixelRatio","alpha","scale","renderStats","scrollTop","count","startIdx","cols","sortedIdx","offsetY","realIdx","isFetchingSchema","elFile","files","fileName","openTab","DatViewer","setItem","fetchSchema","response","schema","json","version","SCHEMA_VERSION","tables","console","warn","activeTabId","ImportDialog","existing","findIndex","_tabs","showTree","treeToggle","toggleTree","searchText","searchInput","extensionOpts","handleClick","isIndexLoaded","tree","items","item","itemBtn","handleTreeNav","isFile","scrollableProps","itemHeight","Date","now","desc","log","fn","cb","t$","useTreeNavigation","currentDir","dirs","dirName","content","split","substr","endsWith","substring","lastIndexOf","VirtualScroll","Boolean","searchExtension","startsWith","ext","filteredTree","term","toLowerCase","includes","notification","toFixed","IndexTree","ViewerTabs","DownloadProgress","Workbench","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","result","chunkIds","priority","notFulfilled","Infinity","fulfilled","j","keys","n","getter","__esModule","d","definition","o","defineProperty","enumerable","g","globalThis","this","Function","obj","prop","prototype","hasOwnProperty","p","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","chunkLoadingGlobal","self","forEach","bind","__webpack_exports__"],"mappings":"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","file":"js/app.995abb41.js","sourcesContent":["export default __webpack_public_path__ + \"img/discord-badge.59203335.svg\";","<template>\n  <index-tree />\n  <div class=\"layout-column flex-1 min-w-0\">\n    <viewer-tabs />\n    <div class=\"layout-column flex-1 min-h-0\">\n      <component\n        v-if=\"activeTab\"\n        :is=\"activeTab.type\"\n        :args=\"activeTab.args\"\n        :key=\"activeTab.id\"\n        v-model:ka-state=\"activeTab.kaState\" />\n      <div v-else\n        class=\"bg-gray-50 flex-1 text-lg text-gray-500 flex items-center justify-center\"\n        >The viewer is ready to fulfill your wishes 👾</div>\n    </div>\n    <div class=\"app-footer\">\n      <div>Made by Alexander Drozdov, v{{ appVersion }} <a class=\"q-link text-white border-b\" href=\"https://github.com/SnosMe/poe-dat-viewer\">GitHub</a></div>\n      <a href=\"https://discord.gg/SJjBdT3\" class=\"flex ml-8\"><img src=\"@/assets/discord-badge.svg\" /></a>\n    </div>\n  </div>\n  <download-progress />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport ViewerTabs from './Tabs.vue'\nimport IndexTree from './IndexTree.vue'\nimport DownloadProgress from './DownloadProgress.vue'\nimport { tabs, activeTabId } from './workbench-core'\n\nexport default defineComponent({\n  components: { IndexTree, ViewerTabs, DownloadProgress },\n  setup () {\n    const activeTab = computed(() =>\n      tabs.value.find(tab => tab.id === activeTabId.value)\n    )\n\n    return {\n      activeTab,\n      appVersion: process.env.APP_VERSION\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\">\n@tailwind base;\n@tailwind utilities;\n@import \"~vscode-codicons/dist/codicon.css\";\n\n* {\n  outline: none !important;\n}\n\n.codicon {\n  vertical-align: text-bottom;\n}\n\n#app {\n  display: flex;\n  height: 100vh;\n  width: 100vw;\n  overflow: hidden;\n  font-size: 13px;\n  line-height: 1.5;\n}\n\n.layout-column {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.app-footer {\n  line-height: 1;\n  align-items: center;\n  display: flex;\n  @apply bg-gray-700;\n  @apply text-white;\n  @apply p-2;\n\n  img {\n    filter: grayscale(0.75);\n  }\n\n  &:hover {\n    img {\n      filter: grayscale(0);\n    }\n  }\n}\n</style>\n","<template>\n  <div :class=\"$style.titlebar\">\n    <div class=\"flex overflow-hidden divide-x divide-gray-600\">\n      <div v-for=\"tab in tabs\" :key=\"tab.id\"\n        :class=\"[$style.tab, { [$style.active]: tab.isActive }]\">\n        <button class=\"pl-3 pr-1.5\"\n          @click=\"setActiveTab(tab.id)\"\n          @contextmenu.prevent=\"closeTab(tab.id)\">{{ tab.title }}</button>\n        <button class=\"pl-1.5 pr-3\" title=\"Close\"\n          @click=\"closeTab(tab.id)\"><i class=\"codicon codicon-close\"></i></button>\n      </div>\n    </div>\n    <div class=\"flex p-1.5 flex-shrink-0 space-x-1\">\n      <button class=\"hover:bg-gray-300 hover:text-black p-2\"\n        @click=\"openImport\">Import</button>\n      <button class=\"hover:bg-gray-300 hover:text-black px-2\" title=\"Help\"><i class=\"codicon codicon-question\"></i></button>\n      <button class=\"hover:bg-gray-300 hover:text-black px-2\" title=\"Settings\"><i class=\"codicon codicon-settings\"></i></button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport { tabs, activeTabId, setActiveTab, closeTab, openTab } from './workbench-core'\nimport ImportDialog from './ImportDialog.vue'\n\nexport default defineComponent({\n  setup () {\n    const _tabs = computed(() =>\n      tabs.value.map(tab => ({\n        id: tab.id,\n        title: tab.title,\n        isActive: (tab.id === activeTabId.value)\n      }))\n    )\n\n    function openImport () {\n      openTab({\n        id: 'poe-dat-viewer@import',\n        title: 'Import',\n        type: ImportDialog,\n        args: undefined\n      })\n    }\n\n    return {\n      tabs: _tabs,\n      setActiveTab,\n      closeTab,\n      openImport\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.titlebar {\n  display: flex;\n  justify-content: space-between;\n  @apply bg-gray-700;\n  @apply text-gray-50;\n  z-index: 1;\n  line-height: 1;\n}\n\n.tab {\n  display: flex;\n\n  &:hover {\n    @apply bg-gray-300;\n    @apply text-black;\n  }\n\n  &.active {\n    @apply bg-gray-800;\n\n    &:hover {\n      @apply bg-gray-600;\n      @apply text-white;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"p-4 overflow-auto border-l flex-1 text-base\">\n    <div class=\"inline-flex items-baseline pb-2\">\n      <div style=\"width: 200px;\" class=\"my-1\">\n        <input value=\"patchcdn.pathofexile.com/\" readonly :class=\"$style.input\" />\n        <label :class=\"$style.label\">Patch CDN</label>\n      </div>\n      <div style=\"width: 100px;\" class=\"m-1\">\n        <input v-model.trim=\"poePatch\" placeholder=\"3.12.x.x.x\" :class=\"$style.input\" />\n        <label :class=\"$style.label\">Patch #</label>\n      </div>\n      <div style=\"width: 220px;\" class=\"my-1\">\n        <input value=\"/Bundles2/_.index.bin\" readonly :class=\"$style.input\" />\n        <label :class=\"$style.label\">Index</label>\n      </div>\n      <button class=\"ml-1 py-1 px-3 bg-blue-600 text-white hover:bg-blue-800\"\n        @click=\"cdnImport\"\n        :disabled=\"isCdnImportRunning\"\n        :loading=\"isCdnImportRunning\">{{ isCdnImportRunning ? 'Wait...' : 'Import' }}</button>\n    </div>\n    <div class=\"flex items-baseline mt-3 border-b pb-3\">\n      <span class=\"pr-2\">or</span>\n      <label\n        class=\"bg-gray-100 py-1 px-2 cursor-pointer hover:bg-gray-300\"\n        style=\"width: 200px\"\n        for=\"import-local-file\">Pick local dat file</label>\n      <input\n        class=\"hidden\"\n        id=\"import-local-file\"\n        type=\"file\"\n        accept=\".dat,.dat64\"\n        @input=\"handleFile\" />\n    </div>\n    <div class=\"mt-3\">\n      <template v-if=\"isFetchingSchema\">\n        <i class=\"codicon codicon-loading animate-spin\"></i>\n        <span> Downloading schema from </span>\n      </template>\n      <template v-else>\n        <i class=\"codicon codicon-check\"></i>\n        <span> Downloaded schema from </span>\n      </template>\n      <a href=\"https://github.com/poe-tool-dev/dat-schema\" class=\"underline\" target=\"_blank\">github.com/poe-tool-dev/dat-schema</a>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, shallowRef } from 'vue'\nimport { SchemaFile, SCHEMA_VERSION } from 'pathofexile-dat-schema'\nimport { fetchFile, progress } from '../patchcdn/cache'\nimport { loadIndex, loadFileContent, index } from '../patchcdn/index-store'\nimport { publicSchema } from '../dat-viewer/db'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\n\nexport default defineComponent({\n  setup () {\n    const poePatch = shallowRef(localStorage.getItem('POE_PATCH_VER') || '')\n    const isCdnImportRunning = shallowRef(false)\n    const isFetchingSchema = shallowRef(false)\n\n    if (poePatch.value && !index.value) {\n      cdnImport()\n    }\n    if (!publicSchema.value.length) {\n      fetchSchema()\n    }\n\n    async function handleFile (e: Event) {\n      const elFile = (e.target as HTMLInputElement).files![0]\n      const fileContent = new Uint8Array(await elFile.arrayBuffer())\n      const fileName = elFile.name\n      openTab({\n        id: `file@${fileName}`,\n        title: fileName,\n        type: DatViewer,\n        args: {\n          fileContent,\n          fullPath: fileName\n        }\n      })\n    }\n\n    async function cdnImport () {\n      let bundle\n      try {\n        isCdnImportRunning.value = true\n        bundle = await fetchFile(poePatch.value, '_.index.bin')\n      } finally {\n        isCdnImportRunning.value = false\n      }\n\n      try {\n        await loadIndex(bundle)\n        localStorage.setItem('POE_PATCH_VER', poePatch.value)\n      } catch (e) {\n        window.alert(e.message)\n        throw e\n      }\n    }\n\n    async function fetchSchema () {\n      isFetchingSchema.value = true\n      const response = await fetch('https://poe-bundles.snos.workers.dev/schema.min.json')\n      const schema: SchemaFile = await response.json()\n      if (schema.version === SCHEMA_VERSION) {\n        publicSchema.value = schema.tables\n      } else {\n        console.warn('Latest schema version is not supported.')\n      }\n      isFetchingSchema.value = false\n    }\n\n    return {\n      poePatch,\n      isCdnImportRunning,\n      isFetchingSchema,\n      handleFile,\n      cdnImport\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.input {\n  width: 100%;\n  @apply py-1 px-2;\n\n  &:not([readonly]) {\n    @apply border;\n\n    &:focus {\n      @apply border-blue-500;\n    }\n  }\n\n  &[readonly] {\n    @apply border-b;\n    @apply bg-gray-100;\n  }\n}\n\n.label {\n  @apply text-xs;\n  @apply px-2;\n  @apply text-gray-500;\n}\n</style>\n","import { reactive } from 'vue'\n\nconst BUNDLE_DIR = 'Bundles2'\n\nexport const progress = reactive({\n  totalSize: 0,\n  received: 0,\n  active: false,\n  bundleName: ''\n})\n\nexport async function fetchFile (patchVer: string | null, name: string) {\n  if (patchVer == null) {\n    patchVer = localStorage.getItem('POE_PATCH_VER')\n    if (!patchVer) throw new Error('never')\n  }\n\n  try {\n    return await _fetchFile(patchVer, name)\n  } catch (e) {\n    window.alert('You may need to adjust the patch version.')\n    throw e\n  }\n}\n\nexport async function _fetchFile (patchVer: string, name: string): Promise<ArrayBuffer> {\n  const path = `${patchVer}/${BUNDLE_DIR}/${name}`\n  let cache = await caches.open('bundles')\n  let res = await cache.match(path)\n  if (!res) {\n    progress.totalSize = 0\n    progress.received = 0\n    progress.active = true\n    progress.bundleName = name\n\n    res = await fetch(`https://poe-bundles.snos.workers.dev/${path}`)\n    if (res.status !== 200) {\n      progress.active = false\n      throw new Error(`patchcdn: ${res.status} ${res.statusText}`)\n    }\n    progress.totalSize = Number(res.headers.get('content-length'))\n\n    let buf: Uint8Array\n    try {\n      const reader = res.body!.getReader()\n      const chunks = [] as Uint8Array[]\n      while (true) {\n        const { done, value } = await reader.read()\n        if (done) break\n        chunks.push(value!)\n        progress.received += value!.length\n      }\n\n      buf = new Uint8Array(progress.received)\n      let bufPos = 0\n      for (const chunk of chunks) {\n        buf.set(chunk, bufPos)\n        bufPos += chunk.length\n      }\n    } finally {\n      progress.active = false\n    }\n\n    if (localStorage.getItem('POE_PATCH_VER') !== patchVer) {\n      await caches.delete('bundles')\n      cache = await caches.open('bundles')\n    }\n\n    await cache.put(path, new Response(buf, {\n      headers: {\n        'content-length': String(buf.byteLength),\n        'content-type': 'application/octet-stream'\n      }\n    }))\n    return buf.buffer\n  }\n  return res.arrayBuffer()\n}\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"js/script.d2571f35.worker.js\");\n}\n","/* eslint-disable import/no-webpack-loader-syntax */\nimport Worker from 'worker-loader!./script'\nimport * as Comlink from 'comlink'\nimport type { WorkerRPC } from './script'\nimport type { DatFile } from 'pathofexile-dat'\n\nconst thread = Comlink.wrap<WorkerRPC>(new Worker())\n\nexport function decompressBundle (bundle: Uint8Array) {\n  if (bundle.byteOffset === 0 && bundle.byteLength === bundle.buffer.byteLength) {\n    return thread.decompressSliceInBundle(bundle)\n  } else {\n    const bundleSlice = new Uint8Array(\n      bundle.buffer.slice(bundle.byteOffset, bundle.byteOffset + bundle.byteLength)\n    )\n    return thread.decompressSliceInBundle(Comlink.transfer(bundle, [bundleSlice.buffer]))\n  }\n}\n\nexport function decompressFileTransferBundle (bundle: ArrayBuffer, offset: number, size: number) {\n  return thread.decompressSliceInBundle(\n    Comlink.transfer(new Uint8Array(bundle), [bundle]),\n    offset,\n    size\n  )\n}\n\nexport function analyzeDatFile (datFile: DatFile) {\n  return thread.analyzeDatFile(datFile)\n}\n","import { decompressBundle, decompressFileTransferBundle } from '../worker/interface'\nimport { readIndexBundle, getFileInfo } from 'pathofexile-dat/bundles/index-bundle'\nimport { fetchFile } from './cache'\nimport { shallowRef } from 'vue'\n\nexport const index = shallowRef(null as {\n  bundlesInfo: Uint8Array\n  filesInfo: Uint8Array\n  dirsInfo: Uint8Array\n  pathReps: Uint8Array\n} | null)\n\nexport async function loadFileContent (fullPath: string) {\n  const location = getFileInfo(fullPath, index.value!.bundlesInfo, index.value!.filesInfo)\n  const bundleBin = await fetchFile(null, location.bundle)\n\n  return decompressFileTransferBundle(bundleBin, location.offset, location.size)\n}\n\nexport async function loadIndex (indexBin: ArrayBuffer) {\n  const indexBundle = await decompressBundle(new Uint8Array(indexBin))\n  const _index = readIndexBundle(indexBundle)\n  index.value = {\n    bundlesInfo: _index.bundlesInfo,\n    filesInfo: _index.filesInfo,\n    dirsInfo: _index.dirsInfo,\n    pathReps: await decompressBundle(_index.pathRepsBundle)\n  }\n}\n","import { openDB, DBSchema } from 'idb'\nimport { shallowRef } from 'vue'\nimport { SchemaFile } from 'pathofexile-dat-schema'\nimport type { Header } from './headers'\n\nexport const publicSchema = shallowRef<SchemaFile['tables']>([])\n\nexport interface ViewerSerializedHeader {\n  name: string | null\n  length?: number\n  type: {\n    byteView?: { array: boolean }\n    array?: boolean\n    boolean?: { [key: string]: never }\n    integer?: { unsigned: boolean, size: number }\n    decimal?: { size: number }\n    string?: { [key: string]: never }\n    key?: { foreign: boolean }\n  }\n  textLength?: number\n}\n\ninterface DatSchema {\n  name: string\n  headers: ViewerSerializedHeader[]\n}\n\ninterface PoeDatViewerSchema extends DBSchema {\n  'dat-schemas': {\n    key: DatSchema['name']\n    value: DatSchema\n  }\n}\n\nconst db = openDB<PoeDatViewerSchema>('poe-dat-viewer', 3, {\n  upgrade (db) {\n    db.createObjectStore('dat-schemas', { keyPath: 'name' })\n  }\n})\n\nexport async function findByName (name: string) {\n  const record = await (await db).get('dat-schemas', name)\n  return record?.headers || fromJsonSchema(name) || []\n}\n\nexport async function saveHeaders (\n  name: string,\n  headers: Header[]\n) {\n  await (await db).put('dat-schemas', {\n    name,\n    headers: serializeHeaders(headers)\n  })\n}\n\nfunction serializeHeaders (headers: Header[]) {\n  return headers.map<ViewerSerializedHeader>(header => ({\n    ...header,\n    length: (\n      header.type.string ||\n      header.type.array ||\n      header.type.key ||\n      header.type.boolean ||\n      header.type.decimal ||\n      header.type.integer\n    ) ? undefined\n      : header.length\n  }))\n}\n\nfunction fromJsonSchema (name: string): ViewerSerializedHeader[] | null {\n  const sch = publicSchema.value.find(s => s.name === name)\n  if (!sch) return null\n\n  return sch.columns.map(column => {\n    return { /* eslint-disable indent */\n      name: column.name || '',\n      type: {\n        array: column.array,\n        integer:\n          column.type === 'u8' ? { unsigned: true, size: 1 }\n          : column.type === 'u16' ? { unsigned: true, size: 2 }\n          : column.type === 'u32' ? { unsigned: true, size: 4 }\n          : column.type === 'u64' ? { unsigned: true, size: 8 }\n          : column.type === 'i8' ? { unsigned: false, size: 1 }\n          : column.type === 'i16' ? { unsigned: false, size: 2 }\n          : column.type === 'i32' ? { unsigned: false, size: 4 }\n          : column.type === 'i64' ? { unsigned: false, size: 8 }\n          : undefined,\n        decimal:\n          column.type === 'f32' ? { size: 4 }\n          : column.type === 'f64' ? { size: 8 }\n          : undefined,\n        string:\n          column.type === 'string' ? {}\n          : undefined,\n        boolean:\n          column.type === 'bool' ? {}\n          : undefined,\n        key:\n          (column.type === 'row' || column.type === 'foreignrow') ? {\n            foreign: (column.type === 'foreignrow')\n          }\n          : undefined\n      },\n      textLength: 4 * 3 - 1\n    }\n  })\n}\n","<template>\n  <viewer-actions />\n  <div class=\"flex flex-1\">\n    <resize-observer @resize=\"handleResize\" class=\"flex-1 min-h-0 relative\">\n      <div class=\"bg-gray-100 absolute\" :style=\"headerBlockStyle\">\n        <viewer-head :style=\"headerOverlayContentStyle\"\n          :left=\"scrollLeft\"\n          :width=\"rowsWidth\"\n          :columns=\"renderColumns\"\n        />\n      </div>\n      <canvas-scroll\n        ref=\"canvasScroll\"\n        class=\"absolute bg-white\"\n        @scroll=\"handleScroll\"\n        :style=\"scrollableStyle\"\n        :paint-size=\"scrollablePaintSize\"\n        :full-size=\"scrollableFullSize\">\n        <canvas ref=\"canvasRef\" @click=\"handleCanvasClick\" />\n      </canvas-scroll>\n      <div :class=\"$style.rowsOverlay\" :style=\"rowsOverlayStyle\">\n        <div class=\"absolute\" :style=\"{ transform: `translate(0, ${renderItems.top}px)` }\">\n          <div v-for=\"(rowIdx, i) in renderItems.ids\" :key=\"rowIdx\"\n            :style=\"{ transform: `translate(0, ${i * LINE_HEIGHT}px)`, width: rowsNumberWidth, position: 'absolute' }\"\n            v-text=\"rowIdx\" />\n        </div>\n      </div>\n    </resize-observer>\n    <header-props\n      @focus-editing-header=\"focusEditingHeader\" />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType, reactive, computed, provide, watch, shallowRef, shallowReactive, ref, render, onMounted } from 'vue'\nimport ResizeObserver from '@/ResizeObserver.vue'\nimport CanvasScroll from '@/CanvasScroll.vue'\nimport { Viewer, createViewer } from '../Viewer'\nimport ViewerActions from './Actions.vue'\nimport ViewerHead from './ViewerHead.vue'\nimport HeaderProps from './HeaderProps.vue'\nimport * as rendering from '../rendering'\nimport { renderByteCols, renderColStats } from '../rendering/byte-columns'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll, ViewerActions, ViewerHead, HeaderProps },\n  emits: ['update:kaState'],\n  props: {\n    args: {\n      type: Object as PropType<{\n        fileContent: Uint8Array\n        fullPath: string\n      }>,\n      required: true\n    },\n    kaState: {\n      type: Object as PropType<Viewer | undefined>,\n      default: undefined\n    }\n  },\n  setup (props, ctx) {\n    let viewer: Viewer\n    if (props.kaState) {\n      viewer = props.kaState // eslint-disable-line vue/no-setup-props-destructure\n    } else {\n      viewer = createViewer(props.args.fullPath, props.args.fileContent)\n      ctx.emit('update:kaState', viewer)\n    }\n    provide('viewer', viewer)\n\n    const canvasRef = ref<HTMLCanvasElement | null>(null)\n\n    const canvasScroll = ref<{ scrollTo(x: number | undefined, y: number | undefined): void } | null>(null)\n    onMounted(() => {\n      canvasScroll.value!.scrollTo(viewer.scrollPos.x, viewer.scrollPos.y)\n    })\n\n    const rowIndices = computed(() => {\n      if (viewer.rowSorting.value) {\n        return viewer.rowSorting.value\n      } else {\n        return Array.from(\n          { length: viewer.datFile.rowCount },\n          (_, rowIdx) => rowIdx)\n      }\n    })\n\n    const paintWidth = ref(0)\n    const paintHeight = ref(0)\n    function handleResize (sz: { width: number, height: number }) {\n      paintWidth.value = sz.width\n      paintHeight.value = sz.height\n    }\n    const { scrollPos } = viewer\n    function handleScroll (pos: { y: number, x: number }) {\n      scrollPos.x = pos.x\n      scrollPos.y = pos.y\n    }\n\n    const rowsFullWidth = computed(() =>\n      rendering.getRowWidth(viewer.headers.value))\n    const rowsFullHeight = computed(() =>\n      viewer.datFile.rowCount * rendering.LINE_HEIGHT)\n    const rowsOverlayWidth = computed(() =>\n      rendering.rowsOverlayWidth(viewer.datFile.rowCount))\n    const rowsWidth = computed(() =>\n      Math.max(0, paintWidth.value - rowsOverlayWidth.value))\n    const rowsHeight = computed(() =>\n      Math.max(0, paintHeight.value - rendering.HEADERS_HEIGHT))\n\n    watch([rowsWidth, rowsHeight], () => {\n      const dpr = window.devicePixelRatio\n\n      canvasRef.value!.style.width = rowsWidth.value + 'px'\n      canvasRef.value!.style.height = rowsHeight.value + 'px'\n\n      canvasRef.value!.width = rowsWidth.value * dpr\n      canvasRef.value!.height = rowsHeight.value * dpr\n\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n      ctx.scale(dpr, dpr)\n\n      draw()\n    })\n\n    const renderStats = computed(() =>\n      renderColStats(viewer.columnStats.value, viewer.datFile))\n\n    const renderColumns = computed(() =>\n      renderByteCols(\n        viewer.columnSelection.value,\n        renderStats.value,\n        viewer.headers.value,\n        scrollPos.x,\n        scrollPos.x + Math.min(rowsFullWidth.value, rowsWidth.value))\n    )\n\n    watch([scrollPos, renderColumns, rowIndices, viewer.selectedRow], () => { draw() })\n\n    function draw () {\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n\n      rendering.drawRows({\n        left: scrollPos.x,\n        paintWidth: rowsWidth.value,\n        top: renderItems.value.top,\n        rows: renderItems.value.ids,\n        columns: renderColumns.value,\n        viewer: viewer,\n        ctx\n      })\n    }\n\n    const renderItems = computed(() => {\n      const scrollTop = scrollPos.y\n\n      const count = Math.ceil(rowsHeight.value / rendering.LINE_HEIGHT) + 1\n      const startIdx = Math.floor(scrollTop / rendering.LINE_HEIGHT)\n\n      const top = (startIdx * rendering.LINE_HEIGHT) - scrollTop\n\n      return {\n        top,\n        ids: rowIndices.value.slice(startIdx, startIdx + count)\n      }\n    })\n\n    function focusEditingHeader () {\n      const header = viewer.editHeader.value!\n      const cols = renderHeaderCols(viewer.headers.value, null, 0, 0 + Infinity)\n      const target = cols.find(col => col.offset === header.offset)!\n      canvasScroll.value!.scrollTo(target.leftPx - rowsWidth.value * 0.33, undefined)\n    }\n\n    function handleCanvasClick (e: MouseEvent) {\n      const { selectedRow } = viewer\n      const sortedIdx = Math.floor((e.offsetY + scrollPos.y) / rendering.LINE_HEIGHT)\n      const realIdx = rowIndices.value[sortedIdx]\n      selectedRow.value = (selectedRow.value !== realIdx)\n        ? realIdx\n        : null\n    }\n\n    return {\n      headerBlockStyle: computed(() =>\n        ({ height: rendering.HEADERS_HEIGHT + 'px', width: paintWidth.value + 'px' })),\n      headerOverlayContentStyle: computed(() =>\n        ({ left: rowsOverlayWidth.value + 'px', height: rendering.HEADERS_HEIGHT + 'px', width: rowsWidth.value + 'px' })),\n      scrollableStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', left: rowsOverlayWidth.value + 'px' })),\n      scrollablePaintSize: computed(() =>\n        ({ width: rowsWidth.value, height: rowsHeight.value })),\n      scrollableFullSize: computed(() =>\n        ({ width: rowsFullWidth.value, height: rowsFullHeight.value })),\n      rowsOverlayStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', width: rowsOverlayWidth.value + 'px', height: rowsHeight.value + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px', lineHeight: rendering.LINE_HEIGHT + 'px' })),\n      handleScroll,\n      handleResize,\n      renderItems,\n      canvasRef,\n      renderColumns,\n      scrollLeft: computed(() => scrollPos.x),\n      rowsWidth: computed(() => Math.min(rowsFullWidth.value, rowsWidth.value)),\n      LINE_HEIGHT: rendering.LINE_HEIGHT,\n      canvasScroll,\n      rowsNumberWidth: (rendering.rowsNumWidth(viewer.datFile.rowCount) + 'px'),\n      focusEditingHeader,\n      handleCanvasClick\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.rowsOverlay {\n  position: absolute;\n  overflow: hidden;\n  transform: translate3d(0, 0, 0);\n  contain: strict;\n  @apply bg-white;\n  padding-left: 7px;\n  @apply border-l border-gray-100;\n  padding-right: 8px;\n  text-align: right;\n  box-shadow: #cacaca 0 6px 6px -6px inset;\n  user-select: none;\n}\n</style>\n","<template>\n  <component :is=\"tag\" ref=\"rootEl\" data-role=\"resize-observer\">\n    <slot />\n  </component>\n</template>\n\n<script lang=\"ts\">\n/// <reference types=\"resize-observer-browser\" />\n\nimport { defineComponent, ref, onMounted, onBeforeUnmount } from 'vue'\n\nexport default defineComponent({\n  props: {\n    tag: {\n      type: String,\n      default: 'div'\n    }\n  },\n  emits: ['resize'],\n  setup (props, ctx) {\n    const rootEl = ref<HTMLElement | null>(null)\n\n    onMounted(() => {\n      const resizeObserver = new ResizeObserver(entries => {\n        ctx.emit('resize', {\n          width: entries[0].contentRect.width,\n          height: entries[0].contentRect.height\n        })\n      })\n\n      resizeObserver.observe(rootEl.value!)\n      onBeforeUnmount(() => {\n        resizeObserver.unobserve(rootEl.value!)\n      })\n    })\n\n    return { rootEl }\n  }\n})\n</script>\n","\n/// <reference types=\"resize-observer-browser\" />\n\nimport { defineComponent, ref, onMounted, onBeforeUnmount } from 'vue'\n\nexport default defineComponent({\n  props: {\n    tag: {\n      type: String,\n      default: 'div'\n    }\n  },\n  emits: ['resize'],\n  setup (props, ctx) {\n    const rootEl = ref<HTMLElement | null>(null)\n\n    onMounted(() => {\n      const resizeObserver = new ResizeObserver(entries => {\n        ctx.emit('resize', {\n          width: entries[0].contentRect.width,\n          height: entries[0].contentRect.height\n        })\n      })\n\n      resizeObserver.observe(rootEl.value!)\n      onBeforeUnmount(() => {\n        resizeObserver.unobserve(rootEl.value!)\n      })\n    })\n\n    return { rootEl }\n  }\n})\n","import { render } from \"./ResizeObserver.vue?vue&type=template&id=7624aec8\"\nimport script from \"./ResizeObserver.vue?vue&type=script&lang=ts\"\nexport * from \"./ResizeObserver.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div :class=\"$style.scrollable\"\n    :style=\"{ width: paintSize.width + 'px', height: paintSize.height + 'px' }\"\n    @mousedown=\"handleMousedown\"\n    @wheel=\"handleMousewheel\"\n  >\n    <slot />\n    <div v-if=\"scrollbarY\" :class=\"`${$style.track} ${$style.y}`\" @mousedown=\"handleTrackMousedownY\"\n      :style=\"{ width: scrollbarY.fixedSize + 'px', height: scrollbarY.trackSize + 'px' }\">\n      <div :class=\"$style.thumb\" :style=\"{\n        transform: `translate(0, ${scrollbarY.thumbPos}px)`,\n        width: scrollbarY.fixedSize + 'px', height: scrollbarY.thumbSize + 'px' }\" />\n    </div>\n    <div v-if=\"scrollbarX\" :class=\"`${$style.track} ${$style.x}`\" @mousedown=\"handleTrackMousedownX\"\n      :style=\"{ width: scrollbarX.trackSize + 'px', height: scrollbarX.fixedSize + 'px' }\">\n      <div :class=\"$style.thumb\" :style=\"{\n        transform: `translate(${scrollbarX.thumbPos}px, 0)`,\n        width: scrollbarX.thumbSize + 'px', height: scrollbarX.fixedSize + 'px' }\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, shallowReactive, computed, Ref, PropType, readonly, watch } from 'vue'\n\nconst MIN_THUMB_SIZE = 40\nconst SCROLL_DIR_THRESHOLD = 15\nconst WHEEL_SCROLL_SPEED = 100\nconst SCROLL_ACCELERATION_FN = (value: number, dt: number) =>\n  Math.max(1, Math.pow(value * (3 / 1000) * dt, 2)) * Math.sign(value)\n\ntype Scrollbar = {\n  fixedSize: number\n  trackSize: number\n  thumbSize: number\n  thumbRatio: number\n  thumbPos: number\n} | null\n\nfunction scrollbar (\n  fixedSize: number,\n  paintSize: number,\n  scrollSize: number,\n  otherScrollbar: Scrollbar,\n  scrollPos: number\n): Scrollbar {\n  if (scrollSize <= paintSize) return null\n\n  const trackSize = Math.max(0, paintSize - (otherScrollbar?.fixedSize ?? 0))\n  const thumbSize = Math.max(MIN_THUMB_SIZE, Math.floor(paintSize * trackSize / scrollSize))\n\n  const thumbRatio = (trackSize - thumbSize) / (scrollSize - paintSize)\n  const thumbPos = Math.round(scrollPos * thumbRatio)\n\n  return {\n    trackSize,\n    thumbSize,\n    fixedSize,\n    thumbRatio,\n    thumbPos\n  }\n}\n\nfunction useMouseMiddleButtonScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  let startY = 0\n  let startX = 0\n  let deltaY = 0\n  let deltaX = 0\n  let direction = null as 'vertical' | 'horizontal' | null\n\n  let rafTime = 0\n  let rafId = 0\n\n  function handleMousedown (e: MouseEvent) {\n    if (e.button !== 1) return\n\n    e.preventDefault()\n    e.stopPropagation()\n    document.body.style.cursor = 'all-scroll'\n\n    direction = null\n    startY = e.clientY\n    startX = e.clientX\n    deltaY = 0\n    deltaX = 0\n\n    rafTime = 0\n    rafId = requestAnimationFrame(scrollEachFrame)\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function cancelScroll () {\n    cancelAnimationFrame(rafId)\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n\n    document.body.style.removeProperty('cursor')\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const dy = (e.clientY - startY)\n    const dx = (e.clientX - startX)\n\n    if (direction === null) {\n      if (Math.abs(dy) > SCROLL_DIR_THRESHOLD) {\n        direction = 'vertical'\n        document.body.style.cursor = 'ns-resize'\n      } else if (Math.abs(dx) > SCROLL_DIR_THRESHOLD) {\n        direction = 'horizontal'\n        document.body.style.cursor = 'ew-resize'\n      } else {\n        return\n      }\n    }\n\n    if (direction === 'vertical') {\n      deltaY = dy\n    } else {\n      deltaX = dx\n    }\n  }\n\n  function scrollEachFrame (time: number) {\n    const dtTime = time - (rafTime || time)\n    rafTime = time\n    rafId = requestAnimationFrame(scrollEachFrame)\n\n    scrollByDelta(\n      SCROLL_ACCELERATION_FN(deltaX, dtTime),\n      SCROLL_ACCELERATION_FN(deltaY, dtTime)\n    )\n  }\n\n  return { handleMousedown }\n}\n\nfunction useMouseWheelScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  function handleMousewheel (e: WheelEvent) {\n    scrollByDelta(0, Math.sign(e.deltaY) * WHEEL_SCROLL_SPEED)\n  }\n\n  return { handleMousewheel }\n}\n\nfunction useScrollbarScroll (\n  scrollbar: Ref<Scrollbar>,\n  axis: 'x' | 'y',\n  scrollTo: (x: number | undefined, y: number | undefined) => void\n) {\n  let start = 0\n  let offset = 0\n\n  const rectProp = (axis === 'y' ? 'y' : 'x')\n  const mEventProp = (axis === 'y' ? 'clientY' : 'clientX')\n\n  function handleTrackMousedown (e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n\n    const trackEl = e.currentTarget as HTMLElement\n    start = trackEl.getBoundingClientRect()[rectProp]\n\n    if (e.target !== trackEl) {\n      const thumbEl = e.target as HTMLElement\n      offset = e[mEventProp] - thumbEl.getBoundingClientRect()[rectProp]\n    } else {\n      offset = (scrollbar.value!.thumbSize / 2)\n      handleMouseMove(e)\n      offset = (e[mEventProp] - start - scrollbar.value!.thumbPos)\n    }\n\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const value = (e[mEventProp] - start - offset) / scrollbar.value!.thumbRatio\n    if (axis === 'x') {\n      scrollTo(value, undefined)\n    } else {\n      scrollTo(undefined, value)\n    }\n  }\n\n  function cancelScroll () {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n  }\n\n  return { handleTrackMousedown }\n}\n\nexport default defineComponent({\n  props: {\n    paintSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    fullSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    widthY: {\n      type: Number,\n      default: 14\n    },\n    widthX: {\n      type: Number,\n      default: 12\n    }\n  },\n  emits: ['scroll'],\n  setup (props, ctx) {\n    const scrollPos = shallowReactive({ y: 0, x: 0 })\n\n    watch(() => [props.paintSize, props.fullSize], () => {\n      const { paintSize, fullSize } = props\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x, fullSize.width - paintSize.width))\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y, fullSize.height - paintSize.height))\n    }, { deep: true })\n\n    watch(scrollPos, () => {\n      ctx.emit('scroll', {\n        y: scrollPos.y,\n        x: scrollPos.x\n      })\n    })\n\n    const scrollbarY = computed(() =>\n      scrollbar(props.widthY, props.paintSize.height, props.fullSize.height, null, scrollPos.y))\n    const scrollbarX = computed(() =>\n      scrollbar(props.widthX, props.paintSize.width, props.fullSize.width, scrollbarY.value, scrollPos.x))\n\n    function scrollByDelta (dx: number, dy: number) {\n      const { paintSize, fullSize } = props\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y + Math.floor(dy), fullSize.height - paintSize.height))\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x + Math.floor(dx), fullSize.width - paintSize.width))\n    }\n\n    function scrollTo (x: number | undefined, y: number | undefined) {\n      const { paintSize, fullSize } = props\n      if (x !== undefined) {\n        scrollPos.x = Math.max(0, Math.min(Math.floor(x), fullSize.width - paintSize.width))\n      }\n      if (y !== undefined) {\n        scrollPos.y = Math.max(0, Math.min(Math.floor(y), fullSize.height - paintSize.height))\n      }\n    }\n\n    return {\n      scrollbarY,\n      scrollbarX,\n      scrollPos: readonly(scrollPos),\n      scrollTo,\n      scrollByDelta,\n      handleMousedown: useMouseMiddleButtonScroll(scrollByDelta).handleMousedown,\n      handleMousewheel: useMouseWheelScroll(scrollByDelta).handleMousewheel,\n      handleTrackMousedownY: useScrollbarScroll(scrollbarY, 'y', scrollTo).handleTrackMousedown,\n      handleTrackMousedownX: useScrollbarScroll(scrollbarX, 'x', scrollTo).handleTrackMousedown\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.scrollable {\n  overflow: hidden;\n  position: relative;\n  transform: translate3d(0, 0, 0);\n}\n\n.track {\n  position: absolute;\n  contain: strict;\n  &.y { top: 0; right: 0; }\n  &.x { bottom: 0; left: 0; }\n}\n\n.thumb {\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.3);\n  will-change: transform;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.4);\n  }\n}\n</style>\n","\nimport { defineComponent, shallowReactive, computed, Ref, PropType, readonly, watch } from 'vue'\n\nconst MIN_THUMB_SIZE = 40\nconst SCROLL_DIR_THRESHOLD = 15\nconst WHEEL_SCROLL_SPEED = 100\nconst SCROLL_ACCELERATION_FN = (value: number, dt: number) =>\n  Math.max(1, Math.pow(value * (3 / 1000) * dt, 2)) * Math.sign(value)\n\ntype Scrollbar = {\n  fixedSize: number\n  trackSize: number\n  thumbSize: number\n  thumbRatio: number\n  thumbPos: number\n} | null\n\nfunction scrollbar (\n  fixedSize: number,\n  paintSize: number,\n  scrollSize: number,\n  otherScrollbar: Scrollbar,\n  scrollPos: number\n): Scrollbar {\n  if (scrollSize <= paintSize) return null\n\n  const trackSize = Math.max(0, paintSize - (otherScrollbar?.fixedSize ?? 0))\n  const thumbSize = Math.max(MIN_THUMB_SIZE, Math.floor(paintSize * trackSize / scrollSize))\n\n  const thumbRatio = (trackSize - thumbSize) / (scrollSize - paintSize)\n  const thumbPos = Math.round(scrollPos * thumbRatio)\n\n  return {\n    trackSize,\n    thumbSize,\n    fixedSize,\n    thumbRatio,\n    thumbPos\n  }\n}\n\nfunction useMouseMiddleButtonScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  let startY = 0\n  let startX = 0\n  let deltaY = 0\n  let deltaX = 0\n  let direction = null as 'vertical' | 'horizontal' | null\n\n  let rafTime = 0\n  let rafId = 0\n\n  function handleMousedown (e: MouseEvent) {\n    if (e.button !== 1) return\n\n    e.preventDefault()\n    e.stopPropagation()\n    document.body.style.cursor = 'all-scroll'\n\n    direction = null\n    startY = e.clientY\n    startX = e.clientX\n    deltaY = 0\n    deltaX = 0\n\n    rafTime = 0\n    rafId = requestAnimationFrame(scrollEachFrame)\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function cancelScroll () {\n    cancelAnimationFrame(rafId)\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n\n    document.body.style.removeProperty('cursor')\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const dy = (e.clientY - startY)\n    const dx = (e.clientX - startX)\n\n    if (direction === null) {\n      if (Math.abs(dy) > SCROLL_DIR_THRESHOLD) {\n        direction = 'vertical'\n        document.body.style.cursor = 'ns-resize'\n      } else if (Math.abs(dx) > SCROLL_DIR_THRESHOLD) {\n        direction = 'horizontal'\n        document.body.style.cursor = 'ew-resize'\n      } else {\n        return\n      }\n    }\n\n    if (direction === 'vertical') {\n      deltaY = dy\n    } else {\n      deltaX = dx\n    }\n  }\n\n  function scrollEachFrame (time: number) {\n    const dtTime = time - (rafTime || time)\n    rafTime = time\n    rafId = requestAnimationFrame(scrollEachFrame)\n\n    scrollByDelta(\n      SCROLL_ACCELERATION_FN(deltaX, dtTime),\n      SCROLL_ACCELERATION_FN(deltaY, dtTime)\n    )\n  }\n\n  return { handleMousedown }\n}\n\nfunction useMouseWheelScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  function handleMousewheel (e: WheelEvent) {\n    scrollByDelta(0, Math.sign(e.deltaY) * WHEEL_SCROLL_SPEED)\n  }\n\n  return { handleMousewheel }\n}\n\nfunction useScrollbarScroll (\n  scrollbar: Ref<Scrollbar>,\n  axis: 'x' | 'y',\n  scrollTo: (x: number | undefined, y: number | undefined) => void\n) {\n  let start = 0\n  let offset = 0\n\n  const rectProp = (axis === 'y' ? 'y' : 'x')\n  const mEventProp = (axis === 'y' ? 'clientY' : 'clientX')\n\n  function handleTrackMousedown (e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n\n    const trackEl = e.currentTarget as HTMLElement\n    start = trackEl.getBoundingClientRect()[rectProp]\n\n    if (e.target !== trackEl) {\n      const thumbEl = e.target as HTMLElement\n      offset = e[mEventProp] - thumbEl.getBoundingClientRect()[rectProp]\n    } else {\n      offset = (scrollbar.value!.thumbSize / 2)\n      handleMouseMove(e)\n      offset = (e[mEventProp] - start - scrollbar.value!.thumbPos)\n    }\n\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const value = (e[mEventProp] - start - offset) / scrollbar.value!.thumbRatio\n    if (axis === 'x') {\n      scrollTo(value, undefined)\n    } else {\n      scrollTo(undefined, value)\n    }\n  }\n\n  function cancelScroll () {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n  }\n\n  return { handleTrackMousedown }\n}\n\nexport default defineComponent({\n  props: {\n    paintSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    fullSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    widthY: {\n      type: Number,\n      default: 14\n    },\n    widthX: {\n      type: Number,\n      default: 12\n    }\n  },\n  emits: ['scroll'],\n  setup (props, ctx) {\n    const scrollPos = shallowReactive({ y: 0, x: 0 })\n\n    watch(() => [props.paintSize, props.fullSize], () => {\n      const { paintSize, fullSize } = props\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x, fullSize.width - paintSize.width))\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y, fullSize.height - paintSize.height))\n    }, { deep: true })\n\n    watch(scrollPos, () => {\n      ctx.emit('scroll', {\n        y: scrollPos.y,\n        x: scrollPos.x\n      })\n    })\n\n    const scrollbarY = computed(() =>\n      scrollbar(props.widthY, props.paintSize.height, props.fullSize.height, null, scrollPos.y))\n    const scrollbarX = computed(() =>\n      scrollbar(props.widthX, props.paintSize.width, props.fullSize.width, scrollbarY.value, scrollPos.x))\n\n    function scrollByDelta (dx: number, dy: number) {\n      const { paintSize, fullSize } = props\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y + Math.floor(dy), fullSize.height - paintSize.height))\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x + Math.floor(dx), fullSize.width - paintSize.width))\n    }\n\n    function scrollTo (x: number | undefined, y: number | undefined) {\n      const { paintSize, fullSize } = props\n      if (x !== undefined) {\n        scrollPos.x = Math.max(0, Math.min(Math.floor(x), fullSize.width - paintSize.width))\n      }\n      if (y !== undefined) {\n        scrollPos.y = Math.max(0, Math.min(Math.floor(y), fullSize.height - paintSize.height))\n      }\n    }\n\n    return {\n      scrollbarY,\n      scrollbarX,\n      scrollPos: readonly(scrollPos),\n      scrollTo,\n      scrollByDelta,\n      handleMousedown: useMouseMiddleButtonScroll(scrollByDelta).handleMousedown,\n      handleMousewheel: useMouseWheelScroll(scrollByDelta).handleMousewheel,\n      handleTrackMousedownY: useScrollbarScroll(scrollbarY, 'y', scrollTo).handleTrackMousedown,\n      handleTrackMousedownX: useScrollbarScroll(scrollbarX, 'x', scrollTo).handleTrackMousedown\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"scrollable\":\"CanvasScroll_scrollable_2JJue\",\"track\":\"CanvasScroll_track_2TQj3\",\"y\":\"CanvasScroll_y_31A4K\",\"x\":\"CanvasScroll_x_1tP3O\",\"thumb\":\"CanvasScroll_thumb_3KZWl\"};","import { render } from \"./CanvasScroll.vue?vue&type=template&id=1c788ded\"\nimport script from \"./CanvasScroll.vue?vue&type=script&lang=ts\"\nexport * from \"./CanvasScroll.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./CanvasScroll.vue?vue&type=style&index=0&id=1c788ded&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","import type { Header } from './headers'\n\nexport function selectColsByHeader (header: Header, selection: boolean[]) {\n  for (let offset = header.offset; offset < (header.offset + header.length); ++offset) {\n    selection[offset] = true\n  }\n}\n\nexport function toggleColsBetween (selection: boolean[], a: number, b: number, headers: readonly Header[]) {\n  const start = Math.min(a, b)\n  const end = Math.max(a, b)\n\n  headers = headers.filter(hdr => (hdr.type.byteView && !hdr.type.byteView.array))\n\n  for (let offset = start; offset <= end; ++offset) {\n    if (headers.some(hdr =>\n      offset >= hdr.offset && offset < (hdr.offset + hdr.length)\n    )) {\n      selection[offset] = !selection[offset]\n    }\n  }\n}\n\nexport function clearColumnSelection (selection: boolean[]) {\n  selection.fill(false)\n}\n\nexport function getColumnSelections (selection: readonly boolean[]) {\n  const ranges: number[][] = []\n\n  let idx = selection.indexOf(true)\n  let last: number\n  if (idx < 0) {\n    return ranges\n  } else {\n    last = idx\n    ranges.push([last])\n  }\n\n  for (idx += 1; idx < selection.length; ++idx) {\n    if (selection[idx]) {\n      const curr = idx\n      if ((curr - last) === 1) {\n        ranges[ranges.length - 1].push(curr)\n      } else {\n        ranges.push([curr])\n      }\n      last = curr\n    }\n  }\n\n  return ranges\n}\n","import { getColumnSelections } from './selection'\n\nexport interface Header {\n  name: string | null\n  readonly offset: number\n  readonly length: number\n  type: {\n    byteView?: { array: boolean }\n    array?: boolean\n    boolean?: { [key: string]: never }\n    integer?: { unsigned: boolean, size: number }\n    decimal?: { size: number }\n    string?: { [key: string]: never }\n    key?: { foreign: boolean }\n  }\n  textLength?: number\n}\n\nexport const byteView = (): Header['type'] => ({ byteView: { array: false } })\n\nfunction removeHeadersAtOffsets (offsets: number[], headers: Header[]) {\n  for (let idx = 0; idx < headers.length;) {\n    const header = headers[idx]\n    if (\n      header.name != null && offsets.some(offset =>\n        offset >= header.offset &&\n        offset < header.offset + header.length\n      )) {\n      removeHeader(header, headers)\n    } else {\n      idx += 1\n    }\n  }\n}\n\nexport function createHeaderFromSelected (selection: boolean[], headers: Header[]) {\n  const selections = getColumnSelections(selection)\n  if (selections.length === 0) {\n    throw new Error('No bytes selected')\n  } else if (selections.length > 1) {\n    throw new Error('Cannot create header from non-contiguous selection')\n  }\n  const selected = selections[0]\n\n  removeHeadersAtOffsets(selected, headers)\n\n  const emptyHeader = headers.find(header =>\n    selected[0] >= header.offset &&\n    selected[0] + selected.length <= header.offset + header.length\n  )!\n\n  let updatedHeaders: Header[] = [\n    {\n      name: null,\n      offset: emptyHeader.offset,\n      length: selected[0] - emptyHeader.offset,\n      type: byteView()\n    }, {\n      name: '',\n      offset: selected[0],\n      length: selected.length,\n      type: byteView(),\n      textLength: 4 * 3 - 1\n    }, {\n      name: null,\n      offset: selected[0] + selected.length,\n      length: emptyHeader.length - (selected[0] - emptyHeader.offset + selected.length),\n      type: byteView()\n    }\n  ]\n  const header = updatedHeaders[1]\n\n  updatedHeaders = updatedHeaders.filter(header => header.length)\n  headers.splice(headers.indexOf(emptyHeader), 1, ...updatedHeaders)\n\n  return header\n}\n\nexport function removeHeader (header: Header, headers: Header[]) {\n  if (header.name == null) {\n    throw new Error('Cannot remove empty header')\n  }\n\n  header.name = null\n  header.type = byteView()\n\n  for (let idx = 0; idx < (headers.length - 1);) {\n    const merged = mergeEmptyHeaders(headers[idx], headers[idx + 1])\n    if (merged) {\n      headers.splice(idx, 2, merged)\n    } else {\n      idx += 1\n    }\n  }\n}\n\nfunction mergeEmptyHeaders (h1: Header, h2: Header): Header | null {\n  if (h1.name === null && h2.name === null) {\n    return {\n      name: null,\n      offset: h1.offset,\n      length: h1.length + h2.length,\n      type: byteView()\n    }\n  }\n\n  return null\n}\n","import { DatFile, readDatFile, readColumn } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { validateHeader } from 'pathofexile-dat/dat-analysis/validation'\nimport { getHeaderLength } from 'pathofexile-dat/dat/header'\nimport { Header, createHeaderFromSelected, byteView } from './headers'\nimport * as db from './db'\nimport { clearColumnSelection, selectColsByHeader } from './selection'\nimport { shallowRef, Ref, triggerRef, shallowReactive } from 'vue'\nimport { analyzeDatFile } from '../worker/interface'\n\nexport interface Viewer {\n  readonly name: string\n  readonly datFile: DatFile\n  headers: Ref<Header[]>\n  columnStats: Ref<ColumnStats[]>\n  columnSelection: Ref<boolean[]>\n  editHeader: Ref<Header | null>\n  selectedRow: Ref<number | null>\n  rowSorting: Ref<number[] | null>\n  scrollPos: { x: number, y: number }\n}\n\nexport function createViewer (path: string, fileContent: Uint8Array): Viewer {\n  const parsed = readDatFile(path, fileContent)\n\n  const viewer: Viewer = {\n    headers: shallowRef(\n      parsed.rowLength\n        ? [{\n            name: null,\n            offset: 0,\n            length: parsed.rowLength,\n            type: byteView()\n          }]\n        : []\n    ),\n    datFile: parsed,\n    name: getNamePart(path),\n    columnStats: shallowRef([]),\n    columnSelection: shallowRef(new Array(parsed.rowLength).fill(false)),\n    editHeader: shallowRef(null),\n    selectedRow: shallowRef(null),\n    rowSorting: shallowRef(null),\n    scrollPos: shallowReactive({ x: 0, y: 0 })\n  }\n\n  analyzeDatFile(viewer.datFile).then(async stats => {\n    viewer.columnStats.value = stats\n\n    const headers = await db.findByName(viewer.name)\n    try {\n      tryImportHeaders(headers, viewer)\n    } catch (e) {\n      window.alert(`WARN: ${e.message}`)\n    } finally {\n      triggerRef(viewer.headers)\n    }\n  })\n\n  return viewer\n}\n\nfunction tryImportHeaders (serialized: db.ViewerSerializedHeader[], viewer: Viewer) {\n  let offset = 0\n  for (const hdrSerialized of serialized) {\n    const headerLength = hdrSerialized.length || getHeaderLength(hdrSerialized, viewer.datFile)\n    if (hdrSerialized.name == null) {\n      offset += headerLength\n      continue\n    }\n\n    const header: Header = {\n      ...hdrSerialized,\n      length: headerLength,\n      offset: offset\n    }\n\n    const isValid = (hdrSerialized.length)\n      ? (viewer.datFile.rowLength - header.offset) >= header.length\n      : validateHeader(header, viewer.columnStats.value, viewer.datFile)\n    if (!isValid) {\n      throw new Error('The schema is invalid.')\n    }\n\n    selectColsByHeader(header, viewer.columnSelection.value)\n    const headerCreated = createHeaderFromSelected(viewer.columnSelection.value, viewer.headers.value)\n    Object.assign(headerCreated, header)\n    clearColumnSelection(viewer.columnSelection.value)\n\n    offset += headerLength\n  }\n}\n\nexport function exportAllRows (headers: Header[], datFile: DatFile) {\n  const columns = headers\n    .filter(({ type }) => type.boolean || type.decimal || type.integer || type.key || type.string)\n    .map((header, idx) => ({\n      name: header.name || `Unknown${idx + 1}`,\n      data: (() => {\n        const data = readColumn(header, datFile)\n\n        if (header.type.key?.foreign) {\n          if (!header.type.array) {\n            const data_ = data as ({ rid: number, unknown: number } | null)[]\n            if (!data_.every(row => row == null || row.unknown === 0)) {\n              throw new Error('never')\n            }\n            return data_.map(row => row && row.rid)\n          } else {\n            const data_ = data as (Array<{ rid: number, unknown: number }>)[]\n            if (!data_.every(row => row.every(entry => entry.unknown === 0))) {\n              throw new Error('never')\n            }\n            return data_.map(row => row.map(entry => entry.rid))\n          }\n        }\n\n        return data\n      })()\n    }))\n\n  columns.unshift({\n    name: '_rid',\n    data: Array(datFile.rowCount).fill(undefined)\n      .map((_, idx) => idx)\n  })\n\n  return Array(datFile.rowCount).fill(undefined)\n    .map((_, idx) => Object.fromEntries(\n      columns.map(col => [col.name, col.data[idx]])\n    ))\n}\n\nfunction getNamePart (path: string) {\n  return path.match(/[^/]+(?=\\..+$)/)![0]\n}\n\nexport function saveHeaders (viewer: Viewer) {\n  db.saveHeaders(viewer.name, viewer.headers.value)\n}\n","<template>\n  <div :class=\"$style.bar\">\n    <div class=\"flex\">\n      <template v-if=\"selections.length === 0\">\n        <div class=\"text-gray-400 italic px-1.5 self-center\">No bytes selected</div>\n      </template>\n      <template v-else-if=\"selections.length === 1\">\n        <button class=\"hover:bg-gray-300 hover:text-black px-1.5\"\n          @click=\"defineColumn\"><i class=\"codicon codicon-add\"></i> Define column</button>\n      </template>\n      <template v-else-if=\"selections.length > 1\">\n        <div class=\"text-gray-300 px-1.5 mr-1 self-center\">Selections</div>\n        <!-- eslint-disable-next-line vue/require-v-for-key -->\n        <div v-for=\"range in selections\"\n          class=\"px-1.5 mr-1 font-mono bg-gray-200 text-black flex items-center\"\n          v-text=\"range\" />\n      </template>\n    </div>\n    <div class=\"flex space-x-1\">\n      <button v-if=\"rowSorting\"\n        class=\"bg-gray-600 hover:bg-gray-300 hover:text-black px-1.5 border border-gray-500\"\n        @click=\"rowSorting = null\"\n        >Reset sorting</button>\n      <button\n        class=\"hover:bg-gray-300 hover:text-black px-1.5\"\n        @click=\"exportDataJson\"\n        >Export data</button>\n      <!-- <button TODO\n        class=\"hover:bg-gray-300 hover:text-black px-1.5\"\n        >Export schema</button> -->\n      <!-- <button\n        class=\"hover:bg-gray-300 hover:text-black px-1.5\"\n        ><i class=\"codicon codicon-ellipsis\" /></button> -->\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, inject, triggerRef } from 'vue'\nimport { clearColumnSelection, getColumnSelections } from '../selection'\nimport { createHeaderFromSelected } from '../headers'\nimport FileSaver from 'file-saver'\nimport { Viewer, exportAllRows, saveHeaders } from '../Viewer'\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const selections = computed(() =>\n      getColumnSelections(viewer.columnSelection.value)\n        .map(range => range.map(col => String(col)).join(' '))\n    )\n\n    function defineColumn () {\n      const { editHeader, columnSelection, headers } = viewer\n      editHeader.value = createHeaderFromSelected(columnSelection.value, headers.value)\n      clearColumnSelection(columnSelection.value)\n      triggerRef(headers)\n      triggerRef(columnSelection)\n      saveHeaders(viewer)\n    }\n\n    function exportDataJson () {\n      const data = exportAllRows(viewer.headers.value, viewer.datFile)\n      FileSaver.saveAs(new File(\n        [JSON.stringify(data, null, 2)],\n        `${viewer.name}.json`,\n        { type: 'application/json;charset=utf-8' }\n      ))\n    }\n\n    return {\n      viewer,\n      rowSorting: viewer.rowSorting,\n      selections,\n      defineColumn,\n      exportDataJson\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.bar {\n  display: flex;\n  justify-content: space-between;\n  line-height: 1;\n  @apply text-gray-200;\n  @apply p-2;\n  @apply bg-gray-800;\n  height: 35px;\n}\n</style>\n","\nimport { defineComponent, computed, inject, triggerRef } from 'vue'\nimport { clearColumnSelection, getColumnSelections } from '../selection'\nimport { createHeaderFromSelected } from '../headers'\nimport FileSaver from 'file-saver'\nimport { Viewer, exportAllRows, saveHeaders } from '../Viewer'\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const selections = computed(() =>\n      getColumnSelections(viewer.columnSelection.value)\n        .map(range => range.map(col => String(col)).join(' '))\n    )\n\n    function defineColumn () {\n      const { editHeader, columnSelection, headers } = viewer\n      editHeader.value = createHeaderFromSelected(columnSelection.value, headers.value)\n      clearColumnSelection(columnSelection.value)\n      triggerRef(headers)\n      triggerRef(columnSelection)\n      saveHeaders(viewer)\n    }\n\n    function exportDataJson () {\n      const data = exportAllRows(viewer.headers.value, viewer.datFile)\n      FileSaver.saveAs(new File(\n        [JSON.stringify(data, null, 2)],\n        `${viewer.name}.json`,\n        { type: 'application/json;charset=utf-8' }\n      ))\n    }\n\n    return {\n      viewer,\n      rowSorting: viewer.rowSorting,\n      selections,\n      defineColumn,\n      exportDataJson\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"bar\":\"Actions_bar_3KpDj\"};","import { render } from \"./Actions.vue?vue&type=template&id=4d166eaf\"\nimport script from \"./Actions.vue?vue&type=script&lang=ts\"\nexport * from \"./Actions.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Actions.vue?vue&type=style&index=0&id=4d166eaf&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div class=\"datv-header-layer\">\n    <div :style=\"headersRowStyle\" class=\"absolute\">\n      <button v-for=\"col in headers\" :key=\"col.offset\"\n        class=\"datv-header\" :class=\"{ 'datv-col--border': col.border, 'datv-header--active': col.active }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n        :title=\"col.name\"\n        @click=\"editHeader(col.offset)\"\n        @wheel=\"handleHeaderWheel(col.offset, $event)\">\n        <template v-if=\"col.name === null\">&nbsp;</template>\n        <span v-else-if=\"col.name === ''\" class=\"bg-gray-500 text-gray-200 px-1\">?</span>\n        <template v-else>{{ col.name }}</template>\n      </button>\n    </div>\n    <div :style=\"colsRowStyle\" class=\"absolute\">\n      <button v-for=\"col in columns\" :key=\"col.offset\"\n        class=\"datv-byte\"\n        :class=\"{\n          'datv-col--border': col.border,\n          'datv-byte--selected': col.selected\n        }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n        @mousedown=\"selectStart(col.offset)\"\n        @mouseenter=\"selectContinue(col.offset, $event)\"\n        :title=\"col.offset\"\n        v-text=\"col.text\"\n      />\n    </div>\n    <div :style=\"statsRowStyle\" class=\"absolute datv-stats_row\">\n      <div v-for=\"col in columns\" :key=\"col.offset\"\n        class=\"datv-stat\"\n        :class=\"{\n          'datv-col--border': col.border,\n          'datv-byte--selected': col.selected\n        }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n      >\n        <template v-if=\"col.stat\">\n          <div v-if=\"col.stat.string\"\n            class=\"datv-stat__line bg-yellow-500\" style=\"top: 0;\" />\n          <div v-if=\"col.stat.array\"\n            class=\"datv-stat__line bg-green-500\" style=\"top: 7px;\" />\n          <div v-if=\"col.stat.zero\"\n            class=\"datv-stat__line bg-gray-800\" style=\"top: 14px;\" />\n          <div v-else-if=\"col.stat.nullable\"\n            class=\"datv-stat__line bg-pink-400\" style=\"top: 14px;\" />\n          <div class=\"datv-stat__max\" v-text=\"col.stat.max\" />\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { toggleColsBetween } from '../selection'\nimport { sortRows } from '../sorting'\nimport { defineComponent, inject, shallowRef, shallowReactive, watch, computed, triggerRef } from 'vue'\nimport { saveHeaders, Viewer } from '../Viewer'\nimport * as rendering from '../rendering'\nimport { Header } from '../headers'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  props: {\n    left: {\n      type: Number,\n      required: true\n    },\n    width: {\n      type: Number,\n      required: true\n    },\n    columns: {\n      type: Array,\n      required: true\n    }\n  },\n  setup (props) {\n    const sortOrder = shallowRef(0)\n    let selectionStart = -1\n    let colsBeforeSelection = [] as readonly boolean[]\n\n    const viewer = inject<Viewer>('viewer')!\n\n    function selectStart (offset: number) {\n      selectionStart = offset\n      colsBeforeSelection = [...viewer.columnSelection.value]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, selectionStart, viewer.headers.value)\n      triggerRef(viewer.columnSelection)\n\n      document.addEventListener('mouseup', cancelSelection)\n      document.addEventListener('mouseleave', cancelSelection)\n      function cancelSelection () {\n        selectionStart = -1\n        document.removeEventListener('mouseup', cancelSelection)\n        document.removeEventListener('mouseleave', cancelSelection)\n      }\n    }\n\n    function selectContinue (offset: number, e: MouseEvent) {\n      if (selectionStart === -1 || e.buttons !== 1) return\n\n      const { memsize } = viewer.datFile\n      const len = offset - selectionStart\n      if (len >= memsize) {\n        offset = (selectionStart + memsize * 2) - 1\n      } else if (len >= 4) {\n        offset = (selectionStart + 8) - 1\n      } else if (len >= 2) {\n        offset = (selectionStart + 4) - 1\n      }\n      if (len <= -memsize) {\n        offset = (selectionStart - memsize * 2) + 1\n      } else if (len <= -4) {\n        offset = (selectionStart - 8) + 1\n      } else if (len <= -2) {\n        offset = (selectionStart - 4) + 1\n      }\n\n      viewer.columnSelection.value = [...colsBeforeSelection]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, offset, viewer.headers.value)\n    }\n\n    function editHeader (offset: number) {\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (\n        viewer.editHeader.value === header &&\n        (!header.type.byteView || header.type.byteView.array)\n      ) {\n        if (sortOrder.value === 0) {\n          sortOrder.value = 1\n        } else if (sortOrder.value === 1) {\n          sortOrder.value = -1\n        } else if (sortOrder.value === -1) {\n          sortOrder.value = 1\n        }\n        viewer.rowSorting.value = sortRows(header, sortOrder.value as 1 | -1, viewer.datFile)\n      } else {\n        viewer.editHeader.value = header\n        sortOrder.value = 0\n      }\n    }\n\n    function handleHeaderWheel (offset: number, e: WheelEvent) {\n      e.preventDefault()\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (header.textLength != null) {\n        header.textLength = Math.max(1, header.textLength -\n          Math.sign(e.deltaY) * (e.ctrlKey ? 4 * 3 - 2 : 1))\n        triggerRef(viewer.headers)\n        saveHeaders(viewer)\n      }\n    }\n\n    const headers = computed(() =>\n      renderHeaderCols(\n        viewer.headers.value,\n        viewer.editHeader.value,\n        props.left, props.left + props.width))\n\n    return {\n      headers,\n      selectStart,\n      selectContinue,\n      editHeader,\n      handleHeaderWheel,\n      headersRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, 0)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      colsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT}px)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      statsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT * 2}px)`, fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' }))\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\">\n.datv-col--border {\n  @apply border-l border-gray-400;\n}\n\n.datv-header {\n  @apply text-gray-600;\n  position: absolute;\n  box-sizing: border-box;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  @apply px-1.5;\n\n  &:hover {\n    @apply bg-gray-300;\n    @apply text-gray-700;\n  }\n\n  &.datv-header--active {\n    @apply bg-gray-500;\n    @apply text-gray-200;\n  }\n}\n\n.datv-byte {\n  @apply text-gray-600;\n  position: absolute;\n  box-sizing: content-box;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n\n  &:hover {\n    @apply bg-blue-400;\n    @apply text-white;\n  }\n\n  &.datv-byte--selected {\n    @apply bg-blue-500;\n    @apply text-blue-100;\n  }\n\n  &.datv-byte--selected.datv-col--border,\n  &.datv-byte--selected + &.datv-col--border {\n    @apply border-blue-600;\n  }\n}\n\n.datv-stat {\n  position: absolute;\n  box-sizing: content-box;\n  text-align: center;\n  white-space: nowrap;\n  line-height: 21px;\n  height: 21px;\n\n  &.datv-byte--selected.datv-col--border,\n  &.datv-byte--selected + &.datv-col--border {\n    @apply border-gray-400;\n  }\n\n  &.datv-byte--selected {\n    @apply bg-gray-300;\n  }\n\n  .datv-stats_row:hover > & {\n    @apply bg-gray-400;\n  }\n}\n\n.datv-stat__line {\n  position: absolute;\n  height: 7px;\n  width: 100%;\n\n  .datv-col--border > & {\n    width: calc(100% + 1px);\n    margin-left: -1px;\n  }\n\n  .datv-stats_row:hover & {\n    --tw-bg-opacity: 0.35;\n  }\n}\n\n.datv-stat__max {\n  visibility: hidden;\n  text-align: center;\n  cursor: default;\n  line-height: 21px;\n  width: 100%;\n  height: 21px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  @apply text-gray-50;\n  text-shadow: 0 0 0.5ch rgb(0 0 0 / 70%);\n\n  .datv-stats_row:hover & {\n    visibility: visible;\n  }\n}\n\n.datv-header-layer {\n  position: absolute;\n  overflow: hidden;\n  transform: translate3d(0, 0, 0);\n  contain: strict;\n  @apply bg-gray-100;\n}\n</style>\n","import { readColumn, DatFile, Header } from 'pathofexile-dat'\n\nexport function sortRows (header: Header, order: 1 | -1, datFile: DatFile): number[] {\n  const data = readColumn(header, datFile)\n\n  const rows = Array.from({ length: datFile.rowCount }, (_, idx) => idx)\n  if (header.type.array) {\n    rows.sort((ai, bi) => {\n      const a = data[ai] as unknown[]\n      const b = data[bi] as unknown[]\n      return (b.length - a.length) * order\n    })\n  } else {\n    if (header.type.boolean) {\n      rows.sort((ai, bi) => {\n        const a = Number(data[ai] as boolean)\n        const b = Number(data[bi] as boolean)\n        return (a - b) * order\n      })\n    } else if (header.type.string) {\n      rows.sort((ai, bi) => {\n        const a = data[ai] as string\n        const b = data[bi] as string\n        return a.localeCompare(b) * order\n      })\n    } else if (header.type.integer || header.type.decimal) {\n      rows.sort((ai, bi) => {\n        const a = data[ai] as number\n        const b = data[bi] as number\n        return (b - a) * order\n      })\n    } else if (header.type.key) {\n      if (header.type.key.foreign) {\n        rows.sort((ai, bi) => {\n          const a = data[ai] as { rid: number, unknown: number } | null\n          const b = data[bi] as { rid: number, unknown: number } | null\n          return ((b?.rid || 0) - (a?.rid || 0)) * order\n        })\n      } else {\n        rows.sort((ai, bi) => {\n          const a = Number(data[ai] as number | null)\n          const b = Number(data[bi] as number | null)\n          return (b - a) * order\n        })\n      }\n    }\n  }\n\n  return rows\n}\n","import { CHAR_WIDTH, LINE_HEIGHT } from '../rendering'\nimport { getFieldReader } from 'pathofexile-dat/dat/reader'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport type { Header } from '../headers'\n\ninterface StringifyOut {\n  text: string\n  color: string\n}\n\nfunction numberToString (value: number, out: StringifyOut) {\n  out.text = String(value)\n  out.color = '#098658'\n}\nfunction numberArrayToString (value: number[], out: StringifyOut) {\n  out.text = `[${value.join(', ')}]`\n  out.color = '#098658'\n}\nfunction booleanToString (value: boolean, out: StringifyOut) {\n  out.text = String(value)\n  out.color = '#0000ff'\n}\nfunction booleanArrayToString (value: boolean[], out: StringifyOut) {\n  out.text = `[${value.join(', ')}]`\n  out.color = '#0000ff'\n}\nfunction stringToString (value: string, out: StringifyOut) {\n  if (value === '') {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = String(value)\n    out.color = '#001080'\n  }\n}\nfunction stringArrayToString (value: string[], out: StringifyOut) {\n  out.text = `[${value.map(str => '\"' + str + '\"').join(', ')}]`\n  out.color = '#001080'\n}\nfunction keySelfToString (value: number | null, out: StringifyOut) {\n  if (value === null) {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = `<${value}, self>`\n    out.color = '#098658'\n  }\n}\nfunction keySelfArrayToString (value: number[], out: StringifyOut) {\n  out.text = `[${value.map(key => `<${key}, self>`).join(', ')}]`\n  out.color = '#098658'\n}\nfunction keyForeignToString (value: { rid: number, unknown: number } | null, out: StringifyOut) {\n  if (value === null) {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = `<${value.rid}, ${value.unknown}>`\n    out.color = '#098658'\n  }\n}\nfunction keyForeignArrayToString (value: { rid: number, unknown: number }[], out: StringifyOut) {\n  out.text = `[${value.map(key => `<${key.rid}, ${key.unknown}>`).join(', ')}]`\n  out.color = '#098658'\n}\n\nexport function renderCellContent (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[]) {\n  const read = getFieldReader(header, datFile)\n\n  const draw: StringifyOut = { text: '', color: '' }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const stringify: (value: any, out: StringifyOut) => void = (() => {\n    if (header.type.array) {\n      if (header.type.boolean) return booleanArrayToString\n      if (header.type.string) return stringArrayToString\n      if (header.type.integer || header.type.decimal) return numberArrayToString\n      if (header.type.key && header.type.key.foreign) return keyForeignArrayToString\n      if (header.type.key && !header.type.key.foreign) return keySelfArrayToString\n    } else {\n      if (header.type.boolean) return booleanToString\n      if (header.type.string) return stringToString\n      if (header.type.integer || header.type.decimal) return numberToString\n      if (header.type.key && header.type.key.foreign) return keyForeignToString\n      if (header.type.key && !header.type.key.foreign) return keySelfToString\n    }\n    throw new Error('never')\n  })()\n\n  let textY = 0\n  let prevColor = ''\n  for (const rid of rows) {\n    stringify(read(rid), draw)\n    if (prevColor !== draw.color) {\n      ctx.fillStyle = draw.color\n      prevColor = draw.color\n    }\n    ctx.fillText(draw.text, 0, textY)\n    textY += LINE_HEIGHT\n  }\n}\n\nexport function drawByteView (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[], begin: number, end: number) {\n  ctx.fillStyle = '#000'\n\n  let textY = 0\n  for (const rowIdx of rows) {\n    const data = datFile.dataFixed.subarray(\n      (rowIdx * datFile.rowLength) + header.offset + begin,\n      (rowIdx * datFile.rowLength) + header.offset + end\n    )\n    const hexDump = Array.from(data, byte =>\n      byte.toString(16).padStart(2, '0')\n    ).join(' ')\n\n    ctx.fillText(hexDump, begin * (CHAR_WIDTH * 3), textY)\n    textY += LINE_HEIGHT\n  }\n}\n\nexport function drawArrayVarData (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[], stats: ColumnStats) {\n  ctx.fillStyle = '#000'\n\n  const stat = stats.refArray as Exclude<typeof stats['refArray'], false>\n  const entryMaxLength = Math.max(...([\n    (stat.keyForeign ? datFile.fieldSize.KEY_FOREIGN : 0),\n    (stat.keySelf ? datFile.fieldSize.KEY : 0),\n    (stat.string ? datFile.fieldSize.STRING : 0),\n    (stat.longLong ? datFile.fieldSize.LONGLONG : 0),\n    (stat.long ? datFile.fieldSize.LONG : 0),\n    (stat.short ? datFile.fieldSize.SHORT : 0),\n    (datFile.fieldSize.BYTE)\n  ]))\n  const maxReadBytes = Math.ceil(header.textLength! / 3)\n\n  let textY = 0\n  for (const rowIdx of rows) {\n    const arrayLength = datFile.readerFixed.getSizeT((rowIdx * datFile.rowLength) + header.offset)\n    if (arrayLength === 0) {\n      ctx.fillText('[]', 0, textY)\n    } else {\n      const varOffset = datFile.readerFixed.getSizeT((rowIdx * datFile.rowLength) + header.offset + datFile.memsize)\n\n      const data = datFile.dataVariable.subarray(\n        varOffset,\n        varOffset + Math.min(entryMaxLength * arrayLength, maxReadBytes)\n      )\n      const hexDump = Array.from(data, byte =>\n        byte.toString(16).padStart(2, '0')\n      ).join(' ')\n\n      ctx.fillText(`${arrayLength} { ${hexDump} }`, 0, textY)\n    }\n    textY += LINE_HEIGHT\n  }\n}\n","import type { Header } from './headers'\nimport type { RenderByte } from './rendering/byte-columns'\nimport type { Viewer } from './Viewer'\nimport { renderCellContent, drawByteView, drawArrayVarData } from './rendering/content'\n\n/* eslint-disable */\nexport const FONT_FAMILY    = 'Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace'\nexport const FONT_SIZE      = 14\nexport const CHAR_WIDTH     = getMonoFontWidth(FONT_SIZE, FONT_FAMILY)\nexport const XBASE_HEIGHT   = getFontBaseLine(FONT_SIZE, FONT_FAMILY)\nexport const LINE_HEIGHT    = 19\nexport const ROWNUM_MIN_LENGTH    = 3\nexport const BORDER_WIDTH         = 1\nexport const COLUMN_STAT_HEIGHT   = 7\nexport const COLUMN_BYTE_HEIGHT   = Math.round(CHAR_WIDTH * 3)\nexport const HEADERS_HEIGHT       = COLUMN_BYTE_HEIGHT * 2 + COLUMN_STAT_HEIGHT * 3\n/* eslint-enable */\n\n// console.log(getBaseLine(14), 'CR: 11  |  FF: 12')\n// console.log(getBaseLine(18), 'CR: 13  |  FF: 14')\n// console.log(getBaseLine(19), 'CR: 14  |  FF: 14')\n// console.log(getBaseLine(20), 'CR: 14  |  FF: 15')\n\nexport function rowNumLength (rowCount: number) {\n  const maxLen = String(rowCount - 1).length\n  return Math.max(maxLen, ROWNUM_MIN_LENGTH)\n}\n\nexport function rowsNumWidth (rowCount: number) {\n  return Math.ceil(rowNumLength(rowCount) * CHAR_WIDTH)\n}\n\nexport function rowsOverlayWidth (rowCount: number) {\n  return rowsNumWidth(rowCount) + (8 * 2)\n}\n\nfunction getMonoFontWidth (fontSize: number, fontFamily: string): number {\n  const canvasEl = document.createElement('canvas')\n  const context = canvasEl.getContext('2d')!\n  context.font = `${fontSize}px ${fontFamily}`\n  const metrics = context.measureText('0')\n  return metrics.width\n}\n\nfunction getFontBaseLine (fontSize: number, fontFamily: string): number {\n  const canvasEl = document.createElement('canvas')\n  const context = canvasEl.getContext('2d')!\n  context.font = `${fontSize}px ${fontFamily}`\n  context.textBaseline = 'middle'\n  const metrics = context.measureText('0')\n  const xBase = (fontSize / 2) +\n    ((metrics.alphabeticBaseline !== undefined)\n      ? -metrics.alphabeticBaseline\n      : metrics.actualBoundingBoxDescent)\n\n  return xBase\n}\n\nexport function getBaseLine (lineHeight: number): number {\n  return /* Math.round */ (1 + (lineHeight - FONT_SIZE) / 2 + XBASE_HEIGHT)\n}\n\nexport function drawRows (params: {\n  left: number\n  paintWidth: number\n  top: number\n  rows: number[]\n  columns: RenderByte[]\n  viewer: Viewer\n  ctx: CanvasRenderingContext2D\n}) {\n  const { ctx } = params\n\n  ctx.fillStyle = '#fff'\n  ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n  // draw selected row\n  if (params.viewer.selectedRow.value !== null) {\n    const selectedIdx = params.rows.indexOf(params.viewer.selectedRow.value)\n    if (selectedIdx !== -1) {\n      ctx.fillStyle = '#bee3f8'\n      ctx.fillRect(\n        0, params.top + (selectedIdx * LINE_HEIGHT),\n        ctx.canvas.width, LINE_HEIGHT\n      )\n    }\n  }\n\n  // drawColumns\n  ctx.save()\n  ctx.translate(-params.left, 0)\n  drawColumns(ctx, params.columns)\n  ctx.restore()\n\n  // draw content\n  ctx.font = `${FONT_SIZE}px ${FONT_FAMILY}`\n  ctx.fillStyle = '#000'\n\n  const renderers = getColumnRenderers(params.viewer, params.left, params.left + params.paintWidth)\n\n  for (const render of renderers) {\n    ctx.save()\n    ctx.beginPath()\n    ctx.translate(render.left - params.left, 0)\n    ctx.rect(0, 0, render.width, ctx.canvas.height)\n    ctx.clip()\n    ctx.translate(CHAR_WIDTH / 2, params.top + getBaseLine(LINE_HEIGHT))\n    render.exec(ctx, params.rows)\n    ctx.restore()\n  }\n\n  // draw inset shadow\n  {\n    const grdH = ctx.createLinearGradient(0, -16, 0, 4)\n    grdH.addColorStop(0, 'rgba(254,254,254,0.6)')\n    grdH.addColorStop(1, 'transparent')\n    ctx.fillStyle = grdH\n    ctx.fillRect(0, 0, ctx.canvas.width, 6)\n\n    const grdV = ctx.createLinearGradient(-16, 0, 4, 0)\n    grdV.addColorStop(0, 'rgba(254,254,254,0.5)')\n    grdV.addColorStop(1, 'transparent')\n    ctx.fillStyle = grdV\n    ctx.fillRect(0, 0, 6, ctx.canvas.height)\n  }\n}\n\nfunction drawColumns (ctx: CanvasRenderingContext2D, columns: readonly RenderByte[]) {\n  for (const col of columns) {\n    if (col.selected) {\n      ctx.fillStyle = '#bee3f8'\n      ctx.fillRect(\n        col.leftPx + (col.border ? BORDER_WIDTH : 0), 0,\n        col.widthPx, ctx.canvas.height\n      )\n    }\n    if (col.border) {\n      ctx.fillStyle = '#bdbdbd'\n      ctx.fillRect(\n        col.leftPx, 0,\n        BORDER_WIDTH, ctx.canvas.height\n      )\n    }\n  }\n}\n\ntype DrawColumnContentFn = (ctx: CanvasRenderingContext2D, rows: number[]) => void\ninterface ColumnContentRenderer {\n  left: number\n  width: number\n  exec: DrawColumnContentFn\n}\n\nexport function getColumnRenderers (viewer: Viewer, paintBegin: number, paintEnd: number): ColumnContentRenderer[] {\n  const headers = viewer.headers.value\n  const stats = viewer.columnStats.value\n  const datFile = viewer.datFile\n\n  const res: ColumnContentRenderer[] = []\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if ((left + sizes.borderWidth) >= paintBegin) {\n      if (header.type.byteView) {\n        if (header.type.byteView.array) {\n          res.push({\n            left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n            width: sizes.paddingWidth,\n            exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n              drawArrayVarData(ctx, header, datFile, rows, stats[header.offset])\n          })\n        } else {\n          const hexBegin = Math.max(0, Math.floor((paintBegin - left) / (CHAR_WIDTH * 3)))\n          const hexEnd = Math.min(header.length, Math.ceil((paintEnd - left) / (CHAR_WIDTH * 3)))\n          res.push({\n            left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n            width: sizes.paddingWidth,\n            exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n              drawByteView(ctx, header, datFile, rows, hexBegin, hexEnd)\n          })\n        }\n      } else {\n        res.push({\n          left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n          width: sizes.paddingWidth,\n          exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n            renderCellContent(ctx, header, datFile, rows)\n        })\n      }\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n\nexport function columnSizes (header: Readonly<Header>) {\n  const textLength = (header.type.byteView && !header.type.byteView.array)\n    ? header.length * 3 - 1\n    : header.textLength!\n  return {\n    paddingWidth: Math.ceil((textLength + 1) * CHAR_WIDTH),\n    borderWidth: Math.ceil((textLength + 1) * CHAR_WIDTH) + (header.offset > 0 ? BORDER_WIDTH : 0),\n    hasBorder: header.offset > 0\n  }\n}\n\nexport function getRowWidth (headers: readonly Header[]): number {\n  let size = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n    size += sizes.borderWidth\n  }\n  return size\n}\n","import type { Header } from '../headers'\nimport { columnSizes } from '../rendering'\n\ninterface RenderHeader {\n  offset: number\n  border: boolean\n  active: boolean\n  widthPx: number\n  leftPx: number\n  name: string | null\n}\n\nexport function renderHeaderCols (\n  headers: readonly Header[],\n  activeHeader: Header | null,\n  paintBegin: number,\n  paintEnd: number\n) {\n  const res: RenderHeader[] = []\n\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if ((left + sizes.borderWidth) >= paintBegin) {\n      res.push({\n        offset: header.offset,\n        border: sizes.hasBorder,\n        active: (header === activeHeader),\n        widthPx: sizes.borderWidth,\n        leftPx: left,\n        name: header.name\n      })\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n","\nimport { toggleColsBetween } from '../selection'\nimport { sortRows } from '../sorting'\nimport { defineComponent, inject, shallowRef, shallowReactive, watch, computed, triggerRef } from 'vue'\nimport { saveHeaders, Viewer } from '../Viewer'\nimport * as rendering from '../rendering'\nimport { Header } from '../headers'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  props: {\n    left: {\n      type: Number,\n      required: true\n    },\n    width: {\n      type: Number,\n      required: true\n    },\n    columns: {\n      type: Array,\n      required: true\n    }\n  },\n  setup (props) {\n    const sortOrder = shallowRef(0)\n    let selectionStart = -1\n    let colsBeforeSelection = [] as readonly boolean[]\n\n    const viewer = inject<Viewer>('viewer')!\n\n    function selectStart (offset: number) {\n      selectionStart = offset\n      colsBeforeSelection = [...viewer.columnSelection.value]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, selectionStart, viewer.headers.value)\n      triggerRef(viewer.columnSelection)\n\n      document.addEventListener('mouseup', cancelSelection)\n      document.addEventListener('mouseleave', cancelSelection)\n      function cancelSelection () {\n        selectionStart = -1\n        document.removeEventListener('mouseup', cancelSelection)\n        document.removeEventListener('mouseleave', cancelSelection)\n      }\n    }\n\n    function selectContinue (offset: number, e: MouseEvent) {\n      if (selectionStart === -1 || e.buttons !== 1) return\n\n      const { memsize } = viewer.datFile\n      const len = offset - selectionStart\n      if (len >= memsize) {\n        offset = (selectionStart + memsize * 2) - 1\n      } else if (len >= 4) {\n        offset = (selectionStart + 8) - 1\n      } else if (len >= 2) {\n        offset = (selectionStart + 4) - 1\n      }\n      if (len <= -memsize) {\n        offset = (selectionStart - memsize * 2) + 1\n      } else if (len <= -4) {\n        offset = (selectionStart - 8) + 1\n      } else if (len <= -2) {\n        offset = (selectionStart - 4) + 1\n      }\n\n      viewer.columnSelection.value = [...colsBeforeSelection]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, offset, viewer.headers.value)\n    }\n\n    function editHeader (offset: number) {\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (\n        viewer.editHeader.value === header &&\n        (!header.type.byteView || header.type.byteView.array)\n      ) {\n        if (sortOrder.value === 0) {\n          sortOrder.value = 1\n        } else if (sortOrder.value === 1) {\n          sortOrder.value = -1\n        } else if (sortOrder.value === -1) {\n          sortOrder.value = 1\n        }\n        viewer.rowSorting.value = sortRows(header, sortOrder.value as 1 | -1, viewer.datFile)\n      } else {\n        viewer.editHeader.value = header\n        sortOrder.value = 0\n      }\n    }\n\n    function handleHeaderWheel (offset: number, e: WheelEvent) {\n      e.preventDefault()\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (header.textLength != null) {\n        header.textLength = Math.max(1, header.textLength -\n          Math.sign(e.deltaY) * (e.ctrlKey ? 4 * 3 - 2 : 1))\n        triggerRef(viewer.headers)\n        saveHeaders(viewer)\n      }\n    }\n\n    const headers = computed(() =>\n      renderHeaderCols(\n        viewer.headers.value,\n        viewer.editHeader.value,\n        props.left, props.left + props.width))\n\n    return {\n      headers,\n      selectStart,\n      selectContinue,\n      editHeader,\n      handleHeaderWheel,\n      headersRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, 0)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      colsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT}px)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      statsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT * 2}px)`, fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' }))\n    }\n  }\n})\n","import { render } from \"./ViewerHead.vue?vue&type=template&id=19576deb\"\nimport script from \"./ViewerHead.vue?vue&type=script&lang=ts\"\nexport * from \"./ViewerHead.vue?vue&type=script&lang=ts\"\n\nimport \"./ViewerHead.vue?vue&type=style&index=0&id=19576deb&lang=postcss\"\nscript.render = render\n\nexport default script","<template>\n  <div v-if=\"isVisible\" style=\"width: 300px;\" class=\"relative overflow-hidden\">\n    <div :style=\"{ height: HEADERS_HEIGHT + 'px' }\" class=\"bg-gray-100\" />\n    <div class=\"m-2 shadow border border-gray-300 bg-white absolute inset-0 flex flex-col\">\n      <div class=\"p-2 bg-gray-100 text-gray-600 shadow flex items-baseline\">\n        <span class=\"px-2\">Column properties</span>\n        <button class=\"border border-gray-400 rounded-full px-3\"\n          @click=\"$emit('focus-editing-header')\">Focus</button>\n        <button @click=\"close\" class=\"px-2 py-1 ml-auto\"\n          title=\"Close\"><i class=\"codicon codicon-close\"></i></button>\n      </div>\n      <div v-if=\"header.name === null\" class=\"p-4\">\n        <div>{{ header.length }} bytes of unidentified data</div>\n      </div>\n      <div v-else class=\"p-4 overflow-auto\">\n        <div class=\"mb-4\">\n          <label for=\"datv-header-name\">Name</label>\n          <input id=\"datv-header-name\" placeholder=\"Unnamed\" v-model.trim=\"header.name\"\n            class=\"border p-1 mt-1 w-full focus:border-blue-500\" spellcheck=\"false\">\n        </div>\n        <div class=\"mb-4 flex items-baseline\">\n          <div class=\"mr-2\">View mode</div>\n          <div class=\"space-x-px flex\">\n            <button v-for=\"opt in viewModeOpts\" :key=\"opt.value\"\n              class=\"px-2\"\n              :class=\"(byteViewMode === opt.value) ? 'bg-blue-600 text-white' : 'bg-gray-100 hover:bg-gray-300'\"\n              @click=\"byteViewMode = opt.value\"\n              :disabled=\"opt.disabled\"\n              v-text=\"opt.label\" />\n          </div>\n        </div>\n        <div class=\"mb-4\">\n          <div class=\"mb-2 flex justify-between items-baseline\">\n            <span>Data type</span>\n            <button class=\"text-red-700 bg-red-100 px-2\"\n             @click=\"remove\">Delete</button>\n          </div>\n          <div>\n            <div v-for=\"opt in dataTypeOpts\" :key=\"opt.value\" class=\"mb-0.5\">\n              <label class=\"inline-flex items-center\">\n                <input type=\"radio\" v-model=\"dataType\" :value=\"opt.value\">\n                <span class=\"ml-2 cursor-pointer\">{{ opt.label }}</span>\n              </label>\n            </div>\n            <div v-if=\"arrayTypeOpts.length\" class=\"mt-3\">\n              <div class=\"mb-1\">of ...</div>\n              <div v-for=\"opt in arrayTypeOpts\" :key=\"opt.value\" class=\"mb-0.5\">\n                <label class=\"inline-flex items-center\">\n                  <input type=\"radio\" v-model=\"arrayType\" :value=\"opt.value\">\n                  <span class=\"ml-2 cursor-pointer\">{{ opt.label }}</span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"mb-4\" v-if=\"header.type.integer\">\n          <label class=\"inline-flex items-center\">\n            <input type=\"checkbox\" v-model=\"header.type.integer.unsigned\">\n            <span class=\"ml-2 cursor-pointer\">Unsigned</span>\n          </label>\n        </div>\n        <div class=\"mb-4 border-t pt-4\" v-if=\"dataType\">\n          <label class=\"mr-4\">Width</label>\n          <input v-model.number=\"header.textLength\"\n            class=\"border w-16 text-center\"> chars\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, computed, triggerRef, reactive, watch, WatchStopHandle } from 'vue'\nimport { Header, removeHeader } from '../headers'\nimport { Viewer, saveHeaders } from '../Viewer'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { HEADERS_HEIGHT } from '../rendering'\n\nfunction dataTypeOpts (header: Header, stats: ColumnStats, datFile: DatFile) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  const { fieldSize } = datFile\n  const len = header.length\n  if (len === fieldSize.ARRAY && stats.refArray) {\n    opts.push({ label: 'Array', value: 'array' })\n  }\n  if (len === fieldSize.STRING && stats.refString) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (len === fieldSize.KEY && stats.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (len === fieldSize.KEY_FOREIGN) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (len === 8 || len === 4 || len === 2 || len === 1) {\n    opts.push({ label: 'Integer', value: 'integer' })\n  }\n  if (len === 8 || len === 4) {\n    opts.push({ label: 'Decimal', value: 'decimal' })\n  }\n  if (len === 1 && stats.bMax <= 0x01) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n\n  return opts\n}\n\nfunction arrayTypeOpts (header: Header, stats: ColumnStats) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  if (!header.type.array || !stats.refArray) {\n    return opts\n  }\n\n  const array = stats.refArray\n  if (array.string) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (array.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (array.keyForeign) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Integer - 8 bytes', value: 'integer_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Integer - 4 bytes', value: 'integer_4' })\n  }\n  if (array.short) {\n    opts.push({ label: 'Integer - 2 bytes', value: 'integer_2' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Decimal - 8 bytes', value: 'decimal_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Decimal - 4 bytes', value: 'decimal_4' })\n  }\n  if (array.boolean) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n  opts.push({ label: 'Integer - byte', value: 'integer_1' })\n\n  return opts\n}\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const headerRef = computed(() => (viewer.editHeader.value && reactive(viewer.editHeader.value))!)\n    {\n      let watchStop = null as WatchStopHandle | null\n      watch(headerRef, (value) => {\n        if (watchStop) {\n          watchStop()\n          watchStop = null\n        }\n        if (value) {\n          watchStop = watch(value, () => {\n            triggerRef(viewer.headers)\n            saveHeaders(viewer)\n          }, { deep: true })\n        }\n      })\n    }\n\n    const stats = computed(() => viewer.columnStats.value[headerRef.value.offset])\n\n    const dataType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.array) {\n          return 'array'\n        } else if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return type.key.foreign ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return 'integer'\n        } else if (type.decimal) {\n          return 'decimal'\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = {}\n        if (type === 'array') {\n          header.type.array = true\n          header.type.byteView = { array: true }\n        } else if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer') {\n          header.type.integer = { unsigned: false, size: header.length }\n        } else if (type === 'decimal') {\n          header.type.decimal = { size: header.length }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const arrayType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return (type.key.foreign) ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return `integer_${type.integer.size}`\n        } else if (type.decimal) {\n          return `decimal_${type.decimal.size}`\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = { array: true }\n        if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer_1') {\n          header.type.integer = { unsigned: false, size: 1 }\n        } else if (type === 'integer_2') {\n          header.type.integer = { unsigned: false, size: 2 }\n        } else if (type === 'integer_4') {\n          header.type.integer = { unsigned: false, size: 4 }\n        } else if (type === 'integer_8') {\n          header.type.integer = { unsigned: false, size: 8 }\n        } else if (type === 'decimal_4') {\n          header.type.decimal = { size: 4 }\n        } else if (type === 'decimal_8') {\n          header.type.decimal = { size: 8 }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const viewModeOpts = computed(() => {\n      const opts = [] as Array<{ label: string, value: string, disabled?: boolean }>\n      const type = headerRef.value.type\n\n      opts.push({ label: 'Bytes', value: 'bytes' })\n      if (type.array) {\n        opts.push({ label: 'Var. bytes', value: 'array-bytes' })\n      }\n      opts.push({ label: 'Data', value: 'data', disabled: !dataType.value || (dataType.value === 'array' && !arrayType.value) })\n\n      return opts\n    })\n\n    const byteViewMode = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.byteView) {\n          return type.byteView.array ? 'array-bytes' : 'bytes'\n        } else {\n          return 'data'\n        }\n      },\n      set (mode) {\n        const type = headerRef.value.type\n        if (mode === 'data') {\n          type.byteView = undefined\n        } else {\n          type.byteView = {\n            array: mode === 'array-bytes'\n          }\n        }\n      }\n    })\n\n    function close () {\n      viewer.editHeader.value = null\n    }\n\n    function remove () {\n      removeHeader(headerRef.value, viewer.headers.value)\n      viewer.editHeader.value = null\n      triggerRef(viewer.headers)\n      saveHeaders(viewer)\n    }\n\n    return {\n      isVisible: computed(() => viewer.editHeader.value != null),\n      HEADERS_HEIGHT,\n      header: headerRef,\n      byteViewMode,\n      dataType,\n      arrayType,\n      close,\n      remove,\n      viewModeOpts,\n      dataTypeOpts: computed(() =>\n        dataTypeOpts(headerRef.value, stats.value, viewer.datFile)),\n      arrayTypeOpts: computed(() =>\n        arrayTypeOpts(headerRef.value, stats.value))\n    }\n  }\n})\n</script>\n","\nimport { defineComponent, inject, computed, triggerRef, reactive, watch, WatchStopHandle } from 'vue'\nimport { Header, removeHeader } from '../headers'\nimport { Viewer, saveHeaders } from '../Viewer'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { HEADERS_HEIGHT } from '../rendering'\n\nfunction dataTypeOpts (header: Header, stats: ColumnStats, datFile: DatFile) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  const { fieldSize } = datFile\n  const len = header.length\n  if (len === fieldSize.ARRAY && stats.refArray) {\n    opts.push({ label: 'Array', value: 'array' })\n  }\n  if (len === fieldSize.STRING && stats.refString) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (len === fieldSize.KEY && stats.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (len === fieldSize.KEY_FOREIGN) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (len === 8 || len === 4 || len === 2 || len === 1) {\n    opts.push({ label: 'Integer', value: 'integer' })\n  }\n  if (len === 8 || len === 4) {\n    opts.push({ label: 'Decimal', value: 'decimal' })\n  }\n  if (len === 1 && stats.bMax <= 0x01) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n\n  return opts\n}\n\nfunction arrayTypeOpts (header: Header, stats: ColumnStats) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  if (!header.type.array || !stats.refArray) {\n    return opts\n  }\n\n  const array = stats.refArray\n  if (array.string) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (array.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (array.keyForeign) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Integer - 8 bytes', value: 'integer_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Integer - 4 bytes', value: 'integer_4' })\n  }\n  if (array.short) {\n    opts.push({ label: 'Integer - 2 bytes', value: 'integer_2' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Decimal - 8 bytes', value: 'decimal_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Decimal - 4 bytes', value: 'decimal_4' })\n  }\n  if (array.boolean) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n  opts.push({ label: 'Integer - byte', value: 'integer_1' })\n\n  return opts\n}\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const headerRef = computed(() => (viewer.editHeader.value && reactive(viewer.editHeader.value))!)\n    {\n      let watchStop = null as WatchStopHandle | null\n      watch(headerRef, (value) => {\n        if (watchStop) {\n          watchStop()\n          watchStop = null\n        }\n        if (value) {\n          watchStop = watch(value, () => {\n            triggerRef(viewer.headers)\n            saveHeaders(viewer)\n          }, { deep: true })\n        }\n      })\n    }\n\n    const stats = computed(() => viewer.columnStats.value[headerRef.value.offset])\n\n    const dataType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.array) {\n          return 'array'\n        } else if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return type.key.foreign ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return 'integer'\n        } else if (type.decimal) {\n          return 'decimal'\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = {}\n        if (type === 'array') {\n          header.type.array = true\n          header.type.byteView = { array: true }\n        } else if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer') {\n          header.type.integer = { unsigned: false, size: header.length }\n        } else if (type === 'decimal') {\n          header.type.decimal = { size: header.length }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const arrayType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return (type.key.foreign) ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return `integer_${type.integer.size}`\n        } else if (type.decimal) {\n          return `decimal_${type.decimal.size}`\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = { array: true }\n        if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer_1') {\n          header.type.integer = { unsigned: false, size: 1 }\n        } else if (type === 'integer_2') {\n          header.type.integer = { unsigned: false, size: 2 }\n        } else if (type === 'integer_4') {\n          header.type.integer = { unsigned: false, size: 4 }\n        } else if (type === 'integer_8') {\n          header.type.integer = { unsigned: false, size: 8 }\n        } else if (type === 'decimal_4') {\n          header.type.decimal = { size: 4 }\n        } else if (type === 'decimal_8') {\n          header.type.decimal = { size: 8 }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const viewModeOpts = computed(() => {\n      const opts = [] as Array<{ label: string, value: string, disabled?: boolean }>\n      const type = headerRef.value.type\n\n      opts.push({ label: 'Bytes', value: 'bytes' })\n      if (type.array) {\n        opts.push({ label: 'Var. bytes', value: 'array-bytes' })\n      }\n      opts.push({ label: 'Data', value: 'data', disabled: !dataType.value || (dataType.value === 'array' && !arrayType.value) })\n\n      return opts\n    })\n\n    const byteViewMode = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.byteView) {\n          return type.byteView.array ? 'array-bytes' : 'bytes'\n        } else {\n          return 'data'\n        }\n      },\n      set (mode) {\n        const type = headerRef.value.type\n        if (mode === 'data') {\n          type.byteView = undefined\n        } else {\n          type.byteView = {\n            array: mode === 'array-bytes'\n          }\n        }\n      }\n    })\n\n    function close () {\n      viewer.editHeader.value = null\n    }\n\n    function remove () {\n      removeHeader(headerRef.value, viewer.headers.value)\n      viewer.editHeader.value = null\n      triggerRef(viewer.headers)\n      saveHeaders(viewer)\n    }\n\n    return {\n      isVisible: computed(() => viewer.editHeader.value != null),\n      HEADERS_HEIGHT,\n      header: headerRef,\n      byteViewMode,\n      dataType,\n      arrayType,\n      close,\n      remove,\n      viewModeOpts,\n      dataTypeOpts: computed(() =>\n        dataTypeOpts(headerRef.value, stats.value, viewer.datFile)),\n      arrayTypeOpts: computed(() =>\n        arrayTypeOpts(headerRef.value, stats.value))\n    }\n  }\n})\n","import { render } from \"./HeaderProps.vue?vue&type=template&id=5860aeb3\"\nimport script from \"./HeaderProps.vue?vue&type=script&lang=ts\"\nexport * from \"./HeaderProps.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { BORDER_WIDTH, CHAR_WIDTH, columnSizes } from '../rendering'\nimport type { Header } from '../headers'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport type { DatFile } from 'pathofexile-dat'\n\nconst BYTE_WIDTH = Math.ceil(CHAR_WIDTH * 3)\n\ninterface RenderStat {\n  max: string\n  array: boolean\n  string: boolean\n  nullable: boolean\n  zero: boolean\n}\n\nexport interface RenderByte {\n  offset: number\n  selected: boolean\n  border: boolean\n  widthPx: number\n  leftPx: number\n  text: string\n  stat?: RenderStat\n}\n\nexport function renderByteCols (\n  selection: readonly boolean[],\n  stats: readonly RenderStat[],\n  headers: readonly Header[],\n  paintBegin: number,\n  paintEnd: number\n): RenderByte[] {\n  const res: RenderByte[] = []\n\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if (header.type.byteView && !header.type.byteView.array) {\n      let textLeft = left\n      for (let i = 0; i < header.length; ++i) {\n        const hasBorder = (sizes.hasBorder && i === 0)\n        const thisWidth = (CHAR_WIDTH * 3) + (hasBorder ? BORDER_WIDTH : 0)\n        if ((Math.ceil(textLeft) + thisWidth) < paintBegin) {\n          textLeft += thisWidth\n          continue\n        }\n\n        const offset = header.offset + i\n        res.push({\n          offset,\n          selected: selection[offset],\n          border: hasBorder,\n          widthPx: BYTE_WIDTH,\n          leftPx: Math.ceil(textLeft),\n          text: String(offset % 100).padStart(2, '0'),\n          stat: stats[offset]\n        })\n\n        textLeft += thisWidth\n        if (Math.ceil(textLeft) >= paintEnd) return res\n      }\n    } else if ((left + sizes.borderWidth) >= paintBegin) {\n      res.push({\n        offset: header.offset,\n        selected: false,\n        border: sizes.hasBorder,\n        widthPx: sizes.paddingWidth,\n        leftPx: left,\n        text: String(header.offset % 100).padStart(2, '0')\n      })\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n\nexport function renderColStats (stats: ColumnStats[], datFile: DatFile): RenderStat[] {\n  const render = stats.map(stat => ({\n    max: stat.bMax.toString(16).padStart(2, '0'),\n    array: false,\n    string: false,\n    nullable: false,\n    zero: (stat.bMax === 0x00)\n  }))\n\n  const { fieldSize } = datFile\n  for (let idx = 0; idx < stats.length; ++idx) {\n    const stat = stats[idx]\n    if (stat.refString) {\n      for (let k = 0; k < fieldSize.STRING; ++k) {\n        render[idx + k].string = true\n      }\n    }\n    if (stat.refArray) {\n      for (let k = 0; k < fieldSize.ARRAY; ++k) {\n        render[idx + k].array = true\n      }\n    }\n    if (stat.nullableMemsize) {\n      for (let k = 0; k < datFile.memsize; ++k) {\n        render[idx + k].nullable = true\n      }\n    }\n  }\n\n  return render\n}\n","\nimport { defineComponent, PropType, reactive, computed, provide, watch, shallowRef, shallowReactive, ref, render, onMounted } from 'vue'\nimport ResizeObserver from '@/ResizeObserver.vue'\nimport CanvasScroll from '@/CanvasScroll.vue'\nimport { Viewer, createViewer } from '../Viewer'\nimport ViewerActions from './Actions.vue'\nimport ViewerHead from './ViewerHead.vue'\nimport HeaderProps from './HeaderProps.vue'\nimport * as rendering from '../rendering'\nimport { renderByteCols, renderColStats } from '../rendering/byte-columns'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll, ViewerActions, ViewerHead, HeaderProps },\n  emits: ['update:kaState'],\n  props: {\n    args: {\n      type: Object as PropType<{\n        fileContent: Uint8Array\n        fullPath: string\n      }>,\n      required: true\n    },\n    kaState: {\n      type: Object as PropType<Viewer | undefined>,\n      default: undefined\n    }\n  },\n  setup (props, ctx) {\n    let viewer: Viewer\n    if (props.kaState) {\n      viewer = props.kaState // eslint-disable-line vue/no-setup-props-destructure\n    } else {\n      viewer = createViewer(props.args.fullPath, props.args.fileContent)\n      ctx.emit('update:kaState', viewer)\n    }\n    provide('viewer', viewer)\n\n    const canvasRef = ref<HTMLCanvasElement | null>(null)\n\n    const canvasScroll = ref<{ scrollTo(x: number | undefined, y: number | undefined): void } | null>(null)\n    onMounted(() => {\n      canvasScroll.value!.scrollTo(viewer.scrollPos.x, viewer.scrollPos.y)\n    })\n\n    const rowIndices = computed(() => {\n      if (viewer.rowSorting.value) {\n        return viewer.rowSorting.value\n      } else {\n        return Array.from(\n          { length: viewer.datFile.rowCount },\n          (_, rowIdx) => rowIdx)\n      }\n    })\n\n    const paintWidth = ref(0)\n    const paintHeight = ref(0)\n    function handleResize (sz: { width: number, height: number }) {\n      paintWidth.value = sz.width\n      paintHeight.value = sz.height\n    }\n    const { scrollPos } = viewer\n    function handleScroll (pos: { y: number, x: number }) {\n      scrollPos.x = pos.x\n      scrollPos.y = pos.y\n    }\n\n    const rowsFullWidth = computed(() =>\n      rendering.getRowWidth(viewer.headers.value))\n    const rowsFullHeight = computed(() =>\n      viewer.datFile.rowCount * rendering.LINE_HEIGHT)\n    const rowsOverlayWidth = computed(() =>\n      rendering.rowsOverlayWidth(viewer.datFile.rowCount))\n    const rowsWidth = computed(() =>\n      Math.max(0, paintWidth.value - rowsOverlayWidth.value))\n    const rowsHeight = computed(() =>\n      Math.max(0, paintHeight.value - rendering.HEADERS_HEIGHT))\n\n    watch([rowsWidth, rowsHeight], () => {\n      const dpr = window.devicePixelRatio\n\n      canvasRef.value!.style.width = rowsWidth.value + 'px'\n      canvasRef.value!.style.height = rowsHeight.value + 'px'\n\n      canvasRef.value!.width = rowsWidth.value * dpr\n      canvasRef.value!.height = rowsHeight.value * dpr\n\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n      ctx.scale(dpr, dpr)\n\n      draw()\n    })\n\n    const renderStats = computed(() =>\n      renderColStats(viewer.columnStats.value, viewer.datFile))\n\n    const renderColumns = computed(() =>\n      renderByteCols(\n        viewer.columnSelection.value,\n        renderStats.value,\n        viewer.headers.value,\n        scrollPos.x,\n        scrollPos.x + Math.min(rowsFullWidth.value, rowsWidth.value))\n    )\n\n    watch([scrollPos, renderColumns, rowIndices, viewer.selectedRow], () => { draw() })\n\n    function draw () {\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n\n      rendering.drawRows({\n        left: scrollPos.x,\n        paintWidth: rowsWidth.value,\n        top: renderItems.value.top,\n        rows: renderItems.value.ids,\n        columns: renderColumns.value,\n        viewer: viewer,\n        ctx\n      })\n    }\n\n    const renderItems = computed(() => {\n      const scrollTop = scrollPos.y\n\n      const count = Math.ceil(rowsHeight.value / rendering.LINE_HEIGHT) + 1\n      const startIdx = Math.floor(scrollTop / rendering.LINE_HEIGHT)\n\n      const top = (startIdx * rendering.LINE_HEIGHT) - scrollTop\n\n      return {\n        top,\n        ids: rowIndices.value.slice(startIdx, startIdx + count)\n      }\n    })\n\n    function focusEditingHeader () {\n      const header = viewer.editHeader.value!\n      const cols = renderHeaderCols(viewer.headers.value, null, 0, 0 + Infinity)\n      const target = cols.find(col => col.offset === header.offset)!\n      canvasScroll.value!.scrollTo(target.leftPx - rowsWidth.value * 0.33, undefined)\n    }\n\n    function handleCanvasClick (e: MouseEvent) {\n      const { selectedRow } = viewer\n      const sortedIdx = Math.floor((e.offsetY + scrollPos.y) / rendering.LINE_HEIGHT)\n      const realIdx = rowIndices.value[sortedIdx]\n      selectedRow.value = (selectedRow.value !== realIdx)\n        ? realIdx\n        : null\n    }\n\n    return {\n      headerBlockStyle: computed(() =>\n        ({ height: rendering.HEADERS_HEIGHT + 'px', width: paintWidth.value + 'px' })),\n      headerOverlayContentStyle: computed(() =>\n        ({ left: rowsOverlayWidth.value + 'px', height: rendering.HEADERS_HEIGHT + 'px', width: rowsWidth.value + 'px' })),\n      scrollableStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', left: rowsOverlayWidth.value + 'px' })),\n      scrollablePaintSize: computed(() =>\n        ({ width: rowsWidth.value, height: rowsHeight.value })),\n      scrollableFullSize: computed(() =>\n        ({ width: rowsFullWidth.value, height: rowsFullHeight.value })),\n      rowsOverlayStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', width: rowsOverlayWidth.value + 'px', height: rowsHeight.value + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px', lineHeight: rendering.LINE_HEIGHT + 'px' })),\n      handleScroll,\n      handleResize,\n      renderItems,\n      canvasRef,\n      renderColumns,\n      scrollLeft: computed(() => scrollPos.x),\n      rowsWidth: computed(() => Math.min(rowsFullWidth.value, rowsWidth.value)),\n      LINE_HEIGHT: rendering.LINE_HEIGHT,\n      canvasScroll,\n      rowsNumberWidth: (rendering.rowsNumWidth(viewer.datFile.rowCount) + 'px'),\n      focusEditingHeader,\n      handleCanvasClick\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"rowsOverlay\":\"DatViewer_rowsOverlay_10_gM\"};","import { render } from \"./DatViewer.vue?vue&type=template&id=a7ab6244\"\nimport script from \"./DatViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./DatViewer.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./DatViewer.vue?vue&type=style&index=0&id=a7ab6244&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","\nimport { defineComponent, shallowRef } from 'vue'\nimport { SchemaFile, SCHEMA_VERSION } from 'pathofexile-dat-schema'\nimport { fetchFile, progress } from '../patchcdn/cache'\nimport { loadIndex, loadFileContent, index } from '../patchcdn/index-store'\nimport { publicSchema } from '../dat-viewer/db'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\n\nexport default defineComponent({\n  setup () {\n    const poePatch = shallowRef(localStorage.getItem('POE_PATCH_VER') || '')\n    const isCdnImportRunning = shallowRef(false)\n    const isFetchingSchema = shallowRef(false)\n\n    if (poePatch.value && !index.value) {\n      cdnImport()\n    }\n    if (!publicSchema.value.length) {\n      fetchSchema()\n    }\n\n    async function handleFile (e: Event) {\n      const elFile = (e.target as HTMLInputElement).files![0]\n      const fileContent = new Uint8Array(await elFile.arrayBuffer())\n      const fileName = elFile.name\n      openTab({\n        id: `file@${fileName}`,\n        title: fileName,\n        type: DatViewer,\n        args: {\n          fileContent,\n          fullPath: fileName\n        }\n      })\n    }\n\n    async function cdnImport () {\n      let bundle\n      try {\n        isCdnImportRunning.value = true\n        bundle = await fetchFile(poePatch.value, '_.index.bin')\n      } finally {\n        isCdnImportRunning.value = false\n      }\n\n      try {\n        await loadIndex(bundle)\n        localStorage.setItem('POE_PATCH_VER', poePatch.value)\n      } catch (e) {\n        window.alert(e.message)\n        throw e\n      }\n    }\n\n    async function fetchSchema () {\n      isFetchingSchema.value = true\n      const response = await fetch('https://poe-bundles.snos.workers.dev/schema.min.json')\n      const schema: SchemaFile = await response.json()\n      if (schema.version === SCHEMA_VERSION) {\n        publicSchema.value = schema.tables\n      } else {\n        console.warn('Latest schema version is not supported.')\n      }\n      isFetchingSchema.value = false\n    }\n\n    return {\n      poePatch,\n      isCdnImportRunning,\n      isFetchingSchema,\n      handleFile,\n      cdnImport\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"input\":\"ImportDialog_input_1F68e\",\"label\":\"ImportDialog_label_3GNMX\"};","import { render } from \"./ImportDialog.vue?vue&type=template&id=1ea0ece0\"\nimport script from \"./ImportDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./ImportDialog.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./ImportDialog.vue?vue&type=style&index=0&id=1ea0ece0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","import { shallowRef, shallowReactive, DefineComponent, triggerRef } from 'vue'\nimport ImportDialog from './ImportDialog.vue'\n\ninterface Tab {\n  id: string\n  title: string\n  type: DefineComponent\n  args: unknown\n  kaState: unknown\n}\n\nexport const activeTabId = shallowRef<string | null>('poe-dat-viewer@import')\n\nexport function setActiveTab (id: string | null) {\n  activeTabId.value = id\n}\n\nexport const tabs = shallowRef<Tab[]>([\n  {\n    id: 'poe-dat-viewer@import',\n    title: 'Import',\n    type: ImportDialog as any, // eslint-disable-line @typescript-eslint/no-explicit-any\n    args: undefined,\n    kaState: undefined\n  }\n])\n\ninterface OpenTabParams {\n  id: string\n  title: string\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  type: any // vue.DefineComponent\n  args: unknown\n}\n\nexport function openTab (params: OpenTabParams) {\n  const existing = tabs.value.find(tab => tab.id === params.id)\n  if (!existing) {\n    tabs.value.push({\n      id: params.id,\n      title: params.title,\n      type: params.type,\n      args: params.args,\n      kaState: undefined\n    })\n  }\n  setActiveTab(params.id)\n  triggerRef(tabs)\n}\n\nexport function closeTab (id: string) {\n  const idx = tabs.value.findIndex(tab => tab.id === id)\n  if (id === activeTabId.value) {\n    if ((idx + 1) < tabs.value.length) {\n      setActiveTab(tabs.value[idx + 1].id)\n    } else if (idx !== 0) {\n      setActiveTab(tabs.value[idx - 1].id)\n    } else {\n      setActiveTab(null)\n    }\n  }\n  tabs.value = tabs.value.filter(tab => tab.id !== id)\n}\n","\nimport { defineComponent, computed } from 'vue'\nimport { tabs, activeTabId, setActiveTab, closeTab, openTab } from './workbench-core'\nimport ImportDialog from './ImportDialog.vue'\n\nexport default defineComponent({\n  setup () {\n    const _tabs = computed(() =>\n      tabs.value.map(tab => ({\n        id: tab.id,\n        title: tab.title,\n        isActive: (tab.id === activeTabId.value)\n      }))\n    )\n\n    function openImport () {\n      openTab({\n        id: 'poe-dat-viewer@import',\n        title: 'Import',\n        type: ImportDialog,\n        args: undefined\n      })\n    }\n\n    return {\n      tabs: _tabs,\n      setActiveTab,\n      closeTab,\n      openImport\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"titlebar\":\"Tabs_titlebar_3NzUh\",\"tab\":\"Tabs_tab_1nc-U\",\"active\":\"Tabs_active_1pZ1q\"};","import { render } from \"./Tabs.vue?vue&type=template&id=1809fd6d\"\nimport script from \"./Tabs.vue?vue&type=script&lang=ts\"\nexport * from \"./Tabs.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Tabs.vue?vue&type=style&index=0&id=1809fd6d&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div class=\"layout-column flex-shrink-0\" :style=\"{ 'width': showTree ? '300px' : undefined }\">\n    <div class=\"flex p-1 items-center mb-px\">\n      <button\n        title=\"Toggle tree visibility\"\n        :class=\"$style.treeToggle\"\n        @click=\"toggleTree\"\n        ><i class=\"codicon codicon-list-flat\"></i></button>\n      <input v-if=\"showTree\"\n        v-model.trim=\"searchText\"\n        placeholder=\"Search in current folder\"\n        :class=\"$style.searchInput\"\n        type=\"search\" spellcheck=\"false\">\n    </div>\n    <template v-if=\"showTree\">\n      <div v-if=\"extensionOpts\"\n        class=\"flex gap-x-1 border-b pb-1.5 px-2 justify-end\">\n        <button v-for=\"opt in extensionOpts\" :key=\"opt.value\"\n          @click=\"opt.handleClick\"\n          :class=\"['px-2', (opt.active ? 'bg-gray-200' : 'hover:bg-gray-100') ]\"\n          v-text=\"opt.value\" />\n      </div>\n      <div v-if=\"!isIndexLoaded\"\n        class=\"italic text-center text-gray-500 p-2\">Waiting for Index bundle...</div>\n      <div v-if=\"isIndexLoaded && !tree.length\"\n        class=\"italic text-center text-gray-500 p-2\">No results found</div>\n      <virtual-scroll\n        class=\"flex-1\"\n        :scrollable-props=\"{ style: 'background: #fff;', widthY: 10 }\"\n        :items=\"tree\"\n        :item-height=\"22\"\n      >\n        <template v-slot=\"props\">\n          <button v-for=\"entry in props.entries\" :key=\"entry.item.fullPath\"\n            :class=\"{ [$style.itemBtn]: true, [$style.active]: entry.item.isActive }\"\n            :style=\"{ transform: `translate(0, ${entry.top}px` }\"\n            @click=\"handleTreeNav(entry.item)\"\n          >\n            <i v-if=\"!entry.item.isFile\" class=\"codicon codicon-folder pr-3\"></i\n            >{{ entry.item.label }}</button>\n        </template>\n      </virtual-scroll>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, shallowRef, computed, watch } from 'vue'\nimport FileSaver from 'file-saver'\nimport VirtualScroll from '@/VirtualScroll.vue'\nimport { getRootDirs, getDirContent } from 'pathofexile-dat/bundles/index-paths'\nimport { index, loadFileContent } from '../patchcdn/index-store'\nimport { openTab, activeTabId } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\nimport * as perf from '../../perf'\n\ninterface TreeItem {\n  label: string\n  fullPath: string\n  isFile: boolean\n  isActive?: boolean\n}\n\nfunction useTreeNavigation () {\n  const currentDir = shallowRef('')\n\n  watch(index, () => {\n    currentDir.value = ''\n  })\n\n  const tree = computed<TreeItem[]>(() => {\n    if (!index.value) return []\n\n    if (currentDir.value === '') {\n      const dirs = perf.fn('Getting root dirs', () =>\n        getRootDirs(index.value!.pathReps, index.value!.dirsInfo))\n\n      return dirs.map(dirName => ({\n        label: dirName,\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    }\n\n    const content = perf.fn(`Getting \"${currentDir.value}\" dir`, () =>\n      getDirContent(currentDir.value, index.value!.pathReps, index.value!.dirsInfo))\n\n    return [\n      {\n        label: '../',\n        fullPath: (currentDir.value.indexOf('/') === -1)\n          ? ''\n          : currentDir.value.split('/').slice(0, -1).join('/'),\n        isFile: false\n      },\n      ...content.dirs.map(dirName => ({\n        label: dirName.substr(currentDir.value.length + 1),\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label)),\n      ...content.files.map(fileName => ({\n        label: fileName.substr(currentDir.value.length + 1),\n        fullPath: fileName,\n        isFile: true,\n        isActive: (`bundles@${fileName}` === activeTabId.value)\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    ]\n  })\n\n  async function handleTreeNav (item: TreeItem) {\n    if (!item.isFile) {\n      currentDir.value = item.fullPath\n    } else {\n      const fileContent = await loadFileContent(item.fullPath)\n\n      if (item.fullPath.endsWith('.dat') || item.fullPath.endsWith('.dat64')) {\n        openTab({\n          id: `bundles@${item.fullPath}`,\n          title: item.label,\n          type: DatViewer,\n          args: {\n            fileContent,\n            fullPath: item.fullPath\n          }\n        })\n      } else {\n        FileSaver.saveAs(new File(\n          [fileContent],\n          item.fullPath.substring(item.fullPath.lastIndexOf('/') + 1),\n          { type: 'application/octet-stream' }\n        ))\n      }\n    }\n  }\n\n  return {\n    currentDir,\n    tree,\n    handleTreeNav\n  }\n}\n\nexport default defineComponent({\n  components: { VirtualScroll },\n  setup () {\n    const showTree = shallowRef(true)\n    function toggleTree () {\n      showTree.value = !showTree.value\n    }\n\n    const isIndexLoaded = computed(() => {\n      return Boolean(index.value)\n    })\n\n    const { tree, handleTreeNav, currentDir } = useTreeNavigation()\n\n    const searchExtension = shallowRef('.dat64')\n    const extensionOpts = computed(() => {\n      if (!currentDir.value.startsWith('Data')) return null\n\n      return ['.dat', '.dat64', '.datl', '.datl64'].map(ext => ({\n        value: ext,\n        active: searchExtension.value === ext,\n        handleClick: () => { searchExtension.value = ext }\n      }))\n    })\n\n    const searchText = shallowRef('')\n    const filteredTree = computed(() => {\n      const term = searchText.value.toLowerCase()\n      const ext = extensionOpts.value ? searchExtension.value : ''\n      return tree.value.filter(item => {\n        return item.label.toLowerCase().includes(term) &&\n          (item.isFile ? item.label.endsWith(ext) : true)\n      })\n    })\n\n    return {\n      showTree,\n      toggleTree,\n      tree: filteredTree,\n      handleTreeNav,\n      searchText,\n      isIndexLoaded,\n      extensionOpts\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.treeToggle {\n  @apply p-1;\n  @apply m-1;\n  line-height: 1;\n\n  &:hover {\n    @apply bg-gray-100;\n  }\n}\n\n.searchInput {\n  @apply h-7;\n  @apply border;\n  box-sizing: content-box;\n  @apply flex-1;\n  @apply mx-1;\n  @apply px-1 py-px;\n\n  &:focus {\n    @apply border-blue-500;\n  }\n}\n\n.itemBtn {\n  position: absolute;\n  line-height: 22px;\n  @apply px-3;\n  text-align: left;\n  @apply truncate;\n  width: 100%;\n\n  &:hover {\n    @apply bg-gray-100;\n  }\n\n  &.active {\n    @apply bg-blue-600;\n    @apply text-white;\n  }\n}\n</style>\n","<template>\n  <resize-observer @resize=\"handleResize\" class=\"relative\">\n    <canvas-scroll ref=\"scrollable\"\n      v-bind=\"scrollableProps\"\n      class=\"absolute\"\n      :paint-size=\"paintSize\"\n      :full-size=\"fullSize\"\n    >\n      <slot :entries=\"renderItems\" />\n    </canvas-scroll>\n  </resize-observer>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, shallowReactive, ref } from 'vue'\nimport ResizeObserver from './ResizeObserver.vue'\nimport CanvasScroll from './CanvasScroll.vue'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll },\n  props: {\n    items: {\n      type: Array,\n      required: true\n    },\n    itemHeight: {\n      type: Number,\n      required: true\n    },\n    scrollableProps: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  setup (props) {\n    const paintSize = shallowReactive({\n      width: 0,\n      height: 0\n    })\n\n    const fullSize = computed(() => ({\n      width: paintSize.width,\n      height: props.items.length * props.itemHeight\n    }))\n\n    function handleResize (sz: { width: number, height: number }) {\n      paintSize.width = sz.width\n      paintSize.height = sz.height\n    }\n\n    const scrollable = ref<{ scrollPos: { y: number } } | null>(null)\n\n    const renderItems = computed(() => {\n      const scrollTop = (scrollable.value?.scrollPos.y ?? 0)\n\n      const count = Math.ceil(paintSize.height / props.itemHeight) + 1\n      const startIdx = Math.floor(scrollTop / props.itemHeight)\n\n      const top = (startIdx * props.itemHeight) - scrollTop\n\n      return props.items\n        .slice(startIdx, startIdx + count)\n        .map((item, i) =>\n          ({\n            top: top + (i * props.itemHeight),\n            item\n          })\n        )\n    })\n\n    return {\n      handleResize,\n      paintSize,\n      fullSize,\n      scrollable,\n      renderItems\n    }\n  }\n})\n</script>\n","\nimport { defineComponent, computed, shallowReactive, ref } from 'vue'\nimport ResizeObserver from './ResizeObserver.vue'\nimport CanvasScroll from './CanvasScroll.vue'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll },\n  props: {\n    items: {\n      type: Array,\n      required: true\n    },\n    itemHeight: {\n      type: Number,\n      required: true\n    },\n    scrollableProps: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  setup (props) {\n    const paintSize = shallowReactive({\n      width: 0,\n      height: 0\n    })\n\n    const fullSize = computed(() => ({\n      width: paintSize.width,\n      height: props.items.length * props.itemHeight\n    }))\n\n    function handleResize (sz: { width: number, height: number }) {\n      paintSize.width = sz.width\n      paintSize.height = sz.height\n    }\n\n    const scrollable = ref<{ scrollPos: { y: number } } | null>(null)\n\n    const renderItems = computed(() => {\n      const scrollTop = (scrollable.value?.scrollPos.y ?? 0)\n\n      const count = Math.ceil(paintSize.height / props.itemHeight) + 1\n      const startIdx = Math.floor(scrollTop / props.itemHeight)\n\n      const top = (startIdx * props.itemHeight) - scrollTop\n\n      return props.items\n        .slice(startIdx, startIdx + count)\n        .map((item, i) =>\n          ({\n            top: top + (i * props.itemHeight),\n            item\n          })\n        )\n    })\n\n    return {\n      handleResize,\n      paintSize,\n      fullSize,\n      scrollable,\n      renderItems\n    }\n  }\n})\n","import { render } from \"./VirtualScroll.vue?vue&type=template&id=315fb3d7\"\nimport script from \"./VirtualScroll.vue?vue&type=script&lang=ts\"\nexport * from \"./VirtualScroll.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nexport function start () {\n  return Date.now()\n}\n\nexport function end (desc: string, start: number) {\n  const end = Date.now() - start\n  console.log(`${desc}. Done in -> ${end} ms`)\n}\n\nexport function fn<T> (desc: string, cb: () => T): T {\n  const t$ = start()\n  const res = cb()\n  end(desc, t$)\n  return res\n}\n","\nimport { defineComponent, shallowRef, computed, watch } from 'vue'\nimport FileSaver from 'file-saver'\nimport VirtualScroll from '@/VirtualScroll.vue'\nimport { getRootDirs, getDirContent } from 'pathofexile-dat/bundles/index-paths'\nimport { index, loadFileContent } from '../patchcdn/index-store'\nimport { openTab, activeTabId } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\nimport * as perf from '../../perf'\n\ninterface TreeItem {\n  label: string\n  fullPath: string\n  isFile: boolean\n  isActive?: boolean\n}\n\nfunction useTreeNavigation () {\n  const currentDir = shallowRef('')\n\n  watch(index, () => {\n    currentDir.value = ''\n  })\n\n  const tree = computed<TreeItem[]>(() => {\n    if (!index.value) return []\n\n    if (currentDir.value === '') {\n      const dirs = perf.fn('Getting root dirs', () =>\n        getRootDirs(index.value!.pathReps, index.value!.dirsInfo))\n\n      return dirs.map(dirName => ({\n        label: dirName,\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    }\n\n    const content = perf.fn(`Getting \"${currentDir.value}\" dir`, () =>\n      getDirContent(currentDir.value, index.value!.pathReps, index.value!.dirsInfo))\n\n    return [\n      {\n        label: '../',\n        fullPath: (currentDir.value.indexOf('/') === -1)\n          ? ''\n          : currentDir.value.split('/').slice(0, -1).join('/'),\n        isFile: false\n      },\n      ...content.dirs.map(dirName => ({\n        label: dirName.substr(currentDir.value.length + 1),\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label)),\n      ...content.files.map(fileName => ({\n        label: fileName.substr(currentDir.value.length + 1),\n        fullPath: fileName,\n        isFile: true,\n        isActive: (`bundles@${fileName}` === activeTabId.value)\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    ]\n  })\n\n  async function handleTreeNav (item: TreeItem) {\n    if (!item.isFile) {\n      currentDir.value = item.fullPath\n    } else {\n      const fileContent = await loadFileContent(item.fullPath)\n\n      if (item.fullPath.endsWith('.dat') || item.fullPath.endsWith('.dat64')) {\n        openTab({\n          id: `bundles@${item.fullPath}`,\n          title: item.label,\n          type: DatViewer,\n          args: {\n            fileContent,\n            fullPath: item.fullPath\n          }\n        })\n      } else {\n        FileSaver.saveAs(new File(\n          [fileContent],\n          item.fullPath.substring(item.fullPath.lastIndexOf('/') + 1),\n          { type: 'application/octet-stream' }\n        ))\n      }\n    }\n  }\n\n  return {\n    currentDir,\n    tree,\n    handleTreeNav\n  }\n}\n\nexport default defineComponent({\n  components: { VirtualScroll },\n  setup () {\n    const showTree = shallowRef(true)\n    function toggleTree () {\n      showTree.value = !showTree.value\n    }\n\n    const isIndexLoaded = computed(() => {\n      return Boolean(index.value)\n    })\n\n    const { tree, handleTreeNav, currentDir } = useTreeNavigation()\n\n    const searchExtension = shallowRef('.dat64')\n    const extensionOpts = computed(() => {\n      if (!currentDir.value.startsWith('Data')) return null\n\n      return ['.dat', '.dat64', '.datl', '.datl64'].map(ext => ({\n        value: ext,\n        active: searchExtension.value === ext,\n        handleClick: () => { searchExtension.value = ext }\n      }))\n    })\n\n    const searchText = shallowRef('')\n    const filteredTree = computed(() => {\n      const term = searchText.value.toLowerCase()\n      const ext = extensionOpts.value ? searchExtension.value : ''\n      return tree.value.filter(item => {\n        return item.label.toLowerCase().includes(term) &&\n          (item.isFile ? item.label.endsWith(ext) : true)\n      })\n    })\n\n    return {\n      showTree,\n      toggleTree,\n      tree: filteredTree,\n      handleTreeNav,\n      searchText,\n      isIndexLoaded,\n      extensionOpts\n    }\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"treeToggle\":\"IndexTree_treeToggle_1Disw\",\"searchInput\":\"IndexTree_searchInput_1f5gZ\",\"itemBtn\":\"IndexTree_itemBtn_3xH8n\",\"active\":\"IndexTree_active_1ajD8\"};","import { render } from \"./IndexTree.vue?vue&type=template&id=86821028\"\nimport script from \"./IndexTree.vue?vue&type=script&lang=ts\"\nexport * from \"./IndexTree.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./IndexTree.vue?vue&type=style&index=0&id=86821028&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div v-if=\"active\" :class=\"$style.notification\">\n    <template v-if=\"totalSize\">\n      <div class=\"bg-gray-200 h-1\"></div>\n      <div class=\"bg-blue-500 h-1 absolute top-0\"\n        :style=\"{ width: `${received/totalSize * 100}%` }\"></div>\n    </template>\n    <div class=\"p-3\">\n      <div class=\"font-semibold truncate\">{{ bundleName }}</div>\n      <div class=\"text-grey text-sm\">\n        <template v-if=\"totalSize\">{{ (totalSize / 1000000).toFixed(1) }} MB</template>\n        <template v-else>Downloading...</template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { progress } from '../patchcdn/cache'\n\nexport default defineComponent({\n  setup () {\n    return progress\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.notification {\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  width: 20rem;\n  @apply bg-gray-50;\n  @apply m-6;\n  @apply shadow;\n  @apply border;\n  @apply text-base;\n}\n</style>\n","\nimport { defineComponent } from 'vue'\nimport { progress } from '../patchcdn/cache'\n\nexport default defineComponent({\n  setup () {\n    return progress\n  }\n})\n","// extracted by mini-css-extract-plugin\nexport default {\"notification\":\"DownloadProgress_notification_1LAA4\"};","import { render } from \"./DownloadProgress.vue?vue&type=template&id=8a6b4a52\"\nimport script from \"./DownloadProgress.vue?vue&type=script&lang=ts\"\nexport * from \"./DownloadProgress.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./DownloadProgress.vue?vue&type=style&index=0&id=8a6b4a52&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","\nimport { defineComponent, computed } from 'vue'\nimport ViewerTabs from './Tabs.vue'\nimport IndexTree from './IndexTree.vue'\nimport DownloadProgress from './DownloadProgress.vue'\nimport { tabs, activeTabId } from './workbench-core'\n\nexport default defineComponent({\n  components: { IndexTree, ViewerTabs, DownloadProgress },\n  setup () {\n    const activeTab = computed(() =>\n      tabs.value.find(tab => tab.id === activeTabId.value)\n    )\n\n    return {\n      activeTab,\n      appVersion: process.env.APP_VERSION\n    }\n  }\n})\n","import { render } from \"./Workbench.vue?vue&type=template&id=0838a844\"\nimport script from \"./Workbench.vue?vue&type=script&lang=ts\"\nexport * from \"./Workbench.vue?vue&type=script&lang=ts\"\n\nimport \"./Workbench.vue?vue&type=style&index=0&id=0838a844&lang=postcss\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue'\nimport Workbench from './app/workbench/Workbench.vue'\n\ncreateApp(Workbench).mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tresult = fn();\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/poe-dat-viewer/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tfor(moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) var result = runtime(__webpack_require__);\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkIds[i]] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkpoe_dat_viewer\"] = self[\"webpackChunkpoe_dat_viewer\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(743); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"sourceRoot":""}