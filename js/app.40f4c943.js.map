{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/CanvasScroll.vue?cb1b","webpack:///./src/app/workbench/ImportDialog.vue?4bbe","webpack:///./src/app/workbench/ImportDialog.vue?d9cf","webpack:///./src/app/workbench/DownloadProgress.vue?bbfa","webpack:///./src/assets/discord-badge.svg","webpack:///./src/app/workbench/Workbench.vue?7c9c","webpack:///./src/app/dat-viewer/components/Actions.vue?6f14","webpack:///./src/app/workbench/Tabs.vue?18a0","webpack:///./src/CanvasScroll.vue?1f52","webpack:///./src/app/workbench/IndexTree.vue?5383","webpack:///./src/app/dat-viewer/components/Actions.vue?4299","webpack:///./src/app/dat-viewer/components/ViewerHead.vue?9bf6","webpack:///./src/app/workbench/IndexTree.vue?0285","webpack:///./src/app/workbench/Tabs.vue?8dea","webpack:///./src/app/workbench/Workbench.vue","webpack:///./src/app/workbench/Tabs.vue","webpack:///./src/app/workbench/ImportDialog.vue","webpack:///./src/app/patchcdn/cache.ts","webpack:///./src/app/worker/script.ts","webpack:///./src/app/worker/interface.ts","webpack:///./src/app/patchcdn/index-store.ts","webpack:///./src/app/dat-viewer/components/DatViewer.vue","webpack:///./src/ResizeObserver.vue","webpack:///./src/ResizeObserver.vue?2943","webpack:///./src/ResizeObserver.vue?09a0","webpack:///./src/CanvasScroll.vue","webpack:///./src/CanvasScroll.vue?f0fe","webpack:///./src/CanvasScroll.vue?07ce","webpack:///./src/app/dat-viewer/selection.ts","webpack:///./src/app/dat-viewer/headers.ts","webpack:///./src/assets/schema.ts","webpack:///./src/app/dat-viewer/db.ts","webpack:///./src/app/dat-viewer/Viewer.ts","webpack:///./src/app/dat-viewer/components/Actions.vue","webpack:///./src/app/dat-viewer/components/Actions.vue?671c","webpack:///./src/app/dat-viewer/components/Actions.vue?08f4","webpack:///./src/app/dat-viewer/components/ViewerHead.vue","webpack:///./src/app/dat-viewer/sorting.ts","webpack:///./src/app/dat-viewer/rendering/content.ts","webpack:///./src/app/dat-viewer/rendering.ts","webpack:///./src/app/dat-viewer/rendering/header-columns.ts","webpack:///./src/app/dat-viewer/components/ViewerHead.vue?17b0","webpack:///./src/app/dat-viewer/components/ViewerHead.vue?bddf","webpack:///./src/app/dat-viewer/components/HeaderProps.vue","webpack:///./src/app/dat-viewer/components/HeaderProps.vue?b5bd","webpack:///./src/app/dat-viewer/components/HeaderProps.vue?b072","webpack:///./src/app/dat-viewer/rendering/byte-columns.ts","webpack:///./src/app/dat-viewer/components/DatViewer.vue?ab25","webpack:///./src/app/dat-viewer/components/DatViewer.vue?8b2f","webpack:///./src/app/workbench/ImportDialog.vue?a392","webpack:///./src/app/workbench/ImportDialog.vue?224a","webpack:///./src/app/workbench/workbench-core.ts","webpack:///./src/app/workbench/Tabs.vue?e93e","webpack:///./src/app/workbench/Tabs.vue?37e7","webpack:///./src/app/workbench/IndexTree.vue","webpack:///./src/VirtualScroll.vue","webpack:///./src/VirtualScroll.vue?c3e9","webpack:///./src/VirtualScroll.vue?d610","webpack:///./src/perf.ts","webpack:///./src/app/workbench/IndexTree.vue?7ab0","webpack:///./src/app/workbench/IndexTree.vue?945e","webpack:///./src/app/workbench/DownloadProgress.vue","webpack:///./src/app/workbench/DownloadProgress.vue?2727","webpack:///./src/app/workbench/DownloadProgress.vue?b4cf","webpack:///./src/app/workbench/Workbench.vue?8885","webpack:///./src/app/workbench/Workbench.vue?056c","webpack:///./src/main.ts","webpack:///./src/app/dat-viewer/components/DatViewer.vue?495f","webpack:///./src/app/workbench/DownloadProgress.vue?6bb5","webpack:///./src/app/dat-viewer/components/DatViewer.vue?d922"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","href","src","activeTab","type","args","id","ka-state","kaState","appVersion","title","$style","titlebar","tabs","tab","active","isActive","setActiveTab","closeTab","openImport","style","for","readonly","input","label","poePatch","placeholder","cdnImport","disabled","isCdnImportRunning","loading","accept","handleFile","BUNDLE_DIR","progress","totalSize","received","bundleName","async","fetchFile","patchVer","localStorage","getItem","Error","_fetchFile","e","alert","path","cache","caches","open","res","match","fetch","status","statusText","buf","Number","headers","reader","body","getReader","chunks","done","read","Uint8Array","bufPos","chunk","set","delete","put","Response","String","byteLength","buffer","arrayBuffer","Worker","thread","decompressBundle","bundle","byteOffset","decompressSliceInBundle","bundleSlice","decompressFileTransferBundle","offset","size","analyzeDatFile","datFile","index","loadFileContent","fullPath","location","bundlesInfo","filesInfo","bundleBin","loadIndex","indexBin","indexBundle","_index","dirsInfo","pathReps","pathRepsBundle","ref","handleResize","headerBlockStyle","headerOverlayContentStyle","left","scrollLeft","width","rowsWidth","columns","renderColumns","handleScroll","scrollableStyle","paint-size","scrollablePaintSize","full-size","scrollableFullSize","canvasShadow","rowsOverlay","rowsOverlayStyle","renderItems","top","ids","rowIdx","LINE_HEIGHT","rowsNumberWidth","position","tag","data-role","props","default","emits","ctx","rootEl","resizeObserver","ResizeObserver","entries","emit","contentRect","height","observe","unobserve","render","scrollable","paintSize","handleMousedown","handleMousewheel","track","y","handleTrackMousedownY","scrollbarY","fixedSize","trackSize","thumb","x","handleTrackMousedownX","scrollbarX","MIN_THUMB_SIZE","SCROLL_DIR_THRESHOLD","WHEEL_SCROLL_SPEED","SCROLL_ACCELERATION_FN","dt","Math","max","pow","sign","scrollbar","scrollSize","otherScrollbar","scrollPos","thumbSize","floor","thumbRatio","thumbPos","round","useMouseMiddleButtonScroll","scrollByDelta","startY","startX","deltaY","deltaX","direction","rafTime","rafId","button","preventDefault","stopPropagation","document","cursor","clientY","clientX","requestAnimationFrame","scrollEachFrame","addEventListener","handleMouseMove","cancelScroll","cancelAnimationFrame","removeEventListener","removeProperty","dy","dx","abs","time","dtTime","useMouseWheelScroll","useScrollbarScroll","axis","scrollTo","start","rectProp","mEventProp","handleTrackMousedown","trackEl","currentTarget","getBoundingClientRect","target","thumbEl","undefined","required","fullSize","widthY","widthX","min","deep","cssModules","__cssModules","selectColsByHeader","header","selection","toggleColsBetween","a","b","end","filter","hdr","byteView","array","some","clearColumnSelection","fill","getColumnSelections","ranges","last","idx","indexOf","curr","removeHeadersAtOffsets","offsets","removeHeader","createHeaderFromSelected","selections","selected","emptyHeader","find","updatedHeaders","textLength","merged","mergeEmptyHeaders","h1","h2","schema","db","createObjectStore","keyPath","findByName","record","fromJsonSchema","saveHeaders","serializeHeaders","map","string","boolean","decimal","integer","sch","enum","column","unsigned","foreign","references","table","createViewer","fileContent","parsed","viewer","rowLength","getNamePart","columnStats","columnSelection","Array","editHeader","rowSorting","then","stats","tryImportHeaders","message","serialized","hdrSerialized","headerLength","isValid","headerCreated","assign","exportAllRows","data_","every","row","entry","unknown","rid","unshift","rowCount","_","fromEntries","col","bar","defineColumn","range","exportDataJson","join","saveAs","File","JSON","stringify","headersRowStyle","border","widthPx","transform","leftPx","handleHeaderWheel","$event","colsRowStyle","selectStart","selectContinue","text","statsRowStyle","stat","sortRows","order","rows","from","sort","ai","bi","localeCompare","numberToString","out","color","numberArrayToString","booleanToString","booleanArrayToString","stringToString","stringArrayToString","str","keySelfToString","keySelfArrayToString","keyForeignToString","keyForeignArrayToString","renderCellContent","draw","textY","prevColor","fillStyle","fillText","drawByteView","begin","dataFixed","subarray","hexDump","byte","toString","padStart","CHAR_WIDTH","drawArrayVarData","refArray","entryMaxLength","keyForeign","fieldSize","KEY_FOREIGN","keySelf","KEY","STRING","longLong","LONGLONG","long","LONG","short","SHORT","maxReadBytes","ceil","arrayLength","readerFixed","getSizeT","varOffset","memsize","dataVariable","FONT_FAMILY","FONT_SIZE","getMonoFontWidth","XBASE_HEIGHT","getFontBaseLine","ROWNUM_MIN_LENGTH","BORDER_WIDTH","COLUMN_STAT_HEIGHT","COLUMN_BYTE_HEIGHT","HEADERS_HEIGHT","rowNumLength","maxLen","rowsNumWidth","fontSize","fontFamily","canvasEl","createElement","context","getContext","font","metrics","measureText","textBaseline","xBase","alphabeticBaseline","actualBoundingBoxDescent","getBaseLine","lineHeight","drawRows","params","fillRect","canvas","save","translate","drawColumns","restore","renderers","getColumnRenderers","paintWidth","beginPath","rect","clip","exec","paintBegin","paintEnd","sizes","columnSizes","borderWidth","paddingWidth","hexBegin","hexEnd","hasBorder","getRowWidth","renderHeaderCols","sortOrder","selectionStart","colsBeforeSelection","cancelSelection","buttons","len","h","ctrlKey","close","spellcheck","viewModeOpts","opt","byteViewMode","remove","dataTypeOpts","dataType","arrayTypeOpts","arrayType","opts","ARRAY","refString","bMax","headerRef","watchStop","isVisible","BYTE_WIDTH","renderByteCols","textLeft","thisWidth","renderColStats","nullable","zero","k","nullableMemsize","components","CanvasScroll","ViewerActions","ViewerHead","HeaderProps","canvasRef","canvasScroll","rowIndices","paintHeight","sz","pos","rowsFullWidth","rowsFullHeight","rowsOverlayWidth","rowsHeight","dpr","devicePixelRatio","alpha","scale","renderStats","scrollTop","count","startIdx","elFile","files","fileName","openTab","DatViewer","setItem","activeTabId","ImportDialog","existing","findIndex","_tabs","showTree","treeToggle","toggleTree","searchText","searchInput","extensionOpts","handleClick","isIndexLoaded","tree","scrollable-props","items","item-height","item","itemBtn","handleTreeNav","isFile","scrollableProps","itemHeight","Date","now","desc","console","log","fn","cb","t$","useTreeNavigation","currentDir","dirs","dirName","content","split","substr","endsWith","substring","lastIndexOf","VirtualScroll","Boolean","searchExtension","startsWith","ext","filteredTree","term","toLowerCase","includes","notification","toFixed","IndexTree","ViewerTabs","DownloadProgress","Workbench","mount"],"mappings":"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","file":"js/app.40f4c943.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/poe-dat-viewer/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scrollable\":\"CanvasScroll_scrollable_KuF3M\",\"track\":\"CanvasScroll_track_35adi\",\"y\":\"CanvasScroll_y_3fkOa\",\"x\":\"CanvasScroll_x_1YqgW\",\"thumb\":\"CanvasScroll_thumb_3n3go\"};","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ImportDialog.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ImportDialog.vue?vue&type=style&index=0&lang=postcss&module=true\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"ImportDialog_input_BOtpT\",\"label\":\"ImportDialog_label_2ZOy1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification\":\"DownloadProgress_notification_1cAoN\"};","module.exports = __webpack_public_path__ + \"img/discord-badge.b9bc316a.svg\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Workbench.vue?vue&type=style&index=0&lang=postcss\"","export { default } from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Actions.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Actions.vue?vue&type=style&index=0&lang=postcss&module=true\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titlebar\":\"Tabs_titlebar_6nlgm\",\"tab\":\"Tabs_tab_36pp7\",\"active\":\"Tabs_active_1qu2U\"};","export { default } from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CanvasScroll.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CanvasScroll.vue?vue&type=style&index=0&lang=postcss&module=true\"","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./IndexTree.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./IndexTree.vue?vue&type=style&index=0&lang=postcss&module=true\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bar\":\"Actions_bar_3gEfG\"};","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ViewerHead.vue?vue&type=style&index=0&lang=postcss\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"treeToggle\":\"IndexTree_treeToggle_3Gb6L\",\"searchInput\":\"IndexTree_searchInput_nlhBz\",\"itemBtn\":\"IndexTree_itemBtn_1tEbV\"};","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Tabs.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Tabs.vue?vue&type=style&index=0&lang=postcss&module=true\"","<template>\n  <index-tree />\n  <div class=\"layout-column flex-1 min-w-0\">\n    <viewer-tabs />\n    <div class=\"layout-column flex-1 min-h-0\">\n      <component\n        v-if=\"activeTab\"\n        :is=\"activeTab.type\"\n        :args=\"activeTab.args\"\n        :key=\"activeTab.id\"\n        v-model:ka-state=\"activeTab.kaState\" />\n      <div v-else\n        class=\"bg-gray-100 flex-1 text-lg text-gray-600 flex items-center justify-center\"\n        >The viewer is ready to fulfill your wishes 👾</div>\n    </div>\n    <div class=\"app-footer\">\n      <div>Made by Alexander Drozdov, v{{ appVersion }} <a class=\"q-link text-white border-b\" href=\"https://github.com/SnosMe/poe-dat-viewer\">GitHub</a></div>\n      <a href=\"https://discord.gg/SJjBdT3\" class=\"flex ml-8\"><img src=\"@/assets/discord-badge.svg\" /></a>\n    </div>\n  </div>\n  <download-progress />\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport ViewerTabs from './Tabs.vue'\nimport IndexTree from './IndexTree.vue'\nimport DownloadProgress from './DownloadProgress.vue'\nimport { tabs, activeTabId } from './workbench-core'\n\nexport default defineComponent({\n  components: { IndexTree, ViewerTabs, DownloadProgress },\n  setup () {\n    const activeTab = computed(() =>\n      tabs.value.find(tab => tab.id === activeTabId.value)\n    )\n\n    return {\n      activeTab,\n      appVersion: process.env.APP_VERSION\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\">\n@tailwind base;\n@tailwind utilities;\n@import \"~vscode-codicons/dist/codicon.css\";\n\n* {\n  outline: none !important;\n}\n\n.codicon {\n  vertical-align: text-bottom;\n}\n\n#app {\n  display: flex;\n  height: 100vh;\n  width: 100vw;\n  overflow: hidden;\n  font-size: 13px;\n  line-height: 1.5;\n}\n\n.layout-column {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n.app-footer {\n  line-height: 1;\n  align-items: center;\n  display: flex;\n  @apply bg-gray-800;\n  @apply text-white;\n  @apply p-2;\n\n  img {\n    filter: grayscale(0.75);\n  }\n\n  &:hover {\n    img {\n      filter: grayscale(0);\n    }\n  }\n}\n</style>\n","<template>\n  <div :class=\"$style.titlebar\">\n    <div class=\"flex overflow-hidden divide-x divide-gray-700\">\n      <div v-for=\"tab in tabs\" :key=\"tab.id\"\n        :class=\"[$style.tab, { [$style.active]: tab.isActive }]\">\n        <button class=\"pl-3 pr-1.5\"\n          @click=\"setActiveTab(tab.id)\">{{ tab.title }}</button>\n        <button class=\"pl-1.5 pr-3\" title=\"Close\"\n          @click=\"closeTab(tab.id)\"><i class=\"codicon codicon-close\"></i></button>\n      </div>\n    </div>\n    <div class=\"flex p-1.5 flex-shrink-0 space-x-1\">\n      <button class=\"hover:bg-gray-400 hover:text-black p-2\"\n        @click=\"openImport\">Import</button>\n      <button class=\"hover:bg-gray-400 hover:text-black px-2\" title=\"Help\"><i class=\"codicon codicon-question\"></i></button>\n      <button class=\"hover:bg-gray-400 hover:text-black px-2\" title=\"Settings\"><i class=\"codicon codicon-settings\"></i></button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed } from 'vue'\nimport { tabs, activeTabId, setActiveTab, closeTab, openTab } from './workbench-core'\nimport ImportDialog from './ImportDialog.vue'\n\nexport default defineComponent({\n  setup () {\n    const _tabs = computed(() =>\n      tabs.value.map(tab => ({\n        id: tab.id,\n        title: tab.title,\n        isActive: (tab.id === activeTabId.value)\n      }))\n    )\n\n    function openImport () {\n      openTab({\n        id: 'poe-dat-viewer@import',\n        title: 'Import',\n        type: ImportDialog,\n        args: undefined\n      })\n    }\n\n    return {\n      tabs: _tabs,\n      setActiveTab,\n      closeTab,\n      openImport\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.titlebar {\n  display: flex;\n  justify-content: space-between;\n  @apply bg-gray-800;\n  @apply text-gray-100;\n  z-index: 1;\n  line-height: 1;\n}\n\n.tab {\n  display: flex;\n\n  &:hover {\n    @apply bg-gray-400;\n    @apply text-black;\n  }\n\n  &.active {\n    @apply bg-gray-900;\n\n    &:hover {\n      @apply bg-gray-700;\n      @apply text-white;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"p-4 overflow-auto border-l flex-1 text-base\">\n    <div class=\"inline-flex items-baseline border-b pb-2\">\n      <div style=\"width: 200px;\" class=\"my-1\">\n        <input value=\"patchcdn.pathofexile.com/\" readonly :class=\"$style.input\" />\n        <label :class=\"$style.label\">Patch CDN</label>\n      </div>\n      <div style=\"width: 100px;\" class=\"m-1\">\n        <input v-model.trim=\"poePatch\" placeholder=\"3.12.x.x.x\" :class=\"$style.input\" />\n        <label :class=\"$style.label\">Patch #</label>\n      </div>\n      <div style=\"width: 220px;\" class=\"my-1\">\n        <input value=\"/Bundles2/_.index.bin\" readonly :class=\"$style.input\" />\n        <label :class=\"$style.label\">Index</label>\n      </div>\n      <button class=\"ml-1 py-1 px-3 bg-blue-600 text-white hover:bg-blue-800\"\n        @click=\"cdnImport\"\n        :disabled=\"isCdnImportRunning\"\n        :loading=\"isCdnImportRunning\">{{ isCdnImportRunning ? 'Wait...' : 'Import' }}</button>\n    </div>\n    <div class=\"flex items-baseline mt-3\">\n      <label\n        class=\"bg-gray-200 py-1 px-2 cursor-pointer hover:bg-gray-400\"\n        style=\"width: 250px\"\n        for=\"import-local-file\">Pick local file</label>\n      <input\n        class=\"hidden\"\n        id=\"import-local-file\"\n        type=\"file\"\n        accept=\".dat,.dat64\"\n        @input=\"handleFile\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref } from 'vue'\nimport { fetchFile, progress } from '../patchcdn/cache'\nimport { loadIndex, loadFileContent, index } from '../patchcdn/index-store'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\n\nexport default defineComponent({\n  setup () {\n    const poePatch = ref(localStorage.getItem('POE_PATCH_VER') || '')\n    const isCdnImportRunning = ref(false)\n\n    if (poePatch.value && !index.value) {\n      cdnImport()\n    }\n\n    async function handleFile (e: Event) {\n      const elFile = (e.target as HTMLInputElement).files![0]\n      const fileContent = new Uint8Array(await elFile.arrayBuffer())\n      const fileName = elFile.name\n      openTab({\n        id: `file@${fileName}`,\n        title: fileName,\n        type: DatViewer,\n        args: {\n          fileContent,\n          fullPath: fileName\n        }\n      })\n    }\n\n    async function cdnImport () {\n      let bundle\n      try {\n        isCdnImportRunning.value = true\n        bundle = await fetchFile(poePatch.value, '_.index.bin')\n      } finally {\n        isCdnImportRunning.value = false\n      }\n\n      try {\n        await loadIndex(bundle)\n        localStorage.setItem('POE_PATCH_VER', poePatch.value)\n      } catch (e) {\n        window.alert(e.message)\n        throw e\n      }\n    }\n\n    return {\n      poePatch,\n      isCdnImportRunning,\n      handleFile,\n      cdnImport\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.input {\n  width: 100%;\n  @apply py-1 px-2;\n\n  &:not([readonly]) {\n    @apply border;\n\n    &:focus {\n      @apply border-blue-500;\n    }\n  }\n\n  &[readonly] {\n    @apply border-b;\n    @apply bg-gray-200;\n  }\n}\n\n.label {\n  @apply text-xs;\n  @apply px-2;\n  @apply text-gray-600;\n}\n</style>\n","import { reactive } from 'vue'\n\nconst BUNDLE_DIR = 'Bundles2'\n\nexport const progress = reactive({\n  totalSize: 0,\n  received: 0,\n  active: false,\n  bundleName: ''\n})\n\nexport async function fetchFile (patchVer: string | null, name: string) {\n  if (patchVer == null) {\n    patchVer = localStorage.getItem('POE_PATCH_VER')\n    if (!patchVer) throw new Error('never')\n  }\n\n  try {\n    return await _fetchFile(patchVer, name)\n  } catch (e) {\n    window.alert('You may need to adjust the patch version.')\n    throw e\n  }\n}\n\nexport async function _fetchFile (patchVer: string, name: string): Promise<ArrayBuffer> {\n  const path = `${patchVer}/${BUNDLE_DIR}/${name}`\n  let cache = await caches.open('bundles')\n  let res = await cache.match(path)\n  if (!res) {\n    progress.totalSize = 0\n    progress.received = 0\n    progress.active = true\n    progress.bundleName = name\n\n    res = await fetch(`https://poe-bundles.snos.workers.dev/${path}`)\n    if (res.status !== 200) {\n      progress.active = false\n      throw new Error(`patchcdn: ${res.status} ${res.statusText}`)\n    }\n    progress.totalSize = Number(res.headers.get('content-length'))\n\n    let buf: Uint8Array\n    try {\n      const reader = res.body!.getReader()\n      const chunks = [] as Uint8Array[]\n      while (true) {\n        const { done, value } = await reader.read()\n        if (done) break\n        chunks.push(value!)\n        progress.received += value!.length\n      }\n\n      buf = new Uint8Array(progress.received)\n      let bufPos = 0\n      for (const chunk of chunks) {\n        buf.set(chunk, bufPos)\n        bufPos += chunk.length\n      }\n    } finally {\n      progress.active = false\n    }\n\n    if (localStorage.getItem('POE_PATCH_VER') !== patchVer) {\n      await caches.delete('bundles')\n      cache = await caches.open('bundles')\n    }\n\n    await cache.put(path, new Response(buf, {\n      headers: {\n        'content-length': String(buf.byteLength),\n        'content-type': 'application/octet-stream'\n      }\n    }))\n    return buf.buffer\n  }\n  return res.arrayBuffer()\n}\n","export default function() {\n  return new Worker(__webpack_public_path__ + \"js/script.f92bc98d.worker.js\");\n}\n","/* eslint-disable import/no-webpack-loader-syntax */\nimport Worker from 'worker-loader!./script'\nimport * as Comlink from 'comlink'\nimport type { WorkerRPC } from './script'\nimport type { DatFile } from 'pathofexile-dat'\n\nconst thread = Comlink.wrap<WorkerRPC>(new Worker())\n\nexport function decompressBundle (bundle: Uint8Array) {\n  if (bundle.byteOffset === 0 && bundle.byteLength === bundle.buffer.byteLength) {\n    return thread.decompressSliceInBundle(bundle)\n  } else {\n    const bundleSlice = new Uint8Array(\n      bundle.buffer.slice(bundle.byteOffset, bundle.byteOffset + bundle.byteLength)\n    )\n    return thread.decompressSliceInBundle(Comlink.transfer(bundle, [bundleSlice.buffer]))\n  }\n}\n\nexport function decompressFileTransferBundle (bundle: ArrayBuffer, offset: number, size: number) {\n  return thread.decompressSliceInBundle(\n    Comlink.transfer(new Uint8Array(bundle), [bundle]),\n    offset,\n    size\n  )\n}\n\nexport function analyzeDatFile (datFile: DatFile) {\n  return thread.analyzeDatFile(datFile)\n}\n","import { decompressBundle, decompressFileTransferBundle } from '../worker/interface'\nimport { readIndexBundle, getFileInfo } from 'pathofexile-dat/bundles/index-bundle'\nimport { fetchFile } from './cache'\nimport { shallowRef } from 'vue'\n\nexport const index = shallowRef(null as {\n  bundlesInfo: Uint8Array\n  filesInfo: Uint8Array\n  dirsInfo: Uint8Array\n  pathReps: Uint8Array\n} | null)\n\nexport async function loadFileContent (fullPath: string) {\n  const location = getFileInfo(fullPath, index.value!.bundlesInfo, index.value!.filesInfo)\n  const bundleBin = await fetchFile(null, location.bundle)\n\n  return decompressFileTransferBundle(bundleBin, location.offset, location.size)\n}\n\nexport async function loadIndex (indexBin: ArrayBuffer) {\n  const indexBundle = await decompressBundle(new Uint8Array(indexBin))\n  const _index = readIndexBundle(indexBundle)\n  index.value = {\n    bundlesInfo: _index.bundlesInfo,\n    filesInfo: _index.filesInfo,\n    dirsInfo: _index.dirsInfo,\n    pathReps: await decompressBundle(_index.pathRepsBundle)\n  }\n}\n","<template>\n  <viewer-actions />\n  <div class=\"flex flex-1\">\n    <resize-observer @resize=\"handleResize\" class=\"flex-1 min-h-0 relative\">\n      <div class=\"bg-gray-200 absolute\" :style=\"headerBlockStyle\">\n        <viewer-head :style=\"headerOverlayContentStyle\"\n          :left=\"scrollLeft\"\n          :width=\"rowsWidth\"\n          :columns=\"renderColumns\"\n        />\n      </div>\n      <canvas-scroll\n        ref=\"canvasScroll\"\n        class=\"absolute bg-white\"\n        @scroll=\"handleScroll\"\n        :style=\"scrollableStyle\"\n        :paint-size=\"scrollablePaintSize\"\n        :full-size=\"scrollableFullSize\">\n        <canvas ref=\"canvasRef\" />\n        <div :class=\"$style.canvasShadow\" />\n      </canvas-scroll>\n      <div :class=\"$style.rowsOverlay\" :style=\"rowsOverlayStyle\">\n        <div class=\"absolute\" :style=\"{ transform: `translate(0, ${renderItems.top}px)` }\">\n          <div v-for=\"(rowIdx, i) in renderItems.ids\" :key=\"rowIdx\"\n            :style=\"{ transform: `translate(0, ${i * LINE_HEIGHT}px)`, width: rowsNumberWidth, position: 'absolute' }\"\n            v-text=\"rowIdx\" />\n        </div>\n      </div>\n    </resize-observer>\n    <header-props />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType, reactive, computed, provide, watch, shallowRef, shallowReactive, ref, render, onMounted } from 'vue'\nimport ResizeObserver from '@/ResizeObserver.vue'\nimport CanvasScroll from '@/CanvasScroll.vue'\nimport { Viewer, createViewer } from '../Viewer'\nimport ViewerActions from './Actions.vue'\nimport ViewerHead from './ViewerHead.vue'\nimport HeaderProps from './HeaderProps.vue'\nimport * as rendering from '../rendering'\nimport { renderByteCols, renderColStats } from '../rendering/byte-columns'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll, ViewerActions, ViewerHead, HeaderProps },\n  emits: ['update:kaState'],\n  props: {\n    args: {\n      type: Object as PropType<{\n        fileContent: Uint8Array\n        fullPath: string\n      }>,\n      required: true\n    },\n    kaState: {\n      type: Object as PropType<Viewer | undefined>,\n      default: undefined\n    }\n  },\n  setup (props, ctx) {\n    let viewer: Viewer\n    if (props.kaState) {\n      viewer = props.kaState // eslint-disable-line vue/no-setup-props-destructure\n    } else {\n      viewer = createViewer(props.args.fullPath, props.args.fileContent)\n      ctx.emit('update:kaState', viewer)\n    }\n    provide('viewer', viewer)\n\n    const canvasRef = ref<HTMLCanvasElement | null>(null)\n\n    const canvasScroll = ref<{ scrollTo(x: number, y: number): void } | null>(null)\n    onMounted(() => {\n      canvasScroll.value!.scrollTo(viewer.scrollPos.x, viewer.scrollPos.y)\n    })\n\n    const rowIndices = computed(() => {\n      if (viewer.rowSorting.value) {\n        return viewer.rowSorting.value\n      } else {\n        return Array.from(\n          { length: viewer.datFile.rowCount },\n          (_, rowIdx) => rowIdx)\n      }\n    })\n\n    const paintWidth = ref(0)\n    const paintHeight = ref(0)\n    function handleResize (sz: { width: number, height: number }) {\n      paintWidth.value = sz.width\n      paintHeight.value = sz.height\n    }\n    const { scrollPos } = viewer\n    function handleScroll (pos: { y: number, x: number }) {\n      scrollPos.x = pos.x\n      scrollPos.y = pos.y\n    }\n\n    const rowsFullWidth = computed(() =>\n      rendering.getRowWidth(viewer.headers.value))\n    const rowsFullHeight = computed(() =>\n      viewer.datFile.rowCount * rendering.LINE_HEIGHT)\n    const rowsOverlayWidth = computed(() =>\n      rendering.rowsOverlayWidth(viewer.datFile.rowCount))\n    const rowsWidth = computed(() =>\n      Math.max(0, paintWidth.value - rowsOverlayWidth.value))\n    const rowsHeight = computed(() =>\n      Math.max(0, paintHeight.value - rendering.HEADERS_HEIGHT))\n\n    watch([rowsWidth, rowsHeight], () => {\n      const dpr = devicePixelRatio\n\n      canvasRef.value!.style.width = rowsWidth.value + 'px'\n      canvasRef.value!.style.height = rowsHeight.value + 'px'\n\n      canvasRef.value!.width = rowsWidth.value * dpr\n      canvasRef.value!.height = rowsHeight.value * dpr\n\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n      ctx.scale(dpr, dpr)\n\n      draw()\n    })\n\n    const renderStats = computed(() =>\n      renderColStats(viewer.columnStats.value, viewer.datFile))\n\n    const renderColumns = computed(() =>\n      renderByteCols(\n        viewer.columnSelection.value,\n        renderStats.value,\n        viewer.headers.value,\n        scrollPos.x,\n        scrollPos.x + Math.min(rowsFullWidth.value, rowsWidth.value))\n    )\n\n    watch([scrollPos, renderColumns, rowIndices], () => { draw() })\n\n    function draw () {\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n\n      rendering.drawRows({\n        left: scrollPos.x,\n        paintWidth: rowsWidth.value,\n        top: renderItems.value.top,\n        rows: renderItems.value.ids,\n        columns: renderColumns.value,\n        viewer: viewer,\n        ctx\n      })\n    }\n\n    const renderItems = computed(() => {\n      const scrollTop = scrollPos.y\n\n      const count = Math.ceil(rowsHeight.value / rendering.LINE_HEIGHT) + 1\n      const startIdx = Math.floor(scrollTop / rendering.LINE_HEIGHT)\n\n      const top = (startIdx * rendering.LINE_HEIGHT) - scrollTop\n\n      return {\n        top,\n        ids: rowIndices.value.slice(startIdx, startIdx + count)\n      }\n    })\n\n    return {\n      headerBlockStyle: computed(() =>\n        ({ height: rendering.HEADERS_HEIGHT + 'px', width: paintWidth.value + 'px' })),\n      headerOverlayContentStyle: computed(() =>\n        ({ left: rowsOverlayWidth.value + 'px', height: rendering.HEADERS_HEIGHT + 'px', width: rowsWidth.value + 'px' })),\n      scrollableStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', left: rowsOverlayWidth.value + 'px' })),\n      scrollablePaintSize: computed(() =>\n        ({ width: rowsWidth.value, height: rowsHeight.value })),\n      scrollableFullSize: computed(() =>\n        ({ width: rowsFullWidth.value, height: rowsFullHeight.value })),\n      rowsOverlayStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', width: rowsOverlayWidth.value + 'px', height: rowsHeight.value + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px', lineHeight: rendering.LINE_HEIGHT + 'px' })),\n      handleScroll,\n      handleResize,\n      renderItems,\n      canvasRef,\n      renderColumns,\n      scrollLeft: computed(() => scrollPos.x),\n      rowsWidth: computed(() => Math.min(rowsFullWidth.value, rowsWidth.value)),\n      LINE_HEIGHT: rendering.LINE_HEIGHT,\n      canvasScroll,\n      rowsNumberWidth: (rendering.rowsNumWidth(viewer.datFile.rowCount) + 'px')\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.rowsOverlay {\n  position: absolute;\n  overflow: hidden;\n  transform: translate3d(0, 0, 0);\n  contain: strict;\n  @apply bg-white;\n  padding-left: 7px;\n  @apply border-l border-gray-200;\n  padding-right: 8px;\n  text-align: right;\n  box-shadow: #cacaca 0 6px 6px -6px inset;\n  user-select: none;\n}\n\n.canvasShadow {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  box-shadow:\n    #dddddd  6px  0    6px  -6px inset,\n    #cacaca  0    6px  6px  -6px inset;\n    /* #cacaca -6px  0    6px  -6px inset; */\n}\n</style>\n","<template>\n  <component :is=\"tag\" ref=\"rootEl\" data-role=\"resize-observer\">\n    <slot />\n  </component>\n</template>\n\n<script lang=\"ts\">\n/// <reference types=\"resize-observer-browser\" />\n\nimport { defineComponent, ref, onMounted, onBeforeUnmount } from 'vue'\n\nexport default defineComponent({\n  props: {\n    tag: {\n      type: String,\n      default: 'div'\n    }\n  },\n  emits: ['resize'],\n  setup (props, ctx) {\n    const rootEl = ref<HTMLElement | null>(null)\n\n    onMounted(() => {\n      const resizeObserver = new ResizeObserver(entries => {\n        ctx.emit('resize', {\n          width: entries[0].contentRect.width,\n          height: entries[0].contentRect.height\n        })\n      })\n\n      resizeObserver.observe(rootEl.value!)\n      onBeforeUnmount(() => {\n        resizeObserver.unobserve(rootEl.value!)\n      })\n    })\n\n    return { rootEl }\n  }\n})\n</script>\n","\n/// <reference types=\"resize-observer-browser\" />\n\nimport { defineComponent, ref, onMounted, onBeforeUnmount } from 'vue'\n\nexport default defineComponent({\n  props: {\n    tag: {\n      type: String,\n      default: 'div'\n    }\n  },\n  emits: ['resize'],\n  setup (props, ctx) {\n    const rootEl = ref<HTMLElement | null>(null)\n\n    onMounted(() => {\n      const resizeObserver = new ResizeObserver(entries => {\n        ctx.emit('resize', {\n          width: entries[0].contentRect.width,\n          height: entries[0].contentRect.height\n        })\n      })\n\n      resizeObserver.observe(rootEl.value!)\n      onBeforeUnmount(() => {\n        resizeObserver.unobserve(rootEl.value!)\n      })\n    })\n\n    return { rootEl }\n  }\n})\n","import { render } from \"./ResizeObserver.vue?vue&type=template&id=7624aec8&bindings={}\"\nimport script from \"./ResizeObserver.vue?vue&type=script&lang=ts\"\nexport * from \"./ResizeObserver.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","<template>\n  <div :class=\"$style.scrollable\"\n    :style=\"{ width: paintSize.width + 'px', height: paintSize.height + 'px' }\"\n    @mousedown=\"handleMousedown\"\n    @wheel=\"handleMousewheel\"\n  >\n    <slot />\n    <div v-if=\"scrollbarY\" :class=\"`${$style.track} ${$style.y}`\" @mousedown=\"handleTrackMousedownY\"\n      :style=\"{ width: scrollbarY.fixedSize + 'px', height: scrollbarY.trackSize + 'px' }\">\n      <div :class=\"$style.thumb\" :style=\"{\n        transform: `translate(0, ${scrollbarY.thumbPos}px)`,\n        width: scrollbarY.fixedSize + 'px', height: scrollbarY.thumbSize + 'px' }\" />\n    </div>\n    <div v-if=\"scrollbarX\" :class=\"`${$style.track} ${$style.x}`\" @mousedown=\"handleTrackMousedownX\"\n      :style=\"{ width: scrollbarX.trackSize + 'px', height: scrollbarX.fixedSize + 'px' }\">\n      <div :class=\"$style.thumb\" :style=\"{\n        transform: `translate(${scrollbarX.thumbPos}px, 0)`,\n        width: scrollbarX.thumbSize + 'px', height: scrollbarX.fixedSize + 'px' }\" />\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, shallowReactive, computed, Ref, PropType, readonly, watch } from 'vue'\n\nconst MIN_THUMB_SIZE = 40\nconst SCROLL_DIR_THRESHOLD = 15\nconst WHEEL_SCROLL_SPEED = 100\nconst SCROLL_ACCELERATION_FN = (value: number, dt: number) =>\n  Math.max(1, Math.pow(value * (3 / 1000) * dt, 2)) * Math.sign(value)\n\ntype Scrollbar = {\n  fixedSize: number\n  trackSize: number\n  thumbSize: number\n  thumbRatio: number\n  thumbPos: number\n} | null\n\nfunction scrollbar (\n  fixedSize: number,\n  paintSize: number,\n  scrollSize: number,\n  otherScrollbar: Scrollbar,\n  scrollPos: number\n): Scrollbar {\n  if (scrollSize <= paintSize) return null\n\n  const trackSize = Math.max(0, paintSize - (otherScrollbar?.fixedSize ?? 0))\n  const thumbSize = Math.max(MIN_THUMB_SIZE, Math.floor(paintSize * trackSize / scrollSize))\n\n  const thumbRatio = (trackSize - thumbSize) / (scrollSize - paintSize)\n  const thumbPos = Math.round(scrollPos * thumbRatio)\n\n  return {\n    trackSize,\n    thumbSize,\n    fixedSize,\n    thumbRatio,\n    thumbPos\n  }\n}\n\nfunction useMouseMiddleButtonScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  let startY = 0\n  let startX = 0\n  let deltaY = 0\n  let deltaX = 0\n  let direction = null as 'vertical' | 'horizontal' | null\n\n  let rafTime = 0\n  let rafId = 0\n\n  function handleMousedown (e: MouseEvent) {\n    if (e.button !== 1) return\n\n    e.preventDefault()\n    e.stopPropagation()\n    document.body.style.cursor = 'all-scroll'\n\n    direction = null\n    startY = e.clientY\n    startX = e.clientX\n    deltaY = 0\n    deltaX = 0\n\n    rafTime = 0\n    rafId = requestAnimationFrame(scrollEachFrame)\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function cancelScroll () {\n    cancelAnimationFrame(rafId)\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n\n    document.body.style.removeProperty('cursor')\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const dy = (e.clientY - startY)\n    const dx = (e.clientX - startX)\n\n    if (direction === null) {\n      if (Math.abs(dy) > SCROLL_DIR_THRESHOLD) {\n        direction = 'vertical'\n        document.body.style.cursor = 'ns-resize'\n      } else if (Math.abs(dx) > SCROLL_DIR_THRESHOLD) {\n        direction = 'horizontal'\n        document.body.style.cursor = 'ew-resize'\n      } else {\n        return\n      }\n    }\n\n    if (direction === 'vertical') {\n      deltaY = dy\n    } else {\n      deltaX = dx\n    }\n  }\n\n  function scrollEachFrame (time: number) {\n    const dtTime = time - (rafTime || time)\n    rafTime = time\n    rafId = requestAnimationFrame(scrollEachFrame)\n\n    scrollByDelta(\n      SCROLL_ACCELERATION_FN(deltaX, dtTime),\n      SCROLL_ACCELERATION_FN(deltaY, dtTime)\n    )\n  }\n\n  return { handleMousedown }\n}\n\nfunction useMouseWheelScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  function handleMousewheel (e: WheelEvent) {\n    scrollByDelta(0, Math.sign(e.deltaY) * WHEEL_SCROLL_SPEED)\n  }\n\n  return { handleMousewheel }\n}\n\nfunction useScrollbarScroll (\n  scrollbar: Ref<Scrollbar>,\n  axis: 'x' | 'y',\n  scrollTo: (x: number | undefined, y: number | undefined) => void\n) {\n  let start = 0\n  let offset = 0\n\n  const rectProp = (axis === 'y' ? 'y' : 'x')\n  const mEventProp = (axis === 'y' ? 'clientY' : 'clientX')\n\n  function handleTrackMousedown (e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n\n    const trackEl = e.currentTarget as HTMLElement\n    start = trackEl.getBoundingClientRect()[rectProp]\n\n    if (e.target !== trackEl) {\n      const thumbEl = e.target as HTMLElement\n      offset = e[mEventProp] - thumbEl.getBoundingClientRect()[rectProp]\n    } else {\n      offset = (scrollbar.value!.thumbSize / 2)\n      handleMouseMove(e)\n      offset = (e[mEventProp] - start - scrollbar.value!.thumbPos)\n    }\n\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const value = (e[mEventProp] - start - offset) / scrollbar.value!.thumbRatio\n    if (axis === 'x') {\n      scrollTo(value, undefined)\n    } else {\n      scrollTo(undefined, value)\n    }\n  }\n\n  function cancelScroll () {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n  }\n\n  return { handleTrackMousedown }\n}\n\nexport default defineComponent({\n  props: {\n    paintSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    fullSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    widthY: {\n      type: Number,\n      default: 14\n    },\n    widthX: {\n      type: Number,\n      default: 12\n    }\n  },\n  emits: ['scroll'],\n  setup (props, ctx) {\n    const scrollPos = shallowReactive({ y: 0, x: 0 })\n\n    watch(() => [props.paintSize, props.fullSize], () => {\n      const { paintSize, fullSize } = props\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x, fullSize.width - paintSize.width))\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y, fullSize.height - paintSize.height))\n    }, { deep: true })\n\n    watch(scrollPos, () => {\n      ctx.emit('scroll', {\n        y: scrollPos.y,\n        x: scrollPos.x\n      })\n    })\n\n    const scrollbarY = computed(() =>\n      scrollbar(props.widthY, props.paintSize.height, props.fullSize.height, null, scrollPos.y))\n    const scrollbarX = computed(() =>\n      scrollbar(props.widthX, props.paintSize.width, props.fullSize.width, scrollbarY.value, scrollPos.x))\n\n    function scrollByDelta (dx: number, dy: number) {\n      const { paintSize, fullSize } = props\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y + Math.floor(dy), fullSize.height - paintSize.height))\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x + Math.floor(dx), fullSize.width - paintSize.width))\n    }\n\n    function scrollTo (x: number | undefined, y: number | undefined) {\n      const { paintSize, fullSize } = props\n      if (x !== undefined) {\n        scrollPos.x = Math.max(0, Math.min(Math.floor(x), fullSize.width - paintSize.width))\n      }\n      if (y !== undefined) {\n        scrollPos.y = Math.max(0, Math.min(Math.floor(y), fullSize.height - paintSize.height))\n      }\n    }\n\n    return {\n      scrollbarY,\n      scrollbarX,\n      scrollPos: readonly(scrollPos),\n      scrollTo,\n      scrollByDelta,\n      handleMousedown: useMouseMiddleButtonScroll(scrollByDelta).handleMousedown,\n      handleMousewheel: useMouseWheelScroll(scrollByDelta).handleMousewheel,\n      handleTrackMousedownY: useScrollbarScroll(scrollbarY, 'y', scrollTo).handleTrackMousedown,\n      handleTrackMousedownX: useScrollbarScroll(scrollbarX, 'x', scrollTo).handleTrackMousedown\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.scrollable {\n  overflow: hidden;\n  position: relative;\n  transform: translate3d(0, 0, 0);\n}\n\n.track {\n  position: absolute;\n  contain: strict;\n  &.y { top: 0; right: 0; }\n  &.x { bottom: 0; left: 0; }\n}\n\n.thumb {\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.3);\n  will-change: transform;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.4);\n  }\n}\n</style>\n","\nimport { defineComponent, shallowReactive, computed, Ref, PropType, readonly, watch } from 'vue'\n\nconst MIN_THUMB_SIZE = 40\nconst SCROLL_DIR_THRESHOLD = 15\nconst WHEEL_SCROLL_SPEED = 100\nconst SCROLL_ACCELERATION_FN = (value: number, dt: number) =>\n  Math.max(1, Math.pow(value * (3 / 1000) * dt, 2)) * Math.sign(value)\n\ntype Scrollbar = {\n  fixedSize: number\n  trackSize: number\n  thumbSize: number\n  thumbRatio: number\n  thumbPos: number\n} | null\n\nfunction scrollbar (\n  fixedSize: number,\n  paintSize: number,\n  scrollSize: number,\n  otherScrollbar: Scrollbar,\n  scrollPos: number\n): Scrollbar {\n  if (scrollSize <= paintSize) return null\n\n  const trackSize = Math.max(0, paintSize - (otherScrollbar?.fixedSize ?? 0))\n  const thumbSize = Math.max(MIN_THUMB_SIZE, Math.floor(paintSize * trackSize / scrollSize))\n\n  const thumbRatio = (trackSize - thumbSize) / (scrollSize - paintSize)\n  const thumbPos = Math.round(scrollPos * thumbRatio)\n\n  return {\n    trackSize,\n    thumbSize,\n    fixedSize,\n    thumbRatio,\n    thumbPos\n  }\n}\n\nfunction useMouseMiddleButtonScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  let startY = 0\n  let startX = 0\n  let deltaY = 0\n  let deltaX = 0\n  let direction = null as 'vertical' | 'horizontal' | null\n\n  let rafTime = 0\n  let rafId = 0\n\n  function handleMousedown (e: MouseEvent) {\n    if (e.button !== 1) return\n\n    e.preventDefault()\n    e.stopPropagation()\n    document.body.style.cursor = 'all-scroll'\n\n    direction = null\n    startY = e.clientY\n    startX = e.clientX\n    deltaY = 0\n    deltaX = 0\n\n    rafTime = 0\n    rafId = requestAnimationFrame(scrollEachFrame)\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function cancelScroll () {\n    cancelAnimationFrame(rafId)\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n\n    document.body.style.removeProperty('cursor')\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const dy = (e.clientY - startY)\n    const dx = (e.clientX - startX)\n\n    if (direction === null) {\n      if (Math.abs(dy) > SCROLL_DIR_THRESHOLD) {\n        direction = 'vertical'\n        document.body.style.cursor = 'ns-resize'\n      } else if (Math.abs(dx) > SCROLL_DIR_THRESHOLD) {\n        direction = 'horizontal'\n        document.body.style.cursor = 'ew-resize'\n      } else {\n        return\n      }\n    }\n\n    if (direction === 'vertical') {\n      deltaY = dy\n    } else {\n      deltaX = dx\n    }\n  }\n\n  function scrollEachFrame (time: number) {\n    const dtTime = time - (rafTime || time)\n    rafTime = time\n    rafId = requestAnimationFrame(scrollEachFrame)\n\n    scrollByDelta(\n      SCROLL_ACCELERATION_FN(deltaX, dtTime),\n      SCROLL_ACCELERATION_FN(deltaY, dtTime)\n    )\n  }\n\n  return { handleMousedown }\n}\n\nfunction useMouseWheelScroll (scrollByDelta: (dx: number, dy: number) => void) {\n  function handleMousewheel (e: WheelEvent) {\n    scrollByDelta(0, Math.sign(e.deltaY) * WHEEL_SCROLL_SPEED)\n  }\n\n  return { handleMousewheel }\n}\n\nfunction useScrollbarScroll (\n  scrollbar: Ref<Scrollbar>,\n  axis: 'x' | 'y',\n  scrollTo: (x: number | undefined, y: number | undefined) => void\n) {\n  let start = 0\n  let offset = 0\n\n  const rectProp = (axis === 'y' ? 'y' : 'x')\n  const mEventProp = (axis === 'y' ? 'clientY' : 'clientX')\n\n  function handleTrackMousedown (e: MouseEvent) {\n    e.preventDefault()\n    e.stopPropagation()\n\n    const trackEl = e.currentTarget as HTMLElement\n    start = trackEl.getBoundingClientRect()[rectProp]\n\n    if (e.target !== trackEl) {\n      const thumbEl = e.target as HTMLElement\n      offset = e[mEventProp] - thumbEl.getBoundingClientRect()[rectProp]\n    } else {\n      offset = (scrollbar.value!.thumbSize / 2)\n      handleMouseMove(e)\n      offset = (e[mEventProp] - start - scrollbar.value!.thumbPos)\n    }\n\n    document.addEventListener('mousemove', handleMouseMove)\n    document.addEventListener('mouseup', cancelScroll)\n    document.addEventListener('mouseleave', cancelScroll)\n  }\n\n  function handleMouseMove (e: MouseEvent) {\n    const value = (e[mEventProp] - start - offset) / scrollbar.value!.thumbRatio\n    if (axis === 'x') {\n      scrollTo(value, undefined)\n    } else {\n      scrollTo(undefined, value)\n    }\n  }\n\n  function cancelScroll () {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', cancelScroll)\n    document.removeEventListener('mouseleave', cancelScroll)\n  }\n\n  return { handleTrackMousedown }\n}\n\nexport default defineComponent({\n  props: {\n    paintSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    fullSize: {\n      type: Object as PropType<{ width: number, height: number }>,\n      required: true\n    },\n    widthY: {\n      type: Number,\n      default: 14\n    },\n    widthX: {\n      type: Number,\n      default: 12\n    }\n  },\n  emits: ['scroll'],\n  setup (props, ctx) {\n    const scrollPos = shallowReactive({ y: 0, x: 0 })\n\n    watch(() => [props.paintSize, props.fullSize], () => {\n      const { paintSize, fullSize } = props\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x, fullSize.width - paintSize.width))\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y, fullSize.height - paintSize.height))\n    }, { deep: true })\n\n    watch(scrollPos, () => {\n      ctx.emit('scroll', {\n        y: scrollPos.y,\n        x: scrollPos.x\n      })\n    })\n\n    const scrollbarY = computed(() =>\n      scrollbar(props.widthY, props.paintSize.height, props.fullSize.height, null, scrollPos.y))\n    const scrollbarX = computed(() =>\n      scrollbar(props.widthX, props.paintSize.width, props.fullSize.width, scrollbarY.value, scrollPos.x))\n\n    function scrollByDelta (dx: number, dy: number) {\n      const { paintSize, fullSize } = props\n      scrollPos.y = Math.max(0, Math.min(scrollPos.y + Math.floor(dy), fullSize.height - paintSize.height))\n      scrollPos.x = Math.max(0, Math.min(scrollPos.x + Math.floor(dx), fullSize.width - paintSize.width))\n    }\n\n    function scrollTo (x: number | undefined, y: number | undefined) {\n      const { paintSize, fullSize } = props\n      if (x !== undefined) {\n        scrollPos.x = Math.max(0, Math.min(Math.floor(x), fullSize.width - paintSize.width))\n      }\n      if (y !== undefined) {\n        scrollPos.y = Math.max(0, Math.min(Math.floor(y), fullSize.height - paintSize.height))\n      }\n    }\n\n    return {\n      scrollbarY,\n      scrollbarX,\n      scrollPos: readonly(scrollPos),\n      scrollTo,\n      scrollByDelta,\n      handleMousedown: useMouseMiddleButtonScroll(scrollByDelta).handleMousedown,\n      handleMousewheel: useMouseWheelScroll(scrollByDelta).handleMousewheel,\n      handleTrackMousedownY: useScrollbarScroll(scrollbarY, 'y', scrollTo).handleTrackMousedown,\n      handleTrackMousedownX: useScrollbarScroll(scrollbarX, 'x', scrollTo).handleTrackMousedown\n    }\n  }\n})\n","import { render } from \"./CanvasScroll.vue?vue&type=template&id=1c788ded&bindings={}\"\nimport script from \"./CanvasScroll.vue?vue&type=script&lang=ts\"\nexport * from \"./CanvasScroll.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./CanvasScroll.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","import type { Header } from './headers'\n\nexport function selectColsByHeader (header: Header, selection: boolean[]) {\n  for (let offset = header.offset; offset < (header.offset + header.length); ++offset) {\n    selection[offset] = true\n  }\n}\n\nexport function toggleColsBetween (selection: boolean[], a: number, b: number, headers: readonly Header[]) {\n  const start = Math.min(a, b)\n  const end = Math.max(a, b)\n\n  headers = headers.filter(hdr => (hdr.type.byteView && !hdr.type.byteView.array))\n\n  for (let offset = start; offset <= end; ++offset) {\n    if (headers.some(hdr =>\n      offset >= hdr.offset && offset < (hdr.offset + hdr.length)\n    )) {\n      selection[offset] = !selection[offset]\n    }\n  }\n}\n\nexport function clearColumnSelection (selection: boolean[]) {\n  selection.fill(false)\n}\n\nexport function getColumnSelections (selection: readonly boolean[]) {\n  const ranges: number[][] = []\n\n  let idx = selection.indexOf(true)\n  let last: number\n  if (idx < 0) {\n    return ranges\n  } else {\n    last = idx\n    ranges.push([last])\n  }\n\n  for (idx += 1; idx < selection.length; ++idx) {\n    if (selection[idx]) {\n      const curr = idx\n      if ((curr - last) === 1) {\n        ranges[ranges.length - 1].push(curr)\n      } else {\n        ranges.push([curr])\n      }\n      last = curr\n    }\n  }\n\n  return ranges\n}\n","import { getColumnSelections } from './selection'\n\nexport interface Header {\n  name: string | null\n  readonly offset: number\n  readonly length: number\n  type: {\n    byteView?: { array: boolean }\n    array?: boolean\n    boolean?: {}\n    integer?: { unsigned: boolean, size: number }\n    decimal?: { size: number }\n    string?: {}\n    key?: { foreign: boolean }\n  }\n  textLength?: number\n}\n\nexport const byteView = (): Header['type'] => ({ byteView: { array: false } })\n\nfunction removeHeadersAtOffsets (offsets: number[], headers: Header[]) {\n  for (let idx = 0; idx < headers.length;) {\n    const header = headers[idx]\n    if (\n      header.name != null && offsets.some(offset =>\n        offset >= header.offset &&\n        offset < header.offset + header.length\n      )) {\n      removeHeader(header, headers)\n    } else {\n      idx += 1\n    }\n  }\n}\n\nexport function createHeaderFromSelected (selection: boolean[], headers: Header[]) {\n  const selections = getColumnSelections(selection)\n  if (selections.length === 0) {\n    throw new Error('No bytes selected')\n  } else if (selections.length > 1) {\n    throw new Error('Cannot create header from non-contiguous selection')\n  }\n  const selected = selections[0]\n\n  removeHeadersAtOffsets(selected, headers)\n\n  const emptyHeader = headers.find(header =>\n    selected[0] >= header.offset &&\n    selected[0] + selected.length <= header.offset + header.length\n  )!\n\n  let updatedHeaders: Header[] = [\n    {\n      name: null,\n      offset: emptyHeader.offset,\n      length: selected[0] - emptyHeader.offset,\n      type: byteView()\n    }, {\n      name: '',\n      offset: selected[0],\n      length: selected.length,\n      type: byteView(),\n      textLength: 4 * 3 - 1\n    }, {\n      name: null,\n      offset: selected[0] + selected.length,\n      length: emptyHeader.length - (selected[0] - emptyHeader.offset + selected.length),\n      type: byteView()\n    }\n  ]\n  const header = updatedHeaders[1]\n\n  updatedHeaders = updatedHeaders.filter(header => header.length)\n  headers.splice(headers.indexOf(emptyHeader), 1, ...updatedHeaders)\n\n  return header\n}\n\nexport function removeHeader (header: Header, headers: Header[]) {\n  if (header.name == null) {\n    throw new Error('Cannot remove empty header')\n  }\n\n  header.name = null\n  header.type = byteView()\n\n  for (let idx = 0; idx < (headers.length - 1);) {\n    const merged = mergeEmptyHeaders(headers[idx], headers[idx + 1])\n    if (merged) {\n      headers.splice(idx, 2, merged)\n    } else {\n      idx += 1\n    }\n  }\n}\n\nfunction mergeEmptyHeaders (h1: Header, h2: Header): Header | null {\n  if (h1.name === null && h2.name === null) {\n    return {\n      name: null,\n      offset: h1.offset,\n      length: h1.length + h2.length,\n      type: byteView()\n    }\n  }\n\n  return null\n}\n","// eslint-disable-next-line @typescript-eslint/no-var-requires\nexport const schema = require('./schema.json') as Array<SchemaTable | SchemaEnum>\n\nexport type ColumnType =\n  'uint8' | 'uint16' | 'uint32' | 'uint64' |\n  'int8' | 'int16' | 'int32' | 'int64' |\n  'float32' | 'float64' |\n  'string' |\n  'rowidx' |\n  'bool' |\n  'enum'\n\nexport interface TableColumn {\n  name: string\n  array?: boolean\n  type: ColumnType | null\n  unique?: boolean\n  references?: { table: string, column?: string } | { enum: string }\n}\n\nexport interface SchemaTable {\n  name: string\n  columns: TableColumn[]\n}\n\nexport interface SchemaEnum {\n  name: string\n  enum: string[]\n}\n","import { openDB, DBSchema } from 'idb'\nimport type { Header } from './headers'\nimport { schema, SchemaEnum, SchemaTable } from '@/assets/schema'\n\ninterface DatSchema {\n  name: string\n  headers: ViewerSerializedHeader[]\n}\n\nexport interface ViewerSerializedHeader {\n  name: string | null\n  length?: number\n  type: {\n    byteView?: { array: boolean }\n    array?: boolean\n    boolean?: {}\n    integer?: { unsigned: boolean, size: number }\n    decimal?: { size: number }\n    string?: {}\n    key?: { foreign: boolean }\n  }\n  textLength?: number\n}\n\ninterface PoeDatViewerSchema extends DBSchema {\n  'dat-schemas': {\n    key: DatSchema['name']\n    value: DatSchema\n  }\n}\n\nconst db = openDB<PoeDatViewerSchema>('poe-dat-viewer', 3, {\n  upgrade (db) {\n    db.createObjectStore('dat-schemas', { keyPath: 'name' })\n  }\n})\n\nexport async function findByName (name: string) {\n  const record = await (await db).get('dat-schemas', name)\n  return record?.headers || fromJsonSchema(name) || []\n}\n\nexport async function saveHeaders (\n  name: string,\n  headers: Header[]\n) {\n  await (await db).put('dat-schemas', {\n    name,\n    headers: serializeHeaders(headers)\n  })\n}\n\nfunction serializeHeaders (headers: Header[]) {\n  return headers.map<ViewerSerializedHeader>(header => ({\n    ...header,\n    length: (\n      header.type.string ||\n      header.type.array ||\n      header.type.key ||\n      header.type.boolean ||\n      header.type.decimal ||\n      header.type.integer\n    ) ? undefined\n      : header.length\n  }))\n}\n\nfunction fromJsonSchema (name: string): ViewerSerializedHeader[] | null {\n  const sch = schema.find(s => s.name === name)\n  if (!sch || (sch as SchemaEnum).enum) return null\n\n  return (sch as SchemaTable).columns.map(column => {\n    return { /* eslint-disable indent */\n      name: column.name,\n      type: {\n        array: column.array,\n        integer:\n          column.type === 'uint8' ? { unsigned: true, size: 1 }\n          : column.type === 'uint16' ? { unsigned: true, size: 2 }\n          : column.type === 'uint32' ? { unsigned: true, size: 4 }\n          : column.type === 'uint64' ? { unsigned: true, size: 8 }\n          : column.type === 'int8' ? { unsigned: false, size: 1 }\n          : column.type === 'int16' ? { unsigned: false, size: 2 }\n          : column.type === 'int32' ? { unsigned: false, size: 4 }\n          : column.type === 'int64' ? { unsigned: false, size: 8 }\n          // TODO: dedicated type\n          : column.type === 'enum' ? { unsigned: true, size: 4 }\n          : undefined,\n        decimal:\n          column.type === 'float32' ? { size: 4 }\n          : column.type === 'float64' ? { size: 8 }\n          : undefined,\n        string:\n          column.type === 'string' ? {}\n          : undefined,\n        boolean:\n          column.type === 'bool' ? {}\n          : undefined,\n        key:\n          column.type === 'rowidx' ? {\n            foreign: (column.references as { table: string }).table !== name\n          }\n          : undefined\n      },\n      textLength: 4 * 3 - 1\n    }\n  })\n}\n","import { DatFile, readDatFile, readColumn } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { validateHeader } from 'pathofexile-dat/dat-analysis/validation'\nimport { getHeaderLength } from 'pathofexile-dat/dat/header'\nimport { Header, createHeaderFromSelected, byteView } from './headers'\nimport * as db from './db'\nimport { clearColumnSelection, selectColsByHeader } from './selection'\nimport { shallowRef, Ref, triggerRef, shallowReactive } from 'vue'\nimport { analyzeDatFile } from '../worker/interface'\n\nexport interface Viewer {\n  readonly name: string\n  readonly datFile: DatFile\n  headers: Ref<Header[]>\n  columnStats: Ref<ColumnStats[]>\n  columnSelection: Ref<boolean[]>\n  editHeader: Ref<Header | null>\n  rowSorting: Ref<number[] | null>\n  scrollPos: { x: number, y: number }\n}\n\nexport function createViewer (path: string, fileContent: Uint8Array): Viewer {\n  const parsed = readDatFile(path, fileContent)\n\n  const viewer: Viewer = {\n    headers: shallowRef(\n      parsed.rowLength\n        ? [{\n          name: null,\n          offset: 0,\n          length: parsed.rowLength,\n          type: byteView()\n        }] : []\n    ),\n    datFile: parsed,\n    name: getNamePart(path),\n    columnStats: shallowRef([]),\n    columnSelection: shallowRef(new Array(parsed.rowLength).fill(false)),\n    editHeader: shallowRef(null),\n    rowSorting: shallowRef(null),\n    scrollPos: shallowReactive({ x: 0, y: 0 })\n  }\n\n  analyzeDatFile(viewer.datFile).then(async stats => {\n    viewer.columnStats.value = stats\n\n    const headers = await db.findByName(viewer.name)\n    try {\n      tryImportHeaders(headers, viewer)\n    } catch (e) {\n      window.alert(`WARN: ${e.message}`)\n    } finally {\n      triggerRef(viewer.headers)\n    }\n  })\n\n  return viewer\n}\n\nfunction tryImportHeaders (serialized: db.ViewerSerializedHeader[], viewer: Viewer) {\n  let offset = 0\n  for (const hdrSerialized of serialized) {\n    const headerLength = hdrSerialized.length || getHeaderLength(hdrSerialized, viewer.datFile)\n    if (hdrSerialized.name == null) {\n      offset += headerLength\n      continue\n    }\n\n    const header: Header = {\n      ...hdrSerialized,\n      length: headerLength,\n      offset: offset\n    }\n\n    const isValid = (hdrSerialized.length)\n      ? (viewer.datFile.rowLength - header.offset) >= header.length\n      : validateHeader(header, viewer.columnStats.value, viewer.datFile)\n    if (!isValid) {\n      throw new Error('The schema is invalid.')\n    }\n\n    selectColsByHeader(header, viewer.columnSelection.value)\n    const headerCreated = createHeaderFromSelected(viewer.columnSelection.value, viewer.headers.value)\n    Object.assign(headerCreated, header)\n    clearColumnSelection(viewer.columnSelection.value)\n\n    offset += headerLength\n  }\n}\n\nexport function exportAllRows (headers: Header[], datFile: DatFile) {\n  const columns = headers\n    .filter(({ type }) => type.boolean || type.decimal || type.integer || type.key || type.string)\n    .map((header, idx) => ({\n      name: header.name || `Unknown${idx + 1}`,\n      data: (() => {\n        const data = readColumn(header, datFile)\n\n        if (header.type.key?.foreign) {\n          if (!header.type.array) {\n            const data_ = data as ({ rid: number, unknown: number } | null)[]\n            if (!data_.every(row => row == null || row.unknown === 0)) {\n              throw new Error('never')\n            }\n            return data_.map(row => row && row.rid)\n          } else {\n            const data_ = data as (Array<{ rid: number, unknown: number }>)[]\n            if (!data_.every(row => row.every(entry => entry.unknown === 0))) {\n              throw new Error('never')\n            }\n            return data_.map(row => row.map(entry => entry.rid))\n          }\n        }\n\n        return data\n      })()\n    }))\n\n  columns.unshift({\n    name: '_rid',\n    data: Array(datFile.rowCount).fill(undefined)\n      .map((_, idx) => idx)\n  })\n\n  return Array(datFile.rowCount).fill(undefined)\n    .map((_, idx) => Object.fromEntries(\n      columns.map(col => [col.name, col.data[idx]])\n    ))\n}\n\nfunction getNamePart (path: string) {\n  return path.match(/[^/]+(?=\\..+$)/)![0]\n}\n\nexport function saveHeaders (viewer: Viewer) {\n  db.saveHeaders(viewer.name, viewer.headers.value)\n}\n","<template>\n  <div :class=\"$style.bar\">\n    <div class=\"flex\">\n      <template v-if=\"selections.length === 0\">\n        <div class=\"text-gray-500 italic px-1.5 self-center\">No bytes selected</div>\n      </template>\n      <template v-else-if=\"selections.length === 1\">\n        <button class=\"hover:bg-gray-400 hover:text-black px-1.5\"\n          @click=\"defineColumn\"><i class=\"codicon codicon-add\"></i> Define column</button>\n      </template>\n      <template v-else-if=\"selections.length > 1\">\n        <div class=\"text-gray-400 px-1.5 mr-1 self-center\">Selections</div>\n        <!-- eslint-disable-next-line vue/require-v-for-key -->\n        <div v-for=\"range in selections\"\n          class=\"px-1.5 mr-1 font-mono bg-gray-300 text-black flex items-center\"\n          v-text=\"range\" />\n      </template>\n    </div>\n    <div class=\"flex space-x-1\">\n      <button v-if=\"rowSorting\"\n        class=\"bg-gray-700 hover:bg-gray-400 hover:text-black px-1.5 border border-gray-600\"\n        @click=\"rowSorting = null\"\n        >Reset sorting</button>\n      <button\n        class=\"hover:bg-gray-400 hover:text-black px-1.5\"\n        @click=\"exportDataJson\"\n        >Export data</button>\n      <!-- <button TODO\n        class=\"hover:bg-gray-400 hover:text-black px-1.5\"\n        >Export schema</button> -->\n      <!-- <button\n        class=\"hover:bg-gray-400 hover:text-black px-1.5\"\n        ><i class=\"codicon codicon-ellipsis\" /></button> -->\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, inject, triggerRef } from 'vue'\nimport { clearColumnSelection, getColumnSelections } from '../selection'\nimport { createHeaderFromSelected } from '../headers'\nimport FileSaver from 'file-saver'\nimport { Viewer, exportAllRows, saveHeaders } from '../Viewer'\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const selections = computed(() =>\n      getColumnSelections(viewer.columnSelection.value)\n        .map(range => range.map(col => String(col)).join(' '))\n    )\n\n    function defineColumn () {\n      const { editHeader, columnSelection, headers } = viewer\n      editHeader.value = createHeaderFromSelected(columnSelection.value, headers.value)\n      clearColumnSelection(columnSelection.value)\n      triggerRef(headers)\n      triggerRef(columnSelection)\n      saveHeaders(viewer)\n    }\n\n    function exportDataJson () {\n      const data = exportAllRows(viewer.headers.value, viewer.datFile)\n      FileSaver.saveAs(new File(\n        [JSON.stringify(data, null, 2)],\n        `${viewer.name}.json`,\n        { type: 'application/json;charset=utf-8' }\n      ))\n    }\n\n    return {\n      viewer,\n      rowSorting: viewer.rowSorting,\n      selections,\n      defineColumn,\n      exportDataJson\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.bar {\n  display: flex;\n  justify-content: space-between;\n  line-height: 1;\n  @apply text-gray-300;\n  @apply p-2;\n  @apply bg-gray-900;\n  height: 35px;\n}\n</style>\n","\nimport { defineComponent, computed, inject, triggerRef } from 'vue'\nimport { clearColumnSelection, getColumnSelections } from '../selection'\nimport { createHeaderFromSelected } from '../headers'\nimport FileSaver from 'file-saver'\nimport { Viewer, exportAllRows, saveHeaders } from '../Viewer'\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const selections = computed(() =>\n      getColumnSelections(viewer.columnSelection.value)\n        .map(range => range.map(col => String(col)).join(' '))\n    )\n\n    function defineColumn () {\n      const { editHeader, columnSelection, headers } = viewer\n      editHeader.value = createHeaderFromSelected(columnSelection.value, headers.value)\n      clearColumnSelection(columnSelection.value)\n      triggerRef(headers)\n      triggerRef(columnSelection)\n      saveHeaders(viewer)\n    }\n\n    function exportDataJson () {\n      const data = exportAllRows(viewer.headers.value, viewer.datFile)\n      FileSaver.saveAs(new File(\n        [JSON.stringify(data, null, 2)],\n        `${viewer.name}.json`,\n        { type: 'application/json;charset=utf-8' }\n      ))\n    }\n\n    return {\n      viewer,\n      rowSorting: viewer.rowSorting,\n      selections,\n      defineColumn,\n      exportDataJson\n    }\n  }\n})\n","import { render } from \"./Actions.vue?vue&type=template&id=17f50966&bindings={}\"\nimport script from \"./Actions.vue?vue&type=script&lang=ts\"\nexport * from \"./Actions.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Actions.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div class=\"datv-header-layer\">\n    <div :style=\"headersRowStyle\" class=\"absolute\">\n      <button v-for=\"col in headers\" :key=\"col.offset\"\n        class=\"datv-header\" :class=\"{ 'datv-col--border': col.border }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n        :title=\"col.name\"\n        @click=\"editHeader(col.offset)\"\n        @wheel=\"handleHeaderWheel(col.offset, $event)\">\n        <template v-if=\"col.name === null\">&nbsp;</template>\n        <span v-else-if=\"col.name === ''\" class=\"bg-gray-600 text-gray-300 px-1\">?</span>\n        <template v-else>{{ col.name }}</template>\n      </button>\n    </div>\n    <div :style=\"colsRowStyle\" class=\"absolute\">\n      <button v-for=\"col in columns\" :key=\"col.offset\"\n        class=\"datv-byte\"\n        :class=\"{\n          'datv-col--border': col.border,\n          'datv-byte--selected': col.selected\n        }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n        @mousedown=\"selectStart(col.offset)\"\n        @mouseenter=\"selectContinue(col.offset, $event)\"\n        :title=\"col.offset\"\n        v-text=\"col.text\"\n      />\n    </div>\n    <div :style=\"statsRowStyle\" class=\"absolute datv-stats_row\">\n      <div v-for=\"col in columns\" :key=\"col.offset\"\n        class=\"datv-stat\"\n        :class=\"{\n          'datv-col--border': col.border,\n          'datv-byte--selected': col.selected\n        }\"\n        :style=\"{ width: col.widthPx + 'px', transform: `translate(${col.leftPx}px, 0)` }\"\n      >\n        <template v-if=\"col.stat\">\n          <div v-if=\"col.stat.string\"\n            class=\"datv-stat__line bg-yellow-600\" style=\"top: 0;\" />\n          <div v-if=\"col.stat.array\"\n            class=\"datv-stat__line bg-teal-500\" style=\"top: 7px;\" />\n          <div v-if=\"col.stat.zero\"\n            class=\"datv-stat__line bg-gray-900\" style=\"top: 14px;\" />\n          <div v-else-if=\"col.stat.nullable\"\n            class=\"datv-stat__line bg-pink-500\" style=\"top: 14px;\" />\n          <div class=\"datv-stat__max\" v-text=\"col.stat.max\" />\n        </template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { toggleColsBetween } from '../selection'\nimport { sortRows } from '../sorting'\nimport { defineComponent, inject, shallowRef, shallowReactive, watch, computed, triggerRef } from 'vue'\nimport { Viewer } from '../Viewer'\nimport * as rendering from '../rendering'\nimport { Header } from '../headers'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  props: {\n    left: {\n      type: Number,\n      required: true\n    },\n    width: {\n      type: Number,\n      required: true\n    },\n    columns: {\n      type: Array,\n      required: true\n    }\n  },\n  setup (props) {\n    const sortOrder = shallowRef(0)\n    let selectionStart = -1\n    let colsBeforeSelection = [] as readonly boolean[]\n\n    const viewer = inject<Viewer>('viewer')!\n\n    function selectStart (offset: number) {\n      selectionStart = offset\n      colsBeforeSelection = [...viewer.columnSelection.value]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, selectionStart, viewer.headers.value)\n      triggerRef(viewer.columnSelection)\n\n      document.addEventListener('mouseup', cancelSelection)\n      document.addEventListener('mouseleave', cancelSelection)\n      function cancelSelection () {\n        selectionStart = -1\n        document.removeEventListener('mouseup', cancelSelection)\n        document.removeEventListener('mouseleave', cancelSelection)\n      }\n    }\n\n    function selectContinue (offset: number, e: MouseEvent) {\n      if (selectionStart === -1 || e.buttons !== 1) return\n\n      const { memsize } = viewer.datFile\n      const len = offset - selectionStart\n      if (len >= memsize) {\n        offset = (selectionStart + memsize * 2) - 1\n      } else if (len >= 4) {\n        offset = (selectionStart + 8) - 1\n      } else if (len >= 2) {\n        offset = (selectionStart + 4) - 1\n      }\n      if (len <= -memsize) {\n        offset = (selectionStart - memsize * 2) + 1\n      } else if (len <= -4) {\n        offset = (selectionStart - 8) + 1\n      } else if (len <= -2) {\n        offset = (selectionStart - 4) + 1\n      }\n\n      viewer.columnSelection.value = [...colsBeforeSelection]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, offset, viewer.headers.value)\n    }\n\n    function editHeader (offset: number) {\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (\n        viewer.editHeader.value === header &&\n        (!header.type.byteView || header.type.byteView.array)\n      ) {\n        if (sortOrder.value === 0) {\n          sortOrder.value = 1\n        } else if (sortOrder.value === 1) {\n          sortOrder.value = -1\n        } else if (sortOrder.value === -1) {\n          sortOrder.value = 1\n        }\n        viewer.rowSorting.value = sortRows(header, sortOrder.value as 1 | -1, viewer.datFile)\n      } else {\n        viewer.editHeader.value = header\n        sortOrder.value = 0\n      }\n    }\n\n    function handleHeaderWheel (offset: number, e: WheelEvent) {\n      e.preventDefault()\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (header.textLength != null) {\n        header.textLength = Math.max(1, header.textLength -\n          Math.sign(e.deltaY) * (e.ctrlKey ? 4 * 3 - 2 : 1))\n        triggerRef(viewer.headers)\n      }\n    }\n\n    const headers = computed(() =>\n      renderHeaderCols(viewer.headers.value, props.left, props.left + props.width))\n\n    return {\n      headers,\n      selectStart,\n      selectContinue,\n      editHeader,\n      handleHeaderWheel,\n      headersRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, 0)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      colsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT}px)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      statsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT * 2}px)`, fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' }))\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\">\n.datv-col--border {\n  @apply border-l border-gray-500;\n}\n\n.datv-header {\n  @apply text-gray-700;\n  position: absolute;\n  box-sizing: border-box;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n  @apply px-1.5;\n\n  &:hover {\n    @apply bg-gray-400;\n    @apply text-gray-800;\n  }\n}\n\n.datv-byte {\n  @apply text-gray-700;\n  position: absolute;\n  box-sizing: content-box;\n  text-align: center;\n  white-space: nowrap;\n  overflow: hidden;\n\n  &:hover {\n    @apply bg-blue-400;\n    @apply text-white;\n  }\n\n  &.datv-byte--selected {\n    @apply bg-blue-500;\n    @apply text-blue-100;\n  }\n\n  &.datv-byte--selected.datv-col--border,\n  &.datv-byte--selected + &.datv-col--border {\n    @apply border-blue-700;\n  }\n}\n\n.datv-stat {\n  position: absolute;\n  box-sizing: content-box;\n  text-align: center;\n  white-space: nowrap;\n  line-height: 21px;\n  height: 21px;\n\n  &.datv-byte--selected.datv-col--border,\n  &.datv-byte--selected + &.datv-col--border {\n    @apply border-gray-500;\n  }\n\n  &.datv-byte--selected {\n    @apply bg-gray-400;\n  }\n\n  .datv-stats_row:hover > & {\n    @apply bg-gray-500;\n  }\n}\n\n.datv-stat__line {\n  position: absolute;\n  height: 7px;\n  width: 100%;\n\n  .datv-col--border > & {\n    width: calc(100% + 1px);\n    margin-left: -1px;\n  }\n\n  .datv-stats_row:hover & {\n    --bg-opacity: 0.35;\n  }\n}\n\n.datv-stat__max {\n  visibility: hidden;\n  text-align: center;\n  cursor: default;\n  line-height: 21px;\n  width: 100%;\n  height: 21px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  @apply text-gray-100;\n  text-shadow: 0 0 0.5ch rgb(0 0 0 / 70%);\n\n  .datv-stats_row:hover & {\n    visibility: visible;\n  }\n}\n\n.datv-header-layer {\n  position: absolute;\n  overflow: hidden;\n  transform: translate3d(0, 0, 0);\n  contain: strict;\n  @apply bg-gray-200;\n}\n</style>\n","import { readColumn, DatFile, Header } from 'pathofexile-dat'\n\nexport function sortRows (header: Header, order: 1 | -1, datFile: DatFile): number[] {\n  const data = readColumn(header, datFile)\n\n  const rows = Array.from({ length: datFile.rowCount }, (_, idx) => idx)\n  if (header.type.array) {\n    rows.sort((ai, bi) => {\n      const a = data[ai] as unknown[]\n      const b = data[bi] as unknown[]\n      return (b.length - a.length) * order\n    })\n  } else {\n    if (header.type.boolean) {\n      rows.sort((ai, bi) => {\n        const a = Number(data[ai] as boolean)\n        const b = Number(data[bi] as boolean)\n        return (a - b) * order\n      })\n    } else if (header.type.string) {\n      rows.sort((ai, bi) => {\n        const a = data[ai] as string\n        const b = data[bi] as string\n        return a.localeCompare(b) * order\n      })\n    } else if (header.type.integer || header.type.decimal) {\n      rows.sort((ai, bi) => {\n        const a = data[ai] as number\n        const b = data[bi] as number\n        return (b - a) * order\n      })\n    } else if (header.type.key) {\n      if (header.type.key.foreign) {\n        rows.sort((ai, bi) => {\n          const a = data[ai] as { rid: number, unknown: number } | null\n          const b = data[bi] as { rid: number, unknown: number } | null\n          return ((b?.rid || 0) - (a?.rid || 0)) * order\n        })\n      } else {\n        rows.sort((ai, bi) => {\n          const a = Number(data[ai] as number | null)\n          const b = Number(data[bi] as number | null)\n          return (b - a) * order\n        })\n      }\n    }\n  }\n\n  return rows\n}\n","import { CHAR_WIDTH, LINE_HEIGHT } from '../rendering'\nimport { getFieldReader } from 'pathofexile-dat/dat/reader'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport type { Header } from '../headers'\n\ninterface StringifyOut {\n  text: string\n  color: string\n}\n\nfunction numberToString (value: number, out: StringifyOut) {\n  out.text = String(value)\n  out.color = '#098658'\n}\nfunction numberArrayToString (value: number[], out: StringifyOut) {\n  out.text = `[${value.join(', ')}]`\n  out.color = '#098658'\n}\nfunction booleanToString (value: boolean, out: StringifyOut) {\n  out.text = String(value)\n  out.color = '#0000ff'\n}\nfunction booleanArrayToString (value: boolean[], out: StringifyOut) {\n  out.text = `[${value.join(', ')}]`\n  out.color = '#0000ff'\n}\nfunction stringToString (value: string, out: StringifyOut) {\n  if (value === '') {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = String(value)\n    out.color = '#001080'\n  }\n}\nfunction stringArrayToString (value: string[], out: StringifyOut) {\n  out.text = `[${value.map(str => '\"' + str + '\"').join(', ')}]`\n  out.color = '#001080'\n}\nfunction keySelfToString (value: number | null, out: StringifyOut) {\n  if (value === null) {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = `<${value}, self>`\n    out.color = '#098658'\n  }\n}\nfunction keySelfArrayToString (value: number[], out: StringifyOut) {\n  out.text = `[${value.map(key => `<${key}, self>`).join(', ')}]`\n  out.color = '#098658'\n}\nfunction keyForeignToString (value: { rid: number, unknown: number } | null, out: StringifyOut) {\n  if (value === null) {\n    out.text = 'null'\n    out.color = '#0000ff'\n  } else {\n    out.text = `<${value.rid}, ${value.unknown}>`\n    out.color = '#098658'\n  }\n}\nfunction keyForeignArrayToString (value: { rid: number, unknown: number }[], out: StringifyOut) {\n  out.text = `[${value.map(key => `<${key.rid}, ${key.unknown}>`).join(', ')}]`\n  out.color = '#098658'\n}\n\nexport function renderCellContent (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[]) {\n  const read = getFieldReader(header, datFile)\n\n  const draw: StringifyOut = { text: '', color: '' }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const stringify: (value: any, out: StringifyOut) => void = (() => {\n    if (header.type.array) {\n      if (header.type.boolean) return booleanArrayToString\n      if (header.type.string) return stringArrayToString\n      if (header.type.integer || header.type.decimal) return numberArrayToString\n      if (header.type.key && header.type.key.foreign) return keyForeignArrayToString\n      if (header.type.key && !header.type.key.foreign) return keySelfArrayToString\n    } else {\n      if (header.type.boolean) return booleanToString\n      if (header.type.string) return stringToString\n      if (header.type.integer || header.type.decimal) return numberToString\n      if (header.type.key && header.type.key.foreign) return keyForeignToString\n      if (header.type.key && !header.type.key.foreign) return keySelfToString\n    }\n    throw new Error('never')\n  })()\n\n  let textY = 0\n  let prevColor = ''\n  for (const rid of rows) {\n    stringify(read(rid), draw)\n    if (prevColor !== draw.color) {\n      ctx.fillStyle = draw.color\n      prevColor = draw.color\n    }\n    ctx.fillText(draw.text, 0, textY)\n    textY += LINE_HEIGHT\n  }\n}\n\nexport function drawByteView (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[], begin: number, end: number) {\n  ctx.fillStyle = '#000'\n\n  let textY = 0\n  for (const rowIdx of rows) {\n    const data = datFile.dataFixed.subarray(\n      (rowIdx * datFile.rowLength) + header.offset + begin,\n      (rowIdx * datFile.rowLength) + header.offset + end\n    )\n    const hexDump = Array.from(data, byte =>\n      byte.toString(16).padStart(2, '0')\n    ).join(' ')\n\n    ctx.fillText(hexDump, begin * (CHAR_WIDTH * 3), textY)\n    textY += LINE_HEIGHT\n  }\n}\n\nexport function drawArrayVarData (ctx: CanvasRenderingContext2D, header: Header, datFile: DatFile, rows: number[], stats: ColumnStats) {\n  ctx.fillStyle = '#000'\n\n  const stat = stats.refArray as Exclude<typeof stats['refArray'], false>\n  const entryMaxLength = Math.max(...([\n    (stat.keyForeign ? datFile.fieldSize.KEY_FOREIGN : 0),\n    (stat.keySelf ? datFile.fieldSize.KEY : 0),\n    (stat.string ? datFile.fieldSize.STRING : 0),\n    (stat.longLong ? datFile.fieldSize.LONGLONG : 0),\n    (stat.long ? datFile.fieldSize.LONG : 0),\n    (stat.short ? datFile.fieldSize.SHORT : 0),\n    (datFile.fieldSize.BYTE)\n  ]))\n  const maxReadBytes = Math.ceil(header.textLength! / 3)\n\n  let textY = 0\n  for (const rowIdx of rows) {\n    const arrayLength = datFile.readerFixed.getSizeT((rowIdx * datFile.rowLength) + header.offset)\n    if (arrayLength === 0) {\n      ctx.fillText('[]', 0, textY)\n    } else {\n      const varOffset = datFile.readerFixed.getSizeT((rowIdx * datFile.rowLength) + header.offset + datFile.memsize)\n\n      const data = datFile.dataVariable.subarray(\n        varOffset,\n        varOffset + Math.min(entryMaxLength * arrayLength, maxReadBytes)\n      )\n      const hexDump = Array.from(data, byte =>\n        byte.toString(16).padStart(2, '0')\n      ).join(' ')\n\n      ctx.fillText(`${arrayLength} { ${hexDump} }`, 0, textY)\n    }\n    textY += LINE_HEIGHT\n  }\n}\n","import type { Header } from './headers'\nimport type { RenderByte } from './rendering/byte-columns'\nimport type { Viewer } from './Viewer'\nimport { renderCellContent, drawByteView, drawArrayVarData } from './rendering/content'\n\n/* eslint-disable */\nexport const FONT_FAMILY    = 'Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace'\nexport const FONT_SIZE      = 14\nexport const CHAR_WIDTH     = getMonoFontWidth(FONT_SIZE, FONT_FAMILY)\nexport const XBASE_HEIGHT   = getFontBaseLine(FONT_SIZE, FONT_FAMILY)\nexport const LINE_HEIGHT    = 19\nexport const ROWNUM_MIN_LENGTH    = 3\nexport const BORDER_WIDTH         = 1\nexport const COLUMN_STAT_HEIGHT   = 7\nexport const COLUMN_BYTE_HEIGHT   = Math.round(CHAR_WIDTH * 3)\nexport const HEADERS_HEIGHT       = COLUMN_BYTE_HEIGHT * 2 + COLUMN_STAT_HEIGHT * 3\n/* eslint-enable */\n\n// console.log(getBaseLine(14), 'CR: 11  |  FF: 12')\n// console.log(getBaseLine(18), 'CR: 13  |  FF: 14')\n// console.log(getBaseLine(19), 'CR: 14  |  FF: 14')\n// console.log(getBaseLine(20), 'CR: 14  |  FF: 15')\n\nexport function rowNumLength (rowCount: number) {\n  const maxLen = String(rowCount - 1).length\n  return Math.max(maxLen, ROWNUM_MIN_LENGTH)\n}\n\nexport function rowsNumWidth (rowCount: number) {\n  return Math.ceil(rowNumLength(rowCount) * CHAR_WIDTH)\n}\n\nexport function rowsOverlayWidth (rowCount: number) {\n  return rowsNumWidth(rowCount) + (8 * 2)\n}\n\nfunction getMonoFontWidth (fontSize: number, fontFamily: string): number {\n  const canvasEl = document.createElement('canvas')\n  const context = canvasEl.getContext('2d')!\n  context.font = `${fontSize}px ${fontFamily}`\n  const metrics = context.measureText('0')\n  return metrics.width\n}\n\nfunction getFontBaseLine (fontSize: number, fontFamily: string): number {\n  const canvasEl = document.createElement('canvas')\n  const context = canvasEl.getContext('2d')!\n  context.font = `${fontSize}px ${fontFamily}`\n  context.textBaseline = 'middle'\n  const metrics = context.measureText('0')\n  const xBase = (fontSize / 2) +\n    ((metrics.alphabeticBaseline !== undefined)\n      ? -metrics.alphabeticBaseline\n      : metrics.actualBoundingBoxDescent)\n\n  return xBase\n}\n\nexport function getBaseLine (lineHeight: number): number {\n  return /* Math.round */ (1 + (lineHeight - FONT_SIZE) / 2 + XBASE_HEIGHT)\n}\n\nexport function drawRows (params: {\n  left: number\n  paintWidth: number\n  top: number\n  rows: number[]\n  columns: RenderByte[]\n  viewer: Viewer\n  ctx: CanvasRenderingContext2D\n}) {\n  const { ctx } = params\n\n  ctx.fillStyle = '#fff'\n  ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n  ctx.save()\n  ctx.translate(-params.left, 0)\n  drawColumns(ctx, params.columns)\n  ctx.restore()\n\n  ctx.font = `${FONT_SIZE}px ${FONT_FAMILY}`\n  ctx.fillStyle = '#000'\n\n  const renderers = getColumnRenderers(params.viewer, params.left, params.left + params.paintWidth)\n\n  for (const render of renderers) {\n    ctx.save()\n    ctx.beginPath()\n    ctx.translate(render.left - params.left, 0)\n    ctx.rect(0, 0, render.width, ctx.canvas.height)\n    ctx.clip()\n    ctx.translate(CHAR_WIDTH / 2, params.top + getBaseLine(LINE_HEIGHT))\n    render.exec(ctx, params.rows)\n    ctx.restore()\n  }\n}\n\nfunction drawColumns (ctx: CanvasRenderingContext2D, columns: readonly RenderByte[]) {\n  for (const col of columns) {\n    if (col.selected) {\n      ctx.fillStyle = '#bee3f8'\n      ctx.fillRect(\n        col.leftPx + (col.border ? BORDER_WIDTH : 0), 0,\n        col.widthPx, ctx.canvas.height\n      )\n    }\n    if (col.border) {\n      ctx.fillStyle = '#bdbdbd'\n      ctx.fillRect(\n        col.leftPx, 0,\n        BORDER_WIDTH, ctx.canvas.height\n      )\n    }\n  }\n}\n\ntype DrawColumnContentFn = (ctx: CanvasRenderingContext2D, rows: number[]) => void\ninterface ColumnContentRenderer {\n  left: number\n  width: number\n  exec: DrawColumnContentFn\n}\n\nexport function getColumnRenderers (viewer: Viewer, paintBegin: number, paintEnd: number): ColumnContentRenderer[] {\n  const headers = viewer.headers.value\n  const stats = viewer.columnStats.value\n  const datFile = viewer.datFile\n\n  const res: ColumnContentRenderer[] = []\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if ((left + sizes.borderWidth) >= paintBegin) {\n      if (header.type.byteView) {\n        if (header.type.byteView.array) {\n          res.push({\n            left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n            width: sizes.paddingWidth,\n            exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n              drawArrayVarData(ctx, header, datFile, rows, stats[header.offset])\n          })\n        } else {\n          const hexBegin = Math.max(0, Math.floor((paintBegin - left) / (CHAR_WIDTH * 3)))\n          const hexEnd = Math.min(header.length, Math.ceil((paintEnd - left) / (CHAR_WIDTH * 3)))\n          res.push({\n            left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n            width: sizes.paddingWidth,\n            exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n              drawByteView(ctx, header, datFile, rows, hexBegin, hexEnd)\n          })\n        }\n      } else {\n        res.push({\n          left: left + (sizes.borderWidth ? BORDER_WIDTH : 0),\n          width: sizes.paddingWidth,\n          exec: (ctx: CanvasRenderingContext2D, rows: number[]) =>\n            renderCellContent(ctx, header, datFile, rows)\n        })\n      }\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n\nexport function columnSizes (header: Readonly<Header>) {\n  const textLength = (header.type.byteView && !header.type.byteView.array)\n    ? header.length * 3 - 1\n    : header.textLength!\n  return {\n    paddingWidth: Math.ceil((textLength + 1) * CHAR_WIDTH),\n    borderWidth: Math.ceil((textLength + 1) * CHAR_WIDTH) + (header.offset > 0 ? BORDER_WIDTH : 0),\n    hasBorder: header.offset > 0\n  }\n}\n\nexport function getRowWidth (headers: readonly Header[]): number {\n  let size = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n    size += sizes.borderWidth\n  }\n  return size\n}\n","import type { Header } from '../headers'\nimport { columnSizes } from '../rendering'\n\ninterface RenderHeader {\n  offset: number\n  border: boolean\n  widthPx: number\n  leftPx: number\n  name: string | null\n}\n\nexport function renderHeaderCols (\n  headers: readonly Header[],\n  paintBegin: number,\n  paintEnd: number\n) {\n  const res: RenderHeader[] = []\n\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if ((left + sizes.borderWidth) >= paintBegin) {\n      res.push({\n        offset: header.offset,\n        border: sizes.hasBorder,\n        widthPx: sizes.borderWidth,\n        leftPx: left,\n        name: header.name\n      })\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n","\nimport { toggleColsBetween } from '../selection'\nimport { sortRows } from '../sorting'\nimport { defineComponent, inject, shallowRef, shallowReactive, watch, computed, triggerRef } from 'vue'\nimport { Viewer } from '../Viewer'\nimport * as rendering from '../rendering'\nimport { Header } from '../headers'\nimport { renderHeaderCols } from '../rendering/header-columns'\n\nexport default defineComponent({\n  props: {\n    left: {\n      type: Number,\n      required: true\n    },\n    width: {\n      type: Number,\n      required: true\n    },\n    columns: {\n      type: Array,\n      required: true\n    }\n  },\n  setup (props) {\n    const sortOrder = shallowRef(0)\n    let selectionStart = -1\n    let colsBeforeSelection = [] as readonly boolean[]\n\n    const viewer = inject<Viewer>('viewer')!\n\n    function selectStart (offset: number) {\n      selectionStart = offset\n      colsBeforeSelection = [...viewer.columnSelection.value]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, selectionStart, viewer.headers.value)\n      triggerRef(viewer.columnSelection)\n\n      document.addEventListener('mouseup', cancelSelection)\n      document.addEventListener('mouseleave', cancelSelection)\n      function cancelSelection () {\n        selectionStart = -1\n        document.removeEventListener('mouseup', cancelSelection)\n        document.removeEventListener('mouseleave', cancelSelection)\n      }\n    }\n\n    function selectContinue (offset: number, e: MouseEvent) {\n      if (selectionStart === -1 || e.buttons !== 1) return\n\n      const { memsize } = viewer.datFile\n      const len = offset - selectionStart\n      if (len >= memsize) {\n        offset = (selectionStart + memsize * 2) - 1\n      } else if (len >= 4) {\n        offset = (selectionStart + 8) - 1\n      } else if (len >= 2) {\n        offset = (selectionStart + 4) - 1\n      }\n      if (len <= -memsize) {\n        offset = (selectionStart - memsize * 2) + 1\n      } else if (len <= -4) {\n        offset = (selectionStart - 8) + 1\n      } else if (len <= -2) {\n        offset = (selectionStart - 4) + 1\n      }\n\n      viewer.columnSelection.value = [...colsBeforeSelection]\n      toggleColsBetween(viewer.columnSelection.value, selectionStart, offset, viewer.headers.value)\n    }\n\n    function editHeader (offset: number) {\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (\n        viewer.editHeader.value === header &&\n        (!header.type.byteView || header.type.byteView.array)\n      ) {\n        if (sortOrder.value === 0) {\n          sortOrder.value = 1\n        } else if (sortOrder.value === 1) {\n          sortOrder.value = -1\n        } else if (sortOrder.value === -1) {\n          sortOrder.value = 1\n        }\n        viewer.rowSorting.value = sortRows(header, sortOrder.value as 1 | -1, viewer.datFile)\n      } else {\n        viewer.editHeader.value = header\n        sortOrder.value = 0\n      }\n    }\n\n    function handleHeaderWheel (offset: number, e: WheelEvent) {\n      e.preventDefault()\n      const header = viewer.headers.value.find(h => h.offset === offset)!\n      if (header.textLength != null) {\n        header.textLength = Math.max(1, header.textLength -\n          Math.sign(e.deltaY) * (e.ctrlKey ? 4 * 3 - 2 : 1))\n        triggerRef(viewer.headers)\n      }\n    }\n\n    const headers = computed(() =>\n      renderHeaderCols(viewer.headers.value, props.left, props.left + props.width))\n\n    return {\n      headers,\n      selectStart,\n      selectContinue,\n      editHeader,\n      handleHeaderWheel,\n      headersRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, 0)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      colsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT}px)`, lineHeight: rendering.COLUMN_BYTE_HEIGHT + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' })),\n      statsRowStyle: computed(() =>\n        ({ transform: `translate(${-props.left}px, ${rendering.COLUMN_BYTE_HEIGHT * 2}px)`, fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px' }))\n    }\n  }\n})\n","import { render } from \"./ViewerHead.vue?vue&type=template&id=0ebc3bd7&bindings={}\"\nimport script from \"./ViewerHead.vue?vue&type=script&lang=ts\"\nexport * from \"./ViewerHead.vue?vue&type=script&lang=ts\"\n\nimport \"./ViewerHead.vue?vue&type=style&index=0&lang=postcss\"\nscript.render = render\n\nexport default script","<template>\n  <div v-if=\"isVisible\" style=\"width: 300px;\" class=\"relative overflow-hidden\">\n    <div :style=\"{ height: HEADERS_HEIGHT + 'px' }\" class=\"bg-gray-200\" />\n    <div class=\"m-2 shadow border border-gray-400 bg-white absolute inset-0 flex flex-col\">\n      <div class=\"p-2 bg-gray-200 text-gray-700 shadow flex justify-between items-baseline\">\n        <span class=\"px-2\">Column properties</span>\n        <button @click=\"close\" class=\"px-2 py-1\"\n          title=\"Close\"><i class=\"codicon codicon-close\"></i></button>\n      </div>\n      <div v-if=\"header.name === null\" class=\"p-4\">\n        <div>{{ header.length }} bytes of unidentified data</div>\n      </div>\n      <div v-else class=\"p-4 overflow-auto\">\n        <div class=\"mb-4\">\n          <label for=\"datv-header-name\">Name</label>\n          <input id=\"datv-header-name\" placeholder=\"Unnamed\" v-model.trim=\"header.name\"\n            class=\"border p-1 mt-1 w-full focus:border-blue-500\" spellcheck=\"false\">\n        </div>\n        <div class=\"mb-4 flex items-baseline\">\n          <div class=\"mr-2\">View mode</div>\n          <div class=\"space-x-px flex\">\n            <button v-for=\"opt in viewModeOpts\" :key=\"opt.value\"\n              class=\"px-2\"\n              :class=\"(byteViewMode === opt.value) ? 'bg-blue-500 text-white' : 'bg-gray-200 hover:bg-gray-400'\"\n              @click=\"byteViewMode = opt.value\"\n              :disabled=\"opt.disabled\"\n              v-text=\"opt.label\" />\n          </div>\n        </div>\n        <div class=\"mb-4\">\n          <div class=\"mb-2 flex justify-between items-baseline\">\n            <span>Data type</span>\n            <button class=\"text-red-700 bg-red-100 px-2\"\n             @click=\"remove\">Delete</button>\n          </div>\n          <div>\n            <div v-for=\"opt in dataTypeOpts\" :key=\"opt.value\" class=\"mb-0.5\">\n              <label class=\"inline-flex items-center\">\n                <input type=\"radio\" v-model=\"dataType\" :value=\"opt.value\">\n                <span class=\"ml-2 cursor-pointer\">{{ opt.label }}</span>\n              </label>\n            </div>\n            <div v-if=\"arrayTypeOpts.length\" class=\"mt-3\">\n              <div class=\"mb-1\">of ...</div>\n              <div v-for=\"opt in arrayTypeOpts\" :key=\"opt.value\" class=\"mb-0.5\">\n                <label class=\"inline-flex items-center\">\n                  <input type=\"radio\" v-model=\"arrayType\" :value=\"opt.value\">\n                  <span class=\"ml-2 cursor-pointer\">{{ opt.label }}</span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"mb-4\" v-if=\"header.type.integer\">\n          <label class=\"inline-flex items-center\">\n            <input type=\"checkbox\" v-model=\"header.type.integer.unsigned\">\n            <span class=\"ml-2 cursor-pointer\">Unsigned</span>\n          </label>\n        </div>\n        <div class=\"mb-4 border-t pt-4\" v-if=\"dataType\">\n          <label class=\"mr-4\">Width</label>\n          <input v-model.number=\"header.textLength\"\n            class=\"border w-16 text-center\"> chars\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, inject, computed, triggerRef, reactive, watch, WatchStopHandle } from 'vue'\nimport { Header, removeHeader } from '../headers'\nimport { Viewer, saveHeaders } from '../Viewer'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { HEADERS_HEIGHT } from '../rendering'\n\nfunction dataTypeOpts (header: Header, stats: ColumnStats, datFile: DatFile) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  const { fieldSize } = datFile\n  const len = header.length\n  if (len === fieldSize.ARRAY && stats.refArray) {\n    opts.push({ label: 'Array', value: 'array' })\n  }\n  if (len === fieldSize.STRING && stats.refString) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (len === fieldSize.KEY && stats.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (len === fieldSize.KEY_FOREIGN) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (len === 8 || len === 4 || len === 2 || len === 1) {\n    opts.push({ label: 'Integer', value: 'integer' })\n  }\n  if (len === 8 || len === 4) {\n    opts.push({ label: 'Decimal', value: 'decimal' })\n  }\n  if (len === 1 && stats.bMax <= 0x01) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n\n  return opts\n}\n\nfunction arrayTypeOpts (header: Header, stats: ColumnStats) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  if (!header.type.array || !stats.refArray) {\n    return opts\n  }\n\n  const array = stats.refArray\n  if (array.string) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (array.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (array.keyForeign) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Integer - 8 bytes', value: 'integer_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Integer - 4 bytes', value: 'integer_4' })\n  }\n  if (array.short) {\n    opts.push({ label: 'Integer - 2 bytes', value: 'integer_2' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Decimal - 8 bytes', value: 'decimal_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Decimal - 4 bytes', value: 'decimal_4' })\n  }\n  if (array.boolean) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n  opts.push({ label: 'Integer - byte', value: 'integer_1' })\n\n  return opts\n}\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const headerRef = computed(() => (viewer.editHeader.value && reactive(viewer.editHeader.value))!)\n    {\n      let watchStop = null as WatchStopHandle | null\n      watch(headerRef, (value) => {\n        if (watchStop) {\n          watchStop()\n          watchStop = null\n        }\n        if (value) {\n          watchStop = watch(value, () => {\n            triggerRef(viewer.headers)\n            saveHeaders(viewer)\n          }, { deep: true })\n        }\n      })\n    }\n\n    const stats = computed(() => viewer.columnStats.value[headerRef.value.offset])\n\n    const dataType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.array) {\n          return 'array'\n        } else if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return type.key.foreign ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return 'integer'\n        } else if (type.decimal) {\n          return 'decimal'\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = {}\n        if (type === 'array') {\n          header.type.array = true\n          header.type.byteView = { array: true }\n        } else if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer') {\n          header.type.integer = { unsigned: true, size: header.length }\n        } else if (type === 'decimal') {\n          header.type.decimal = { size: header.length }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const arrayType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return (type.key.foreign) ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return `integer_${type.integer.size}`\n        } else if (type.decimal) {\n          return `decimal_${type.decimal.size}`\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = { array: true }\n        if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer_1') {\n          header.type.integer = { unsigned: true, size: 1 }\n        } else if (type === 'integer_2') {\n          header.type.integer = { unsigned: true, size: 2 }\n        } else if (type === 'integer_4') {\n          header.type.integer = { unsigned: true, size: 4 }\n        } else if (type === 'integer_8') {\n          header.type.integer = { unsigned: true, size: 8 }\n        } else if (type === 'decimal_4') {\n          header.type.decimal = { size: 4 }\n        } else if (type === 'decimal_8') {\n          header.type.decimal = { size: 8 }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const viewModeOpts = computed(() => {\n      const opts = [] as Array<{ label: string, value: string, disabled?: boolean }>\n      const type = headerRef.value.type\n\n      opts.push({ label: 'Bytes', value: 'bytes' })\n      if (type.array) {\n        opts.push({ label: 'Var. bytes', value: 'array-bytes' })\n      }\n      opts.push({ label: 'Data', value: 'data', disabled: !dataType.value || (dataType.value === 'array' && !arrayType.value) })\n\n      return opts\n    })\n\n    const byteViewMode = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.byteView) {\n          return type.byteView.array ? 'array-bytes' : 'bytes'\n        } else {\n          return 'data'\n        }\n      },\n      set (mode) {\n        const type = headerRef.value.type\n        if (mode === 'data') {\n          type.byteView = undefined\n        } else {\n          type.byteView = {\n            array: mode === 'array-bytes'\n          }\n        }\n      }\n    })\n\n    function close () {\n      viewer.editHeader.value = null\n    }\n\n    function remove () {\n      removeHeader(headerRef.value, viewer.headers.value)\n      viewer.editHeader.value = null\n      triggerRef(viewer.headers)\n      saveHeaders(viewer)\n    }\n\n    return {\n      isVisible: computed(() => viewer.editHeader.value != null),\n      HEADERS_HEIGHT,\n      header: headerRef,\n      byteViewMode,\n      dataType,\n      arrayType,\n      close,\n      remove,\n      viewModeOpts,\n      dataTypeOpts: computed(() =>\n        dataTypeOpts(headerRef.value, stats.value, viewer.datFile)),\n      arrayTypeOpts: computed(() =>\n        arrayTypeOpts(headerRef.value, stats.value))\n    }\n  }\n})\n</script>\n","\nimport { defineComponent, inject, computed, triggerRef, reactive, watch, WatchStopHandle } from 'vue'\nimport { Header, removeHeader } from '../headers'\nimport { Viewer, saveHeaders } from '../Viewer'\nimport type { DatFile } from 'pathofexile-dat'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport { HEADERS_HEIGHT } from '../rendering'\n\nfunction dataTypeOpts (header: Header, stats: ColumnStats, datFile: DatFile) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  const { fieldSize } = datFile\n  const len = header.length\n  if (len === fieldSize.ARRAY && stats.refArray) {\n    opts.push({ label: 'Array', value: 'array' })\n  }\n  if (len === fieldSize.STRING && stats.refString) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (len === fieldSize.KEY && stats.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (len === fieldSize.KEY_FOREIGN) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (len === 8 || len === 4 || len === 2 || len === 1) {\n    opts.push({ label: 'Integer', value: 'integer' })\n  }\n  if (len === 8 || len === 4) {\n    opts.push({ label: 'Decimal', value: 'decimal' })\n  }\n  if (len === 1 && stats.bMax <= 0x01) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n\n  return opts\n}\n\nfunction arrayTypeOpts (header: Header, stats: ColumnStats) {\n  const opts = [] as Array<{ label: string, value: string }>\n\n  if (!header.type.array || !stats.refArray) {\n    return opts\n  }\n\n  const array = stats.refArray\n  if (array.string) {\n    opts.push({ label: 'String', value: 'string' })\n  }\n  if (array.keySelf) {\n    opts.push({ label: 'Key (self)', value: 'key_self' })\n  }\n  if (array.keyForeign) {\n    opts.push({ label: 'Key (foreign)', value: 'key_foreign' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Integer - 8 bytes', value: 'integer_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Integer - 4 bytes', value: 'integer_4' })\n  }\n  if (array.short) {\n    opts.push({ label: 'Integer - 2 bytes', value: 'integer_2' })\n  }\n  if (array.longLong) {\n    opts.push({ label: 'Decimal - 8 bytes', value: 'decimal_8' })\n  }\n  if (array.long) {\n    opts.push({ label: 'Decimal - 4 bytes', value: 'decimal_4' })\n  }\n  if (array.boolean) {\n    opts.push({ label: 'Boolean', value: 'boolean' })\n  }\n  opts.push({ label: 'Integer - byte', value: 'integer_1' })\n\n  return opts\n}\n\nexport default defineComponent({\n  setup () {\n    const viewer = inject<Viewer>('viewer')!\n\n    const headerRef = computed(() => (viewer.editHeader.value && reactive(viewer.editHeader.value))!)\n    {\n      let watchStop = null as WatchStopHandle | null\n      watch(headerRef, (value) => {\n        if (watchStop) {\n          watchStop()\n          watchStop = null\n        }\n        if (value) {\n          watchStop = watch(value, () => {\n            triggerRef(viewer.headers)\n            saveHeaders(viewer)\n          }, { deep: true })\n        }\n      })\n    }\n\n    const stats = computed(() => viewer.columnStats.value[headerRef.value.offset])\n\n    const dataType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.array) {\n          return 'array'\n        } else if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return type.key.foreign ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return 'integer'\n        } else if (type.decimal) {\n          return 'decimal'\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = {}\n        if (type === 'array') {\n          header.type.array = true\n          header.type.byteView = { array: true }\n        } else if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer') {\n          header.type.integer = { unsigned: true, size: header.length }\n        } else if (type === 'decimal') {\n          header.type.decimal = { size: header.length }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const arrayType = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.string) {\n          return 'string'\n        } else if (type.key) {\n          return (type.key.foreign) ? 'key_foreign' : 'key_self'\n        } else if (type.integer) {\n          return `integer_${type.integer.size}`\n        } else if (type.decimal) {\n          return `decimal_${type.decimal.size}`\n        } else if (type.boolean) {\n          return 'boolean'\n        } else {\n          return undefined\n        }\n      },\n      set (type) {\n        const header = headerRef.value\n        header.type = { array: true }\n        if (type === 'string') {\n          header.type.string = {}\n        } else if (type === 'key_foreign') {\n          header.type.key = { foreign: true }\n        } else if (type === 'key_self') {\n          header.type.key = { foreign: false }\n        } else if (type === 'integer_1') {\n          header.type.integer = { unsigned: true, size: 1 }\n        } else if (type === 'integer_2') {\n          header.type.integer = { unsigned: true, size: 2 }\n        } else if (type === 'integer_4') {\n          header.type.integer = { unsigned: true, size: 4 }\n        } else if (type === 'integer_8') {\n          header.type.integer = { unsigned: true, size: 8 }\n        } else if (type === 'decimal_4') {\n          header.type.decimal = { size: 4 }\n        } else if (type === 'decimal_8') {\n          header.type.decimal = { size: 8 }\n        } else if (type === 'boolean') {\n          header.type.boolean = {}\n        }\n      }\n    })\n\n    const viewModeOpts = computed(() => {\n      const opts = [] as Array<{ label: string, value: string, disabled?: boolean }>\n      const type = headerRef.value.type\n\n      opts.push({ label: 'Bytes', value: 'bytes' })\n      if (type.array) {\n        opts.push({ label: 'Var. bytes', value: 'array-bytes' })\n      }\n      opts.push({ label: 'Data', value: 'data', disabled: !dataType.value || (dataType.value === 'array' && !arrayType.value) })\n\n      return opts\n    })\n\n    const byteViewMode = computed({\n      get () {\n        const type = headerRef.value.type\n        if (type.byteView) {\n          return type.byteView.array ? 'array-bytes' : 'bytes'\n        } else {\n          return 'data'\n        }\n      },\n      set (mode) {\n        const type = headerRef.value.type\n        if (mode === 'data') {\n          type.byteView = undefined\n        } else {\n          type.byteView = {\n            array: mode === 'array-bytes'\n          }\n        }\n      }\n    })\n\n    function close () {\n      viewer.editHeader.value = null\n    }\n\n    function remove () {\n      removeHeader(headerRef.value, viewer.headers.value)\n      viewer.editHeader.value = null\n      triggerRef(viewer.headers)\n      saveHeaders(viewer)\n    }\n\n    return {\n      isVisible: computed(() => viewer.editHeader.value != null),\n      HEADERS_HEIGHT,\n      header: headerRef,\n      byteViewMode,\n      dataType,\n      arrayType,\n      close,\n      remove,\n      viewModeOpts,\n      dataTypeOpts: computed(() =>\n        dataTypeOpts(headerRef.value, stats.value, viewer.datFile)),\n      arrayTypeOpts: computed(() =>\n        arrayTypeOpts(headerRef.value, stats.value))\n    }\n  }\n})\n","import { render } from \"./HeaderProps.vue?vue&type=template&id=fe336dca&bindings={}\"\nimport script from \"./HeaderProps.vue?vue&type=script&lang=ts\"\nexport * from \"./HeaderProps.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import { BORDER_WIDTH, CHAR_WIDTH, columnSizes } from '../rendering'\nimport type { Header } from '../headers'\nimport type { ColumnStats } from 'pathofexile-dat/dat-analysis'\nimport type { DatFile } from 'pathofexile-dat'\n\nconst BYTE_WIDTH = Math.ceil(CHAR_WIDTH * 3)\n\nexport interface RenderByte {\n  offset: number\n  selected: boolean\n  border: boolean\n  widthPx: number\n  leftPx: number\n  text: string\n  stat?: RenderStat\n}\n\nexport function renderByteCols (\n  selection: readonly boolean[],\n  stats: readonly RenderStat[],\n  headers: readonly Header[],\n  paintBegin: number,\n  paintEnd: number\n): RenderByte[] {\n  const res: RenderByte[] = []\n\n  let left = 0\n  for (const header of headers) {\n    const sizes = columnSizes(header)\n\n    if (header.type.byteView && !header.type.byteView.array) {\n      let textLeft = left\n      for (let i = 0; i < header.length; ++i) {\n        const hasBorder = (sizes.hasBorder && i === 0)\n        const thisWidth = (CHAR_WIDTH * 3) + (hasBorder ? BORDER_WIDTH : 0)\n        if ((Math.ceil(textLeft) + thisWidth) < paintBegin) {\n          textLeft += thisWidth\n          continue\n        }\n\n        const offset = header.offset + i\n        res.push({\n          offset,\n          selected: selection[offset],\n          border: hasBorder,\n          widthPx: BYTE_WIDTH,\n          leftPx: Math.ceil(textLeft),\n          text: String(offset % 100).padStart(2, '0'),\n          stat: stats[offset]\n        })\n\n        textLeft += thisWidth\n        if (Math.ceil(textLeft) >= paintEnd) return res\n      }\n    } else if ((left + sizes.borderWidth) >= paintBegin) {\n      res.push({\n        offset: header.offset,\n        selected: false,\n        border: sizes.hasBorder,\n        widthPx: sizes.paddingWidth,\n        leftPx: left,\n        text: String(header.offset % 100).padStart(2, '0')\n      })\n    }\n\n    left += sizes.borderWidth\n    if (left >= paintEnd) return res\n  }\n\n  return res\n}\n\ninterface RenderStat {\n  max: string\n  array: boolean\n  string: boolean\n  nullable: boolean\n  zero: boolean\n}\n\nexport function renderColStats (stats: ColumnStats[], datFile: DatFile): RenderStat[] {\n  const render = stats.map(stat => ({\n    max: stat.bMax.toString(16).padStart(2, '0'),\n    array: false,\n    string: false,\n    nullable: false,\n    zero: (stat.bMax === 0x00)\n  }))\n\n  const { fieldSize } = datFile\n  for (let idx = 0; idx < stats.length; ++idx) {\n    const stat = stats[idx]\n    if (stat.refString) {\n      for (let k = 0; k < fieldSize.STRING; ++k) {\n        render[idx + k].string = true\n      }\n    }\n    if (stat.refArray) {\n      for (let k = 0; k < fieldSize.ARRAY; ++k) {\n        render[idx + k].array = true\n      }\n    }\n    if (stat.nullableMemsize) {\n      for (let k = 0; k < datFile.memsize; ++k) {\n        render[idx + k].nullable = true\n      }\n    }\n  }\n\n  return render\n}\n","\nimport { defineComponent, PropType, reactive, computed, provide, watch, shallowRef, shallowReactive, ref, render, onMounted } from 'vue'\nimport ResizeObserver from '@/ResizeObserver.vue'\nimport CanvasScroll from '@/CanvasScroll.vue'\nimport { Viewer, createViewer } from '../Viewer'\nimport ViewerActions from './Actions.vue'\nimport ViewerHead from './ViewerHead.vue'\nimport HeaderProps from './HeaderProps.vue'\nimport * as rendering from '../rendering'\nimport { renderByteCols, renderColStats } from '../rendering/byte-columns'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll, ViewerActions, ViewerHead, HeaderProps },\n  emits: ['update:kaState'],\n  props: {\n    args: {\n      type: Object as PropType<{\n        fileContent: Uint8Array\n        fullPath: string\n      }>,\n      required: true\n    },\n    kaState: {\n      type: Object as PropType<Viewer | undefined>,\n      default: undefined\n    }\n  },\n  setup (props, ctx) {\n    let viewer: Viewer\n    if (props.kaState) {\n      viewer = props.kaState // eslint-disable-line vue/no-setup-props-destructure\n    } else {\n      viewer = createViewer(props.args.fullPath, props.args.fileContent)\n      ctx.emit('update:kaState', viewer)\n    }\n    provide('viewer', viewer)\n\n    const canvasRef = ref<HTMLCanvasElement | null>(null)\n\n    const canvasScroll = ref<{ scrollTo(x: number, y: number): void } | null>(null)\n    onMounted(() => {\n      canvasScroll.value!.scrollTo(viewer.scrollPos.x, viewer.scrollPos.y)\n    })\n\n    const rowIndices = computed(() => {\n      if (viewer.rowSorting.value) {\n        return viewer.rowSorting.value\n      } else {\n        return Array.from(\n          { length: viewer.datFile.rowCount },\n          (_, rowIdx) => rowIdx)\n      }\n    })\n\n    const paintWidth = ref(0)\n    const paintHeight = ref(0)\n    function handleResize (sz: { width: number, height: number }) {\n      paintWidth.value = sz.width\n      paintHeight.value = sz.height\n    }\n    const { scrollPos } = viewer\n    function handleScroll (pos: { y: number, x: number }) {\n      scrollPos.x = pos.x\n      scrollPos.y = pos.y\n    }\n\n    const rowsFullWidth = computed(() =>\n      rendering.getRowWidth(viewer.headers.value))\n    const rowsFullHeight = computed(() =>\n      viewer.datFile.rowCount * rendering.LINE_HEIGHT)\n    const rowsOverlayWidth = computed(() =>\n      rendering.rowsOverlayWidth(viewer.datFile.rowCount))\n    const rowsWidth = computed(() =>\n      Math.max(0, paintWidth.value - rowsOverlayWidth.value))\n    const rowsHeight = computed(() =>\n      Math.max(0, paintHeight.value - rendering.HEADERS_HEIGHT))\n\n    watch([rowsWidth, rowsHeight], () => {\n      const dpr = devicePixelRatio\n\n      canvasRef.value!.style.width = rowsWidth.value + 'px'\n      canvasRef.value!.style.height = rowsHeight.value + 'px'\n\n      canvasRef.value!.width = rowsWidth.value * dpr\n      canvasRef.value!.height = rowsHeight.value * dpr\n\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n      ctx.scale(dpr, dpr)\n\n      draw()\n    })\n\n    const renderStats = computed(() =>\n      renderColStats(viewer.columnStats.value, viewer.datFile))\n\n    const renderColumns = computed(() =>\n      renderByteCols(\n        viewer.columnSelection.value,\n        renderStats.value,\n        viewer.headers.value,\n        scrollPos.x,\n        scrollPos.x + Math.min(rowsFullWidth.value, rowsWidth.value))\n    )\n\n    watch([scrollPos, renderColumns, rowIndices], () => { draw() })\n\n    function draw () {\n      const ctx = canvasRef.value!.getContext('2d', { alpha: false })!\n\n      rendering.drawRows({\n        left: scrollPos.x,\n        paintWidth: rowsWidth.value,\n        top: renderItems.value.top,\n        rows: renderItems.value.ids,\n        columns: renderColumns.value,\n        viewer: viewer,\n        ctx\n      })\n    }\n\n    const renderItems = computed(() => {\n      const scrollTop = scrollPos.y\n\n      const count = Math.ceil(rowsHeight.value / rendering.LINE_HEIGHT) + 1\n      const startIdx = Math.floor(scrollTop / rendering.LINE_HEIGHT)\n\n      const top = (startIdx * rendering.LINE_HEIGHT) - scrollTop\n\n      return {\n        top,\n        ids: rowIndices.value.slice(startIdx, startIdx + count)\n      }\n    })\n\n    return {\n      headerBlockStyle: computed(() =>\n        ({ height: rendering.HEADERS_HEIGHT + 'px', width: paintWidth.value + 'px' })),\n      headerOverlayContentStyle: computed(() =>\n        ({ left: rowsOverlayWidth.value + 'px', height: rendering.HEADERS_HEIGHT + 'px', width: rowsWidth.value + 'px' })),\n      scrollableStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', left: rowsOverlayWidth.value + 'px' })),\n      scrollablePaintSize: computed(() =>\n        ({ width: rowsWidth.value, height: rowsHeight.value })),\n      scrollableFullSize: computed(() =>\n        ({ width: rowsFullWidth.value, height: rowsFullHeight.value })),\n      rowsOverlayStyle: computed(() =>\n        ({ top: rendering.HEADERS_HEIGHT + 'px', width: rowsOverlayWidth.value + 'px', height: rowsHeight.value + 'px', fontFamily: rendering.FONT_FAMILY, fontSize: rendering.FONT_SIZE + 'px', lineHeight: rendering.LINE_HEIGHT + 'px' })),\n      handleScroll,\n      handleResize,\n      renderItems,\n      canvasRef,\n      renderColumns,\n      scrollLeft: computed(() => scrollPos.x),\n      rowsWidth: computed(() => Math.min(rowsFullWidth.value, rowsWidth.value)),\n      LINE_HEIGHT: rendering.LINE_HEIGHT,\n      canvasScroll,\n      rowsNumberWidth: (rendering.rowsNumWidth(viewer.datFile.rowCount) + 'px')\n    }\n  }\n})\n","import { render } from \"./DatViewer.vue?vue&type=template&id=787408c3&bindings={}\"\nimport script from \"./DatViewer.vue?vue&type=script&lang=ts\"\nexport * from \"./DatViewer.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./DatViewer.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","\nimport { defineComponent, ref } from 'vue'\nimport { fetchFile, progress } from '../patchcdn/cache'\nimport { loadIndex, loadFileContent, index } from '../patchcdn/index-store'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\n\nexport default defineComponent({\n  setup () {\n    const poePatch = ref(localStorage.getItem('POE_PATCH_VER') || '')\n    const isCdnImportRunning = ref(false)\n\n    if (poePatch.value && !index.value) {\n      cdnImport()\n    }\n\n    async function handleFile (e: Event) {\n      const elFile = (e.target as HTMLInputElement).files![0]\n      const fileContent = new Uint8Array(await elFile.arrayBuffer())\n      const fileName = elFile.name\n      openTab({\n        id: `file@${fileName}`,\n        title: fileName,\n        type: DatViewer,\n        args: {\n          fileContent,\n          fullPath: fileName\n        }\n      })\n    }\n\n    async function cdnImport () {\n      let bundle\n      try {\n        isCdnImportRunning.value = true\n        bundle = await fetchFile(poePatch.value, '_.index.bin')\n      } finally {\n        isCdnImportRunning.value = false\n      }\n\n      try {\n        await loadIndex(bundle)\n        localStorage.setItem('POE_PATCH_VER', poePatch.value)\n      } catch (e) {\n        window.alert(e.message)\n        throw e\n      }\n    }\n\n    return {\n      poePatch,\n      isCdnImportRunning,\n      handleFile,\n      cdnImport\n    }\n  }\n})\n","import { render } from \"./ImportDialog.vue?vue&type=template&id=1b52d566&bindings={}\"\nimport script from \"./ImportDialog.vue?vue&type=script&lang=ts\"\nexport * from \"./ImportDialog.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./ImportDialog.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","import { shallowRef, shallowReactive, DefineComponent, triggerRef } from 'vue'\nimport ImportDialog from './ImportDialog.vue'\n\ninterface Tab {\n  id: string\n  title: string\n  type: DefineComponent\n  args: unknown\n  kaState: unknown\n}\n\nexport const activeTabId = shallowRef<string | null>('poe-dat-viewer@import')\n\nexport function setActiveTab (id: string | null) {\n  activeTabId.value = id\n}\n\nexport const tabs = shallowRef<Tab[]>([\n  {\n    id: 'poe-dat-viewer@import',\n    title: 'Import',\n    type: ImportDialog as any, // eslint-disable-line @typescript-eslint/no-explicit-any\n    args: undefined,\n    kaState: undefined\n  }\n])\n\ninterface OpenTabParams {\n  id: string\n  title: string\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  type: any // vue.DefineComponent\n  args: unknown\n}\n\nexport function openTab (params: OpenTabParams) {\n  const existing = tabs.value.find(tab => tab.id === params.id)\n  if (!existing) {\n    tabs.value.push({\n      id: params.id,\n      title: params.title,\n      type: params.type,\n      args: params.args,\n      kaState: undefined\n    })\n  }\n  setActiveTab(params.id)\n  triggerRef(tabs)\n}\n\nexport function closeTab (id: string) {\n  const idx = tabs.value.findIndex(tab => tab.id === id)\n  if (id === activeTabId.value) {\n    if ((idx + 1) < tabs.value.length) {\n      setActiveTab(tabs.value[idx + 1].id)\n    } else if (idx !== 0) {\n      setActiveTab(tabs.value[idx - 1].id)\n    } else {\n      setActiveTab(null)\n    }\n  }\n  tabs.value = tabs.value.filter(tab => tab.id !== id)\n}\n","\nimport { defineComponent, computed } from 'vue'\nimport { tabs, activeTabId, setActiveTab, closeTab, openTab } from './workbench-core'\nimport ImportDialog from './ImportDialog.vue'\n\nexport default defineComponent({\n  setup () {\n    const _tabs = computed(() =>\n      tabs.value.map(tab => ({\n        id: tab.id,\n        title: tab.title,\n        isActive: (tab.id === activeTabId.value)\n      }))\n    )\n\n    function openImport () {\n      openTab({\n        id: 'poe-dat-viewer@import',\n        title: 'Import',\n        type: ImportDialog,\n        args: undefined\n      })\n    }\n\n    return {\n      tabs: _tabs,\n      setActiveTab,\n      closeTab,\n      openImport\n    }\n  }\n})\n","import { render } from \"./Tabs.vue?vue&type=template&id=f18d1614&bindings={}\"\nimport script from \"./Tabs.vue?vue&type=script&lang=ts\"\nexport * from \"./Tabs.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./Tabs.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div class=\"layout-column flex-shrink-0\" :style=\"{ 'width': showTree ? '300px' : undefined }\">\n    <div class=\"flex p-1 items-center mb-px\">\n      <button\n        title=\"Toggle tree visibility\"\n        :class=\"$style.treeToggle\"\n        @click=\"toggleTree\"\n        ><i class=\"codicon codicon-list-flat\"></i></button>\n      <input v-if=\"showTree\"\n        v-model.trim=\"searchText\"\n        placeholder=\"Search in current folder\"\n        :class=\"$style.searchInput\"\n        type=\"search\" spellcheck=\"false\">\n    </div>\n    <template v-if=\"showTree\">\n      <div v-if=\"extensionOpts\"\n        class=\"flex gap-x-1 border-b pb-1.5 px-2 justify-end\">\n        <button v-for=\"opt in extensionOpts\" :key=\"opt.value\"\n          @click=\"opt.handleClick\"\n          :class=\"['px-2', (opt.active ? 'bg-gray-300' : 'hover:bg-gray-200') ]\"\n          v-text=\"opt.value\" />\n      </div>\n      <div v-if=\"!isIndexLoaded\"\n        class=\"italic text-center text-gray-600 p-2\">Waiting for Index bundle...</div>\n      <div v-if=\"isIndexLoaded && !tree.length\"\n        class=\"italic text-center text-gray-600 p-2\">No results found</div>\n      <virtual-scroll\n        class=\"flex-1\"\n        :scrollable-props=\"{ style: 'background: #fff;', widthY: 10 }\"\n        :items=\"tree\"\n        :item-height=\"22\"\n      >\n        <template v-slot=\"props\">\n          <button v-for=\"entry in props.entries\" :key=\"entry.item.fullPath\"\n            :class=\"$style.itemBtn\"\n            :style=\"{ transform: `translate(0, ${entry.top}px` }\"\n            @click=\"handleTreeNav(entry.item)\"\n          >\n            <i v-if=\"!entry.item.isFile\" class=\"codicon codicon-folder pr-3\"></i\n            >{{ entry.item.label }}</button>\n        </template>\n      </virtual-scroll>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, shallowRef, computed, watch } from 'vue'\nimport FileSaver from 'file-saver'\nimport VirtualScroll from '@/VirtualScroll.vue'\nimport { getRootDirs, getDirContent } from 'pathofexile-dat/bundles/index-paths'\nimport { index, loadFileContent } from '../patchcdn/index-store'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\nimport * as perf from '../../perf'\n\ninterface TreeItem {\n  label: string\n  fullPath: string\n  isFile: boolean\n}\n\nfunction useTreeNavigation () {\n  const currentDir = shallowRef('')\n\n  watch(index, () => {\n    currentDir.value = ''\n  })\n\n  const tree = computed<TreeItem[]>(() => {\n    if (!index.value) return []\n\n    if (currentDir.value === '') {\n      const dirs = perf.fn('Getting root dirs', () =>\n        getRootDirs(index.value!.pathReps, index.value!.dirsInfo))\n\n      return dirs.map(dirName => ({\n        label: dirName,\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    }\n\n    const content = perf.fn(`Getting \"${currentDir.value}\" dir`, () =>\n      getDirContent(currentDir.value, index.value!.pathReps, index.value!.dirsInfo))\n\n    return [\n      {\n        label: '../',\n        fullPath: (currentDir.value.indexOf('/') === -1)\n          ? ''\n          : currentDir.value.split('/').slice(0, -1).join('/'),\n        isFile: false\n      },\n      ...content.dirs.map(dirName => ({\n        label: dirName.substr(currentDir.value.length + 1),\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label)),\n      ...content.files.map(fileName => ({\n        label: fileName.substr(currentDir.value.length + 1),\n        fullPath: fileName,\n        isFile: true\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    ]\n  })\n\n  async function handleTreeNav (item: TreeItem) {\n    if (!item.isFile) {\n      currentDir.value = item.fullPath\n    } else {\n      const fileContent = await loadFileContent(item.fullPath)\n\n      if (item.fullPath.endsWith('.dat') || item.fullPath.endsWith('.dat64')) {\n        openTab({\n          id: `bundles@${item.fullPath}`,\n          title: item.label,\n          type: DatViewer,\n          args: {\n            fileContent,\n            fullPath: item.fullPath\n          }\n        })\n      } else {\n        FileSaver.saveAs(new File(\n          [fileContent],\n          item.fullPath.substring(item.fullPath.lastIndexOf('/') + 1),\n          { type: 'application/octet-stream' }\n        ))\n      }\n    }\n  }\n\n  return {\n    currentDir,\n    tree,\n    handleTreeNav\n  }\n}\n\nexport default defineComponent({\n  components: { VirtualScroll },\n  setup () {\n    const showTree = shallowRef(true)\n    function toggleTree () {\n      showTree.value = !showTree.value\n    }\n\n    const isIndexLoaded = computed(() => {\n      return Boolean(index.value)\n    })\n\n    const { tree, handleTreeNav, currentDir } = useTreeNavigation()\n\n    const searchExtension = shallowRef('.dat64')\n    const extensionOpts = computed(() => {\n      if (!currentDir.value.startsWith('Data')) return null\n\n      return ['.dat', '.dat64', '.datl', '.datl64'].map(ext => ({\n        value: ext,\n        active: searchExtension.value === ext,\n        handleClick: () => { searchExtension.value = ext }\n      }))\n    })\n\n    const searchText = shallowRef('')\n    const filteredTree = computed(() => {\n      const term = searchText.value.toLowerCase()\n      const ext = extensionOpts.value ? searchExtension.value : ''\n      return tree.value.filter(item => {\n        return item.label.toLowerCase().includes(term) &&\n          (item.isFile ? item.label.endsWith(ext) : true)\n      })\n    })\n\n    return {\n      showTree,\n      toggleTree,\n      tree: filteredTree,\n      handleTreeNav,\n      searchText,\n      isIndexLoaded,\n      extensionOpts\n    }\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.treeToggle {\n  @apply p-1;\n  @apply m-1;\n  line-height: 1;\n\n  &:hover {\n    @apply bg-gray-200;\n  }\n}\n\n.searchInput {\n  @apply h-7;\n  @apply border;\n  box-sizing: content-box;\n  @apply flex-1;\n  @apply mx-1;\n  @apply px-1 py-px;\n\n  &:focus {\n    @apply border-blue-500;\n  }\n}\n\n.itemBtn {\n  position: absolute;\n  line-height: 22px;\n  @apply px-3;\n  text-align: left;\n  @apply truncate;\n  width: 100%;\n\n  &:hover {\n    @apply bg-gray-200;\n  }\n}\n</style>\n","<template>\n  <resize-observer @resize=\"handleResize\" class=\"relative\">\n    <canvas-scroll ref=\"scrollable\"\n      v-bind=\"scrollableProps\"\n      class=\"absolute\"\n      :paint-size=\"paintSize\"\n      :full-size=\"fullSize\"\n    >\n      <slot :entries=\"renderItems\" />\n    </canvas-scroll>\n  </resize-observer>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, computed, shallowReactive, ref } from 'vue'\nimport ResizeObserver from './ResizeObserver.vue'\nimport CanvasScroll from './CanvasScroll.vue'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll },\n  props: {\n    items: {\n      type: Array,\n      required: true\n    },\n    itemHeight: {\n      type: Number,\n      required: true\n    },\n    scrollableProps: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  setup (props) {\n    const paintSize = shallowReactive({\n      width: 0,\n      height: 0\n    })\n\n    const fullSize = computed(() => ({\n      width: paintSize.width,\n      height: props.items.length * props.itemHeight\n    }))\n\n    function handleResize (sz: { width: number, height: number }) {\n      paintSize.width = sz.width\n      paintSize.height = sz.height\n    }\n\n    const scrollable = ref<{ scrollPos: { y: number } } | null>(null)\n\n    const renderItems = computed(() => {\n      const scrollTop = (scrollable.value?.scrollPos.y ?? 0)\n\n      const count = Math.ceil(paintSize.height / props.itemHeight) + 1\n      const startIdx = Math.floor(scrollTop / props.itemHeight)\n\n      const top = (startIdx * props.itemHeight) - scrollTop\n\n      return props.items\n        .slice(startIdx, startIdx + count)\n        .map((item, i) =>\n          ({\n            top: top + (i * props.itemHeight),\n            item\n          })\n        )\n    })\n\n    return {\n      handleResize,\n      paintSize,\n      fullSize,\n      scrollable,\n      renderItems\n    }\n  }\n})\n</script>\n","\nimport { defineComponent, computed, shallowReactive, ref } from 'vue'\nimport ResizeObserver from './ResizeObserver.vue'\nimport CanvasScroll from './CanvasScroll.vue'\n\nexport default defineComponent({\n  components: { ResizeObserver, CanvasScroll },\n  props: {\n    items: {\n      type: Array,\n      required: true\n    },\n    itemHeight: {\n      type: Number,\n      required: true\n    },\n    scrollableProps: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  setup (props) {\n    const paintSize = shallowReactive({\n      width: 0,\n      height: 0\n    })\n\n    const fullSize = computed(() => ({\n      width: paintSize.width,\n      height: props.items.length * props.itemHeight\n    }))\n\n    function handleResize (sz: { width: number, height: number }) {\n      paintSize.width = sz.width\n      paintSize.height = sz.height\n    }\n\n    const scrollable = ref<{ scrollPos: { y: number } } | null>(null)\n\n    const renderItems = computed(() => {\n      const scrollTop = (scrollable.value?.scrollPos.y ?? 0)\n\n      const count = Math.ceil(paintSize.height / props.itemHeight) + 1\n      const startIdx = Math.floor(scrollTop / props.itemHeight)\n\n      const top = (startIdx * props.itemHeight) - scrollTop\n\n      return props.items\n        .slice(startIdx, startIdx + count)\n        .map((item, i) =>\n          ({\n            top: top + (i * props.itemHeight),\n            item\n          })\n        )\n    })\n\n    return {\n      handleResize,\n      paintSize,\n      fullSize,\n      scrollable,\n      renderItems\n    }\n  }\n})\n","import { render } from \"./VirtualScroll.vue?vue&type=template&id=315fb3d7&bindings={}\"\nimport script from \"./VirtualScroll.vue?vue&type=script&lang=ts\"\nexport * from \"./VirtualScroll.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\nexport function start () {\n  return Date.now()\n}\n\nexport function end (desc: string, start: number) {\n  const end = Date.now() - start\n  console.log(`${desc}. Done in -> ${end} ms`)\n}\n\nexport function fn<T> (desc: string, cb: () => T): T {\n  const t$ = start()\n  const res = cb()\n  end(desc, t$)\n  return res\n}\n","\nimport { defineComponent, shallowRef, computed, watch } from 'vue'\nimport FileSaver from 'file-saver'\nimport VirtualScroll from '@/VirtualScroll.vue'\nimport { getRootDirs, getDirContent } from 'pathofexile-dat/bundles/index-paths'\nimport { index, loadFileContent } from '../patchcdn/index-store'\nimport { openTab } from './workbench-core'\nimport DatViewer from '../dat-viewer/components/DatViewer.vue'\nimport * as perf from '../../perf'\n\ninterface TreeItem {\n  label: string\n  fullPath: string\n  isFile: boolean\n}\n\nfunction useTreeNavigation () {\n  const currentDir = shallowRef('')\n\n  watch(index, () => {\n    currentDir.value = ''\n  })\n\n  const tree = computed<TreeItem[]>(() => {\n    if (!index.value) return []\n\n    if (currentDir.value === '') {\n      const dirs = perf.fn('Getting root dirs', () =>\n        getRootDirs(index.value!.pathReps, index.value!.dirsInfo))\n\n      return dirs.map(dirName => ({\n        label: dirName,\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    }\n\n    const content = perf.fn(`Getting \"${currentDir.value}\" dir`, () =>\n      getDirContent(currentDir.value, index.value!.pathReps, index.value!.dirsInfo))\n\n    return [\n      {\n        label: '../',\n        fullPath: (currentDir.value.indexOf('/') === -1)\n          ? ''\n          : currentDir.value.split('/').slice(0, -1).join('/'),\n        isFile: false\n      },\n      ...content.dirs.map(dirName => ({\n        label: dirName.substr(currentDir.value.length + 1),\n        fullPath: dirName,\n        isFile: false\n      })).sort((a, b) => a.label.localeCompare(b.label)),\n      ...content.files.map(fileName => ({\n        label: fileName.substr(currentDir.value.length + 1),\n        fullPath: fileName,\n        isFile: true\n      })).sort((a, b) => a.label.localeCompare(b.label))\n    ]\n  })\n\n  async function handleTreeNav (item: TreeItem) {\n    if (!item.isFile) {\n      currentDir.value = item.fullPath\n    } else {\n      const fileContent = await loadFileContent(item.fullPath)\n\n      if (item.fullPath.endsWith('.dat') || item.fullPath.endsWith('.dat64')) {\n        openTab({\n          id: `bundles@${item.fullPath}`,\n          title: item.label,\n          type: DatViewer,\n          args: {\n            fileContent,\n            fullPath: item.fullPath\n          }\n        })\n      } else {\n        FileSaver.saveAs(new File(\n          [fileContent],\n          item.fullPath.substring(item.fullPath.lastIndexOf('/') + 1),\n          { type: 'application/octet-stream' }\n        ))\n      }\n    }\n  }\n\n  return {\n    currentDir,\n    tree,\n    handleTreeNav\n  }\n}\n\nexport default defineComponent({\n  components: { VirtualScroll },\n  setup () {\n    const showTree = shallowRef(true)\n    function toggleTree () {\n      showTree.value = !showTree.value\n    }\n\n    const isIndexLoaded = computed(() => {\n      return Boolean(index.value)\n    })\n\n    const { tree, handleTreeNav, currentDir } = useTreeNavigation()\n\n    const searchExtension = shallowRef('.dat64')\n    const extensionOpts = computed(() => {\n      if (!currentDir.value.startsWith('Data')) return null\n\n      return ['.dat', '.dat64', '.datl', '.datl64'].map(ext => ({\n        value: ext,\n        active: searchExtension.value === ext,\n        handleClick: () => { searchExtension.value = ext }\n      }))\n    })\n\n    const searchText = shallowRef('')\n    const filteredTree = computed(() => {\n      const term = searchText.value.toLowerCase()\n      const ext = extensionOpts.value ? searchExtension.value : ''\n      return tree.value.filter(item => {\n        return item.label.toLowerCase().includes(term) &&\n          (item.isFile ? item.label.endsWith(ext) : true)\n      })\n    })\n\n    return {\n      showTree,\n      toggleTree,\n      tree: filteredTree,\n      handleTreeNav,\n      searchText,\n      isIndexLoaded,\n      extensionOpts\n    }\n  }\n})\n","import { render } from \"./IndexTree.vue?vue&type=template&id=0d809252&bindings={}\"\nimport script from \"./IndexTree.vue?vue&type=script&lang=ts\"\nexport * from \"./IndexTree.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./IndexTree.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <div v-if=\"active\" :class=\"$style.notification\">\n    <template v-if=\"totalSize\">\n      <div class=\"bg-gray-300 h-1\"></div>\n      <div class=\"bg-blue-500 h-1 absolute top-0\"\n        :style=\"{ width: `${received/totalSize * 100}%` }\"></div>\n    </template>\n    <div class=\"p-3\">\n      <div class=\"font-semibold truncate\">{{ bundleName }}</div>\n      <div class=\"text-grey text-sm\">\n        <template v-if=\"totalSize\">{{ (totalSize / 1000000).toFixed(1) }} MB</template>\n        <template v-else>Downloading...</template>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { progress } from '../patchcdn/cache'\n\nexport default defineComponent({\n  setup () {\n    return progress\n  }\n})\n</script>\n\n<style lang=\"postcss\" module>\n.notification {\n  position: fixed;\n  bottom: 0;\n  right: 0;\n  width: 20rem;\n  @apply bg-gray-100;\n  @apply m-6;\n  @apply shadow;\n  @apply border;\n  @apply text-base;\n}\n</style>\n","\nimport { defineComponent } from 'vue'\nimport { progress } from '../patchcdn/cache'\n\nexport default defineComponent({\n  setup () {\n    return progress\n  }\n})\n","import { render } from \"./DownloadProgress.vue?vue&type=template&id=1532fec4&bindings={}\"\nimport script from \"./DownloadProgress.vue?vue&type=script&lang=ts\"\nexport * from \"./DownloadProgress.vue?vue&type=script&lang=ts\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./DownloadProgress.vue?vue&type=style&index=0&lang=postcss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","\nimport { defineComponent, computed } from 'vue'\nimport ViewerTabs from './Tabs.vue'\nimport IndexTree from './IndexTree.vue'\nimport DownloadProgress from './DownloadProgress.vue'\nimport { tabs, activeTabId } from './workbench-core'\n\nexport default defineComponent({\n  components: { IndexTree, ViewerTabs, DownloadProgress },\n  setup () {\n    const activeTab = computed(() =>\n      tabs.value.find(tab => tab.id === activeTabId.value)\n    )\n\n    return {\n      activeTab,\n      appVersion: process.env.APP_VERSION\n    }\n  }\n})\n","import { render } from \"./Workbench.vue?vue&type=template&id=318cac7c&bindings={}\"\nimport script from \"./Workbench.vue?vue&type=script&lang=ts\"\nexport * from \"./Workbench.vue?vue&type=script&lang=ts\"\n\nimport \"./Workbench.vue?vue&type=style&index=0&lang=postcss\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue'\nimport Workbench from './app/workbench/Workbench.vue'\n\ncreateApp(Workbench).mount('#app')\n","export { default } from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DatViewer.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DatViewer.vue?vue&type=style&index=0&lang=postcss&module=true\"","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DownloadProgress.vue?vue&type=style&index=0&lang=postcss&module=true\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DownloadProgress.vue?vue&type=style&index=0&lang=postcss&module=true\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"rowsOverlay\":\"DatViewer_rowsOverlay_kP3aC\",\"canvasShadow\":\"DatViewer_canvasShadow_1Eo-r\"};"],"sourceRoot":""}