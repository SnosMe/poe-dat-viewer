var gt=Object.defineProperty,bt=Object.defineProperties;var wt=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var _t=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var Te=(e,t,n)=>t in e?gt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ae=(e,t)=>{for(var n in t||(t={}))_t.call(t,n)&&Te(e,n,t[n]);if(Ce)for(var n of Ce(t))$t.call(t,n)&&Te(e,n,t[n]);return e},oe=(e,t)=>bt(e,wt(t));import{r as Me,w as St,t as ve,s as $,o as kt,p as Y,d as xt,b as ye,a as ie,c as z,e as q,f as ze,g as Ct,h as me,i as K,j as Re,k as p,l as ge,m as j,n as g,q as Tt,u as y,v as b,x,y as r,z as w,A as V,B as Mt,C as zt,D as _,E as be,F as Ee,G as S,H as R,I as T,J as Ie,K as Le,L as A,M as re,N as Rt,O as Pe,P as He,Q as Et,R as L,S as D,T as It,U as Lt,V as Pt,W as Ht,X as Dt,Y as Ft}from"./vendor.aac6e6e4.js";const Ot=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}};Ot();const At="Bundles2",F=Me({totalSize:0,received:0,active:!1,bundleName:""});async function we(e,t){if(e==null&&(e=localStorage.getItem("POE_PATCH_VER"),!e))throw new Error("never");try{return await Bt(e,t)}catch(n){throw window.alert("You may need to adjust the patch version."),n}}async function Bt(e,t){const n=`${e}/${At}/${t}`;let l=await caches.open("bundles"),a=await l.match(n);if(!a){if(F.totalSize=0,F.received=0,F.active=!0,F.bundleName=t,a=await fetch(`https://poe-bundles.snos.workers.dev/${n}`),a.status!==200)throw F.active=!1,new Error(`patchcdn: ${a.status} ${a.statusText}`);F.totalSize=Number(a.headers.get("content-length"));let o;try{const s=a.body.getReader(),i=[];for(;;){const{done:d,value:h}=await s.read();if(d)break;i.push(h),F.received+=h.length}o=new Uint8Array(F.received);let f=0;for(const d of i)o.set(d,f),f+=d.length}finally{F.active=!1}return localStorage.getItem("POE_PATCH_VER")!==e&&(await caches.delete("bundles"),l=await caches.open("bundles")),await l.put(n,new Response(o,{headers:{"content-length":String(o.byteLength),"content-type":"application/octet-stream"}})),o.buffer}return await a.arrayBuffer()}function Vt(){return new Worker("/poe-dat-viewer/assets/script.aed4df77.js",{type:"module"})}const de=St(new Vt);async function De(e){return await de.decompressSliceInBundle(ve(e,[e]))}async function Fe(e,t,n){return await de.decompressSliceInBundle(ve(e,[e]),t,n)}async function _e(e,t){return await de.analyzeDatFile(ve(e,(t==null?void 0:t.transfer)?[e.dataFixed.buffer]:[]))}async function Wt(e,t,n){return await de.getBatchFileInfo(e,t,n)}const ue=$([]),$e=kt("poe-dat-viewer",3,{upgrade(e){e.createObjectStore("dat-schemas",{keyPath:"name"})}});async function ce(e){const t=await(await $e).get("dat-schemas",e);return(t==null?void 0:t.headers)||Gt(e)||[]}async function Nt(e,t){await(await $e).put("dat-schemas",{name:e,headers:jt(t)})}async function Yt(e){await(await $e).delete("dat-schemas",e)}function jt(e){return e.map(t=>oe(ae({},t),{length:t.type.string||t.type.array||t.type.key||t.type.boolean||t.type.decimal||t.type.integer?void 0:t.length}))}function Gt(e){const t=ue.value.find(n=>n.name===e);return t?t.columns.map(n=>{var l,a;return{name:n.name||"",type:{array:n.array,byteView:n.type==="array"?{array:!0}:void 0,integer:n.type==="i32"?{unsigned:!1,size:4}:n.type==="enumrow"?{unsigned:!1,size:4}:void 0,decimal:n.type==="f32"?{size:4}:void 0,string:n.type==="string"?{}:void 0,boolean:n.type==="bool"?{}:void 0,key:n.type==="row"||n.type==="foreignrow"?{foreign:n.type==="foreignrow",table:(a=(l=n.references)==null?void 0:l.table)!=null?a:null,viewColumn:null}:void 0},textLength:4*3-1}}):null}function Ut(e,t){for(let n=e.offset;n<e.offset+e.length;++n)t[n]=!0}function Oe(e,t,n,l){const a=Math.min(t,n),o=Math.max(t,n);l=l.filter(s=>s.type.byteView&&!s.type.byteView.array);for(let s=a;s<=o;++s)l.some(i=>s>=i.offset&&s<i.offset+i.length)&&(e[s]=!e[s])}function Ae(e){e.fill(!1)}function Be(e){const t=[];let n=e.indexOf(!0),l;if(n<0)return t;for(l=n,t.push([l]),n+=1;n<e.length;++n)if(e[n]){const a=n;a-l==1?t[t.length-1].push(a):t.push([a]),l=a}return t}const G=()=>({byteView:{array:!1}});function Xt(e,t){for(let n=0;n<t.length;){const l=t[n];l.name!=null&&e.some(a=>a>=l.offset&&a<l.offset+l.length)?We(l,t):n+=1}}function Ve(e,t){const n=Be(e);if(n.length===0)throw new Error("No bytes selected");if(n.length>1)throw new Error("Cannot create header from non-contiguous selection");const l=n[0];Xt(l,t);const a=t.find(i=>l[0]>=i.offset&&l[0]+l.length<=i.offset+i.length);let o=[{name:null,offset:a.offset,length:l[0]-a.offset,type:G()},{name:"",offset:l[0],length:l.length,type:G(),textLength:4*3-1},{name:null,offset:l[0]+l.length,length:a.length-(l[0]-a.offset+l.length),type:G()}];const s=o[1];return o=o.filter(i=>i.length),t.splice(t.indexOf(a),1,...o),s}function We(e,t){if(e.name==null)throw new Error("Cannot remove empty header");e.name=null,e.type=G();for(let n=0;n<t.length-1;){const l=qt(t[n],t[n+1]);l?t.splice(n,2,l):n+=1}}function qt(e,t){return e.name===null&&t.name===null?{name:null,offset:e.offset,length:e.length+t.length,type:G()}:null}function Ne(e,t,n){const l=[];let a=0;for(const o of e){if(o.name==null||o.length)return null;const s=Y.getHeaderLength(o,n),i=oe(ae({},o),{length:s,offset:a});if(xt.validateHeader(i,t))l.push(i),a+=s;else return null}return{headers:l,increasedRowLength:a<n.rowLength}}const k=$(null);async function Ye(e){const t=ye.getFileInfo(e,k.value.bundlesInfo,k.value.filesInfo),n=await we(null,t.bundle),{slice:l}=await Fe(n.slice(0),t.offset,t.size);return l}async function Kt(e){const{slice:t}=await De(e),n=ye.readIndexBundle(t),{slice:l}=await De(n.pathRepsBundle.slice().buffer);k.value={bundlesInfo:n.bundlesInfo,filesInfo:n.filesInfo,dirsInfo:n.dirsInfo,pathReps:l,tableStats:ie([])}}async function Jt(e){const t=ye.getDirContent("Data",k.value.pathReps,k.value.dirsInfo).files.filter(a=>a.endsWith(".dat64"));e.value=t.length;const l=(await Wt(t,k.value.bundlesInfo,k.value.filesInfo)).reduce((a,o,s)=>{const i=a.find(d=>d.name===o.bundle),f=t[s];return i?i.files.push({fullPath:f,location:o}):a.push({name:o.bundle,files:[{fullPath:t[s],location:o}]}),a},[]);for(const a of l){let o=await we(null,a.name);for(const{fullPath:s,location:i}of a.files){const f=await Fe(o,i.offset,i.size);o=f.bundle;const d=Y.readDatFile(s,f.slice),h=await _e(d,{transfer:!0}),c=s.replace("Data/","").replace(".dat64",""),v=await ce(c),u=Ne(v,h,d);k.value.tableStats.push({name:c,totalRows:d.rowCount,headersValid:u!=null,increasedRowLength:u?u.increasedRowLength:!1})}}}var E=(e,t)=>{for(const[n,l]of t)e[n]=l;return e};const Zt=z({props:{tag:{type:String,default:"div"}},emits:["resize"],setup(e,t){const n=q(null);return ze(()=>{const l=new ResizeObserver(a=>{t.emit("resize",{width:a[0].contentRect.width,height:a[0].contentRect.height})});l.observe(n.value),Ct(()=>{l.unobserve(n.value)})}),{rootEl:n}}});function Qt(e,t,n,l,a,o){return p(),me(Re(e.tag),{ref:"rootEl","data-role":"resize-observer"},{default:K(()=>[ge(e.$slots,"default")]),_:3},512)}var je=E(Zt,[["render",Qt]]);const en="_scrollable_66dfd_2",tn="_track_66dfd_8",nn="_y_66dfd_11",sn="_x_66dfd_12",ln="_thumb_66dfd_15";var an={scrollable:en,track:tn,y:nn,x:sn,thumb:ln};const on=40,Ge=15,rn=100,Ue=(e,t)=>Math.max(1,Math.pow(e*(3/1e3)*t,2))*Math.sign(e);function Xe(e,t,n,l,a){var d;if(n<=t)return null;const o=Math.max(0,t-((d=l==null?void 0:l.fixedSize)!=null?d:0)),s=Math.max(on,Math.floor(t*o/n)),i=(o-s)/(n-t),f=Math.round(a*i);return{trackSize:o,thumbSize:s,fixedSize:e,thumbRatio:i,thumbPos:f}}function dn(e){let t=0,n=0,l=0,a=0,o=null,s=0,i=0;function f(v){v.button===1&&(v.preventDefault(),v.stopPropagation(),document.body.style.cursor="all-scroll",o=null,t=v.clientY,n=v.clientX,l=0,a=0,s=0,i=requestAnimationFrame(c),document.addEventListener("mousemove",h),document.addEventListener("mouseup",d),document.addEventListener("mouseleave",d))}function d(){cancelAnimationFrame(i),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",d),document.removeEventListener("mouseleave",d),document.body.style.removeProperty("cursor")}function h(v){const u=v.clientY-t,m=v.clientX-n;if(o===null)if(Math.abs(u)>Ge)o="vertical",document.body.style.cursor="ns-resize";else if(Math.abs(m)>Ge)o="horizontal",document.body.style.cursor="ew-resize";else return;o==="vertical"?l=u:a=m}function c(v){const u=v-(s||v);s=v,i=requestAnimationFrame(c),e(Ue(a,u),Ue(l,u))}return{handleMousedown:f}}function un(e){function t(n){e(0,Math.sign(n.deltaY)*rn)}return{handleMousewheel:t}}function qe(e,t,n){let l=0,a=0;const o=t==="y"?"y":"x",s=t==="y"?"clientY":"clientX";function i(h){h.preventDefault(),h.stopPropagation();const c=h.currentTarget;if(l=c.getBoundingClientRect()[o],h.target!==c){const v=h.target;a=h[s]-v.getBoundingClientRect()[o]}else a=e.value.thumbSize/2,f(h),a=h[s]-l-e.value.thumbPos;document.addEventListener("mousemove",f),document.addEventListener("mouseup",d),document.addEventListener("mouseleave",d)}function f(h){const c=(h[s]-l-a)/e.value.thumbRatio;t==="x"?n(c,void 0):n(void 0,c)}function d(){document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",d),document.removeEventListener("mouseleave",d)}return{handleTrackMousedown:i}}const cn=z({props:{paintSize:{type:Object,required:!0},fullSize:{type:Object,required:!0},widthY:{type:Number,default:14},widthX:{type:Number,default:12}},emits:["scroll"],setup(e,t){const n=ie({y:0,x:0});j(()=>[e.paintSize,e.fullSize],()=>{const{paintSize:i,fullSize:f}=e;n.x=Math.max(0,Math.min(n.x,f.width-i.width)),n.y=Math.max(0,Math.min(n.y,f.height-i.height))},{deep:!0}),j(n,()=>{t.emit("scroll",{y:n.y,x:n.x})});const l=g(()=>Xe(e.widthY,e.paintSize.height,e.fullSize.height,null,n.y)),a=g(()=>Xe(e.widthX,e.paintSize.width,e.fullSize.width,l.value,n.x));function o(i,f){const{paintSize:d,fullSize:h}=e;n.y=Math.max(0,Math.min(n.y+Math.floor(f),h.height-d.height)),n.x=Math.max(0,Math.min(n.x+Math.floor(i),h.width-d.width))}function s(i,f){const{paintSize:d,fullSize:h}=e;i!==void 0&&(n.x=Math.max(0,Math.min(Math.floor(i),h.width-d.width))),f!==void 0&&(n.y=Math.max(0,Math.min(Math.floor(f),h.height-d.height)))}return{scrollbarY:l,scrollbarX:a,scrollPos:Tt(n),scrollTo:s,scrollByDelta:o,handleMousedown:dn(o).handleMousedown,handleMousewheel:un(o).handleMousewheel,handleTrackMousedownY:qe(l,"y",s).handleTrackMousedown,handleTrackMousedownX:qe(a,"x",s).handleTrackMousedown}}});function fn(e,t,n,l,a,o){return p(),y("div",{class:b(e.$style.scrollable),style:x({width:e.paintSize.width+"px",height:e.paintSize.height+"px"}),onMousedown:t[2]||(t[2]=(...s)=>e.handleMousedown&&e.handleMousedown(...s)),onWheel:t[3]||(t[3]=(...s)=>e.handleMousewheel&&e.handleMousewheel(...s))},[ge(e.$slots,"default"),e.scrollbarY?(p(),y("div",{key:0,class:b(`${e.$style.track} ${e.$style.y}`),onMousedown:t[0]||(t[0]=(...s)=>e.handleTrackMousedownY&&e.handleTrackMousedownY(...s)),style:x({width:e.scrollbarY.fixedSize+"px",height:e.scrollbarY.trackSize+"px"})},[r("div",{class:b(e.$style.thumb),style:x({transform:`translate(0, ${e.scrollbarY.thumbPos}px)`,width:e.scrollbarY.fixedSize+"px",height:e.scrollbarY.thumbSize+"px"})},null,6)],38)):w("",!0),e.scrollbarX?(p(),y("div",{key:1,class:b(`${e.$style.track} ${e.$style.x}`),onMousedown:t[1]||(t[1]=(...s)=>e.handleTrackMousedownX&&e.handleTrackMousedownX(...s)),style:x({width:e.scrollbarX.trackSize+"px",height:e.scrollbarX.fixedSize+"px"})},[r("div",{class:b(e.$style.thumb),style:x({transform:`translate(${e.scrollbarX.thumbPos}px, 0)`,width:e.scrollbarX.thumbSize+"px",height:e.scrollbarX.fixedSize+"px"})},null,6)],38)):w("",!0)],38)}const Ke={};Ke.$style=an;var Je=E(cn,[["render",fn],["__cssModules",Ke]]);const Ze=new Map;function hn(e){var l;const t=(l=Ze.get(e))==null?void 0:l.deref();if(t)return t;const n=$(null);return pn(e).then(a=>{a&&(n.value=a)}).catch(()=>{}),Ze.set(e,new WeakRef(n)),n}async function pn(e){const t=await Ye(e),n=Y.readDatFile(e,t),l=await _e(n),a=await ce(et(e)),o=Ne(a,l,n);if(o)return{headers:o.headers,datFile:n}}function vn(e,t){const n=Y.readDatFile(e,t),l={headers:$(n.rowLength?[{name:null,offset:0,length:n.rowLength,type:G()}]:[]),datFile:n,name:et(e),path:e,columnStats:$([]),columnSelection:$(new Array(n.rowLength).fill(!1)),editHeader:$(null),selectedRow:$(null),rowSorting:$(null),scrollPos:ie({x:0,y:0}),referencedTables:g(()=>{var o;const a=new Map;a.set(l.name,$({headers:l.headers.value,datFile:l.datFile}));for(const s of l.headers.value){if(!((o=s.type.key)==null?void 0:o.table)||a.has(s.type.key.table))continue;const i=l.path.replace(`/${l.name}.`,`/${s.type.key.table}.`);a.set(s.type.key.table,hn(i))}return a})};return _e(l.datFile).then(async a=>{l.columnStats.value=a,await Qe(l)}),l}async function Qe(e){e.editHeader.value=null,e.headers.value=e.datFile.rowLength?[{name:null,offset:0,length:e.datFile.rowLength,type:G()}]:[];const t=await ce(e.name);try{yn(t,e)}catch(n){window.alert(`WARN: ${n.message}`)}finally{V(e.headers)}}function yn(e,t){let n=0;for(const l of e){const a=l.length||Mt(l,t.datFile);if(l.name==null){n+=a;continue}const o=oe(ae({},l),{length:a,offset:n});if(!(l.length?t.datFile.rowLength-o.offset>=o.length:zt(o,t.columnStats.value)))throw new Error("The schema is invalid.");Ut(o,t.columnSelection.value);const i=Ve(t.columnSelection.value,t.headers.value);Object.assign(i,o),Ae(t.columnSelection.value),n+=a}}function mn(e,t){const n=e.filter(({type:l})=>l.boolean||l.decimal||l.integer||l.key||l.string).map((l,a)=>({name:l.name||`Unknown${a+1}`,data:Y.readColumn(l,t)}));return n.unshift({name:"_rid",data:Array(t.rowCount).fill(void 0).map((l,a)=>a)}),Array(t.rowCount).fill(void 0).map((l,a)=>Object.fromEntries(n.map(o=>[o.name,o.data[a]])))}function et(e){return e.match(/[^/]+(?=\..+$)/)[0]}async function fe(e){await Nt(e.name,e.headers.value)}async function gn(e){await Yt(e.name)}const bn=z({props:{args:{type:Object,required:!0}},setup(e){return{text:g(()=>{var a,o,s,i,f,d,h;const{name:t,headers:n}=e.args;let l="";for(const c of n){if(c.name==null)break;let v="";if(c.type.boolean?v="bool":c.type.string?v="string":((a=c.type.integer)==null?void 0:a.size)===1?v=c.type.integer.unsigned?"u8":"i8":((o=c.type.integer)==null?void 0:o.size)===2?v=c.type.integer.unsigned?"u16":"i16":((s=c.type.integer)==null?void 0:s.size)===4?v=c.type.integer.unsigned?"u32":"i32":((i=c.type.integer)==null?void 0:i.size)===8?v=c.type.integer.unsigned?"u64":"i64":((f=c.type.decimal)==null?void 0:f.size)===4?v="f32":((d=c.type.decimal)==null?void 0:d.size)===8?v="f64":c.type.key&&(v=c.type.key.foreign?(h=c.type.key.table)!=null?h:"rid":t),c.type.array)l+=`  ${c.name||"_"}: [${v||"_"}]
`;else if(v)l+=`  ${c.name||"_"}: ${v}
`;else break}return`type ${t} {
${l}}
`})}}}),wn={class:"p-4 overflow-auto border-l flex-1 text-base"};function _n(e,t,n,l,a,o){return p(),y("div",wn,[r("pre",null,_(e.text),1)])}var $n=E(bn,[["render",_n]]);const Sn="_bar_5acw6_2";var kn={bar:Sn};const xn=z({setup(){const e=be("viewer"),t=g(()=>Be(e.columnSelection.value).map(s=>s.map(i=>String(i)).join(" ")));function n(){const{editHeader:s,columnSelection:i,headers:f}=e;s.value=Ve(i.value,f.value),Ae(i.value),V(f),V(i),fe(e)}function l(){const s=mn(e.headers.value,e.datFile);Ee.saveAs(new File([JSON.stringify(s,null,2)],`${e.name}.json`,{type:"application/json;charset=utf-8"}))}function a(){ne({id:"poe-dat-viewer@show-schema",title:"Schema",type:$n,args:{name:e.name,headers:JSON.parse(JSON.stringify(e.headers.value))}})}async function o(){await gn(e),await Qe(e)}return{rowSorting:e.rowSorting,selections:t,defineColumn:n,exportDataJson:l,showSchema:a,restoreSchema:o}}}),Cn={class:"flex"},Tn={key:0,class:"text-gray-400 italic px-1.5 self-center"},Mn=r("i",{class:"codicon codicon-add"},null,-1),zn=T(" Define column"),Rn=[Mn,zn],En=r("div",{class:"text-gray-300 px-1.5 mr-1 self-center"},"Selections",-1),In=["textContent"],Ln={class:"flex gap-x-1"},Pn=r("i",{class:"codicon codicon-discard"},null,-1),Hn=T(" Restore schema"),Dn=[Pn,Hn],Fn=r("i",{class:"codicon codicon-json"},null,-1),On=T(" Show schema"),An=[Fn,On],Bn=r("i",{class:"codicon codicon-database"},null,-1),Vn=T(" Export data"),Wn=[Bn,Vn];function Nn(e,t,n,l,a,o){return p(),y("div",{class:b(e.$style.bar)},[r("div",Cn,[e.selections.length===0?(p(),y("div",Tn,"No bytes selected")):e.selections.length===1?(p(),y("button",{key:1,class:"hover:bg-gray-300 hover:text-black px-1.5 flex gap-x-1 items-center",onClick:t[0]||(t[0]=(...s)=>e.defineColumn&&e.defineColumn(...s))},Rn)):e.selections.length>1?(p(),y(S,{key:2},[En,(p(!0),y(S,null,R(e.selections,s=>(p(),y("div",{class:"px-1.5 mr-1 font-mono bg-gray-200 text-black flex items-center",textContent:_(s)},null,8,In))),256))],64)):w("",!0)]),r("div",Ln,[e.rowSorting?(p(),y("button",{key:0,class:"bg-gray-600 hover:bg-gray-300 hover:text-black px-1.5 border border-gray-500",onClick:t[1]||(t[1]=s=>e.rowSorting=null)},"Clear sorting")):w("",!0),r("button",{class:"hover:bg-gray-300 hover:text-black px-1.5 flex gap-x-1 items-center",onClick:t[2]||(t[2]=(...s)=>e.restoreSchema&&e.restoreSchema(...s))},Dn),r("button",{class:"hover:bg-gray-300 hover:text-black px-1.5 flex gap-x-1 items-center",onClick:t[3]||(t[3]=(...s)=>e.showSchema&&e.showSchema(...s))},An),r("button",{class:"hover:bg-gray-300 hover:text-black px-1.5 flex gap-x-1 items-center",onClick:t[4]||(t[4]=(...s)=>e.exportDataJson&&e.exportDataJson(...s))},Wn)])],2)}const tt={};tt.$style=kn;var Yn=E(xn,[["render",Nn],["__cssModules",tt]]);function jn(e,t,n){const l=Y.readColumn(e,n),a=Array.from({length:n.rowCount},(o,s)=>s);return e.type.array?a.sort((o,s)=>{const i=l[o];return(l[s].length-i.length)*t}):e.type.boolean?a.sort((o,s)=>{const i=Number(l[o]),f=Number(l[s]);return(i-f)*t}):e.type.string?a.sort((o,s)=>{const i=l[o],f=l[s];return i.localeCompare(f)*t}):e.type.integer||e.type.decimal?a.sort((o,s)=>{const i=l[o];return(l[s]-i)*t}):e.type.key&&(e.type.key.foreign?a.sort((o,s)=>{const i=l[o];return((l[s]||0)-(i||0))*t}):a.sort((o,s)=>{const i=Number(l[o]);return(Number(l[s])-i)*t})),a}function Gn(e,t){t.text=String(e),t.color="#098658"}function Un(e,t){t.text=`[${e.join(", ")}]`,t.color="#098658"}function Xn(e,t){t.text=String(e),t.color="#0000ff"}function qn(e,t){t.text=`[${e.join(", ")}]`,t.color="#0000ff"}function Kn(e,t){e===""?(t.text="empty",t.color="#0000ff"):(t.text=String(e),t.color="#001080")}function Jn(e,t){t.text=`[${e.map(n=>JSON.stringify(n)).join(", ")}]`,t.color="#001080"}function nt(e,t){e===null?(t.text="<null, self>",t.color="#0000ff"):(t.text=`<${e}, self>`,t.color="#098658")}function Zn(e,t){t.text=`[${e.map(n=>`<${n}, self>`).join(", ")}]`,t.color="#098658"}function st(e,t){e===null?(t.text="<null>",t.color="#0000ff"):(t.text=`<${e}>`,t.color="#098658")}function Qn(e,t){t.text=`[${e.map(n=>`<${n}>`).join(", ")}]`,t.color="#098658"}function lt(e,t,n,l,a){const o=Ie.getFieldReader(t,n);if(a==null?void 0:a.header.type.array)throw new Error("Can't show array of arrays.");const s=a&&Ie.getFieldReader(a.header,a.datFile),i={text:"",color:""},f=(()=>{var v,u;const c=a!=null?a.header.type:t.type;if(t.type.array){if(c.boolean)return qn;if(c.string)return Jn;if(c.integer||c.decimal)return Un;if((v=c.key)==null?void 0:v.foreign)return Qn;if(c.key)return Zn}else{if(c.boolean)return Xn;if(c.string)return Kn;if(c.integer||c.decimal)return Gn;if((u=c.key)==null?void 0:u.foreign)return st;if(c.key)return nt}throw new Error("never")})();let d=0,h="";for(const c of l){let v=o(c);a?t.type.array?(v=v.map(u=>s(u)),f(v,i)):v===null?(t.type.key.foreign?st:nt)(v,i):(v=s(v),f(v,i)):f(v,i),h!==i.color&&(e.fillStyle=i.color,h=i.color),e.fillText(i.text,0,d),d+=I}}function es(e,t,n,l,a,o){e.fillStyle="#000";let s=0;for(const i of l){const f=n.dataFixed.subarray(i*n.rowLength+t.offset+a,i*n.rowLength+t.offset+o),d=Array.from(f,h=>h.toString(16).padStart(2,"0")).join(" ");e.fillText(d,a*(O*3),s),s+=I}}function ts(e,t,n,l,a){e.fillStyle="#000";const o=a.refArray,s=Math.max(o.keyForeign?n.fieldSize.KEY_FOREIGN:0,o.keySelf?n.fieldSize.KEY:0,o.string?n.fieldSize.STRING:0,o.numeric32?n.fieldSize.LONG:0,n.fieldSize.BYTE),i=Math.ceil(t.textLength/3);let f=0;for(const d of l){const h=n.readerFixed.getSizeT(d*n.rowLength+t.offset);if(h===0)e.fillText("[]",0,f);else{const c=n.readerFixed.getSizeT(d*n.rowLength+t.offset+n.memsize),v=n.dataVariable.subarray(c,c+Math.min(s*h,i)),u=Array.from(v,m=>m.toString(16).padStart(2,"0")).join(" ");e.fillText(`${h} { ${u} }`,0,f)}f+=I}}const U='Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',W=14,O=is(W,U),ns=rs(W,U),I=19,ss=3,X=1,ls=7,Q=Math.round(O*3),J=Q*2+ls*3;function as(e){const t=String(e-1).length;return Math.max(t,ss)}function at(e){return Math.ceil(as(e)*O)}function os(e){return at(e)+8*2}function is(e,t){const l=document.createElement("canvas").getContext("2d");return l.font=`${e}px ${t}`,l.measureText("0").width}function rs(e,t){const l=document.createElement("canvas").getContext("2d");l.font=`${e}px ${t}`,l.textBaseline="middle";const a=l.measureText("0");return e/2+(a.alphabeticBaseline!==void 0?-a.alphabeticBaseline:a.actualBoundingBoxDescent)}function ds(e){return 1+(e-W)/2+ns}function us(e){const{ctx:t}=e;if(t.fillStyle="#fff",t.fillRect(0,0,t.canvas.width,t.canvas.height),e.viewer.selectedRow.value!==null){const l=e.rows.indexOf(e.viewer.selectedRow.value);l!==-1&&(t.fillStyle="#bee3f8",t.fillRect(0,e.top+l*I,t.canvas.width,I))}t.save(),t.translate(-e.left,0),cs(t,e.columns),t.restore(),t.font=`${W}px ${U}`,t.fillStyle="#000";const n=fs(e.viewer,e.left,e.left+e.paintWidth);for(const l of n)t.save(),t.beginPath(),t.translate(l.left-e.left,0),t.rect(0,0,l.width,t.canvas.height),t.clip(),t.translate(O/2,e.top+ds(I)),l.exec(t,e.rows),t.restore();{const l=t.createLinearGradient(0,-16,0,4);l.addColorStop(0,"rgba(254,254,254,0.6)"),l.addColorStop(1,"transparent"),t.fillStyle=l,t.fillRect(0,0,t.canvas.width,6);const a=t.createLinearGradient(-16,0,4,0);a.addColorStop(0,"rgba(254,254,254,0.5)"),a.addColorStop(1,"transparent"),t.fillStyle=a,t.fillRect(0,0,6,t.canvas.height)}}function cs(e,t){for(const n of t)n.selected&&(e.fillStyle="#bee3f8",e.fillRect(n.leftPx+(n.border?X:0),0,n.widthPx,e.canvas.height)),n.border&&(e.fillStyle="#bdbdbd",e.fillRect(n.leftPx,0,X,e.canvas.height))}function fs(e,t,n){const l=e.headers.value,a=e.columnStats.value,o=e.datFile,s=[];let i=0;for(const f of l){const d=he(f);if(i+d.borderWidth>=t)if(f.type.byteView)if(f.type.byteView.array)s.push({left:i+(d.borderWidth?X:0),width:d.paddingWidth,exec:(h,c)=>ts(h,f,o,c,a[f.offset])});else{const h=Math.max(0,Math.floor((t-i)/(O*3))),c=Math.min(f.length,Math.ceil((n-i)/(O*3)));s.push({left:i+(d.borderWidth?X:0),width:d.paddingWidth,exec:(v,u)=>es(v,f,o,u,h,c)})}else s.push({left:i+(d.borderWidth?X:0),width:d.paddingWidth,exec:(h,c)=>{var v;if(((v=f.type.key)==null?void 0:v.viewColumn)!=null){const u=e.referencedTables.value.get(f.type.key.table).value;if(u){const m=u.headers.find(M=>M.name===f.type.key.viewColumn);if(m)return lt(h,f,o,c,{header:m,datFile:u.datFile})}}return lt(h,f,o,c)}});if(i+=d.borderWidth,i>=n)return s}return s}function he(e){const t=e.type.byteView&&!e.type.byteView.array?e.length*3-1:e.textLength;return{paddingWidth:Math.ceil((t+1)*O),borderWidth:Math.ceil((t+1)*O)+(e.offset>0?X:0),hasBorder:e.offset>0}}function hs(e){let t=0;for(const n of e)t+=he(n).borderWidth;return t}function ot(e,t,n,l){const a=[];let o=0;for(const s of e){const i=he(s);if(o+i.borderWidth>=n&&a.push({offset:s.offset,border:i.hasBorder,active:s===t,widthPx:i.borderWidth,leftPx:o,name:s.name}),o+=i.borderWidth,o>=l)return a}return a}const ps=z({props:{left:{type:Number,required:!0},width:{type:Number,required:!0},columns:{type:Array,required:!0}},setup(e){const t=$(0);let n=-1,l=[];const a=be("viewer");function o(h){n=h,l=[...a.columnSelection.value],Oe(a.columnSelection.value,n,n,a.headers.value),V(a.columnSelection),document.addEventListener("mouseup",c),document.addEventListener("mouseleave",c);function c(){n=-1,document.removeEventListener("mouseup",c),document.removeEventListener("mouseleave",c)}}function s(h,c){if(n===-1||c.buttons!==1)return;const{memsize:v}=a.datFile,u=h-n;u>=v?h=n+v*2-1:u>=4?h=n+8-1:u>=2&&(h=n+4-1),u<=-v?h=n-v*2+1:u<=-4?h=n-8+1:u<=-2&&(h=n-4+1),a.columnSelection.value=[...l],Oe(a.columnSelection.value,n,h,a.headers.value)}function i(h){const c=a.headers.value.find(v=>v.offset===h);a.editHeader.value===c&&(!c.type.byteView||c.type.byteView.array)?(t.value===0?t.value=1:t.value===1?t.value=-1:t.value===-1&&(t.value=1),a.rowSorting.value=jn(c,t.value,a.datFile)):(a.editHeader.value=c,t.value=0)}function f(h,c){c.preventDefault();const v=a.headers.value.find(u=>u.offset===h);v.textLength!=null&&(v.textLength=Math.max(1,v.textLength-Math.sign(c.deltaY)*(c.ctrlKey?4*3-2:1)),V(a.headers),fe(a))}return{headers:g(()=>ot(a.headers.value,a.editHeader.value,e.left,e.left+e.width)),selectStart:o,selectContinue:s,editHeader:i,handleHeaderWheel:f,headersRowStyle:g(()=>({transform:`translate(${-e.left}px, 0)`,lineHeight:Q+"px",fontFamily:U,fontSize:W+"px"})),colsRowStyle:g(()=>({transform:`translate(${-e.left}px, ${Q}px)`,lineHeight:Q+"px",fontFamily:U,fontSize:W+"px"})),statsRowStyle:g(()=>({transform:`translate(${-e.left}px, ${Q*2}px)`,fontFamily:U,fontSize:W+"px"}))}}}),vs={class:"datv-header-layer"},ys=["title","onClick","onWheel"],ms=T("\xA0"),gs={key:1,class:"bg-gray-500 text-gray-200 px-1"},bs=["onMousedown","onMouseenter","title","textContent"],ws={key:0,class:"datv-stat__line bg-yellow-500",style:{top:"0"}},_s={key:1,class:"datv-stat__line bg-green-500",style:{top:"7px"}},$s={key:2,class:"datv-stat__line bg-gray-800",style:{top:"14px"}},Ss={key:3,class:"datv-stat__line bg-pink-400",style:{top:"14px"}},ks=["textContent"],xs={key:1,class:"inline-flex mx-auto items-center h-full"},Cs=r("i",{class:"codicon codicon-key"},null,-1),Ts=[Cs];function Ms(e,t,n,l,a,o){return p(),y("div",vs,[r("div",{style:x(e.headersRowStyle),class:"absolute"},[(p(!0),y(S,null,R(e.headers,s=>(p(),y("button",{key:s.offset,class:b(["datv-header",{"datv-col--border":s.border,"datv-header--active":s.active}]),style:x({width:s.widthPx+"px",transform:`translate(${s.leftPx}px, 0)`}),title:s.name==null?"unidentified":s.name||"unnamed",onClick:i=>e.editHeader(s.offset),onWheel:i=>e.handleHeaderWheel(s.offset,i)},[s.name===null?(p(),y(S,{key:0},[ms],64)):s.name===""?(p(),y("span",gs,"?")):(p(),y(S,{key:2},[T(_(s.name),1)],64))],46,ys))),128))],4),r("div",{style:x(e.colsRowStyle),class:"absolute"},[(p(!0),y(S,null,R(e.columns,s=>(p(),y("button",{key:s.offset,class:b(["datv-byte",{"datv-col--border":s.border,"datv-byte--selected":s.selected}]),style:x({width:s.widthPx+"px",transform:`translate(${s.leftPx}px, 0)`}),onMousedown:i=>e.selectStart(s.offset),onMouseenter:i=>e.selectContinue(s.offset,i),title:String(s.offset),textContent:_(s.text)},null,46,bs))),128))],4),r("div",{style:x(e.statsRowStyle),class:"absolute datv-stats_row"},[(p(!0),y(S,null,R(e.columns,s=>(p(),y("div",{key:s.offset,class:b(["datv-stat",{"datv-col--border":s.border,"datv-byte--selected":s.selected}]),style:x({width:s.widthPx+"px",transform:`translate(${s.leftPx}px, 0)`})},[s.stat?(p(),y(S,{key:0},[s.stat.string?(p(),y("div",ws)):w("",!0),s.stat.array?(p(),y("div",_s)):w("",!0),s.stat.zero?(p(),y("div",$s)):s.stat.nullable?(p(),y("div",Ss)):w("",!0),r("div",{class:"datv-stat__max",textContent:_(s.stat.max)},null,8,ks)],64)):s.key?(p(),y("span",xs,Ts)):w("",!0)],6))),128))],4)])}var zs=E(ps,[["render",Ms]]);function Rs(e,t){let n=0;for(let l=0;l<e.length;l+=1){const a=t.indexOf(e[l]);a!==-1&&(n+=1,l===0&&a===0&&(n+=2),l>0&&a>0&&e[l-1]===t[a-1]&&(n+=1),l<e.length-1&&a<t.length-1&&e[l+1]===t[a+1]&&(n+=1))}return n}const it=/([A-Z][a-z]+|[A-Z]{2,}(?![a-z]{2,}))/g;function Es(e,t,n){const l=n.filter(d=>t<d.totalRows&&d.name!==e),a=e.match(it).map(d=>Le.exports.singular(d)),o=l.map((d,h)=>{const c=d.name.match(it).map(v=>Le.exports.singular(v));return[h,t-d.totalRows,Rs(c,a)]}),s=o[0].length,i=new Array(s).fill(1/0),f=new Array(s).fill(-1/0);for(let d=0;d<o.length;d+=1)for(let h=1;h<s;h+=1){const c=o[d][h];c<i[h]&&(i[h]=c),c>f[h]&&(f[h]=c)}for(let d=1;d<s;d+=1)if(i[d]!==f[d])for(let h=0;h<o.length;h+=1)o[h][d]=(o[h][d]-i[d])/(f[d]-i[d]);return o.sort((d,h)=>h.reduce((c,v)=>c+v)-h[0]-(d.reduce((c,v)=>c+v)-d[0])),o.map(([d])=>l[d])}function Is(e,t,n){const l=[],{fieldSize:a}=n,o=e.length;return o===a.ARRAY&&t.refArray&&l.push({label:"Array",value:"array"}),o===a.STRING&&t.refString&&l.push({label:"String",value:"string"}),o===a.KEY&&t.keySelf&&l.push({label:"Key (self)",value:"key_self"}),o===a.KEY_FOREIGN&&t.keyForeign&&l.push({label:"Key (foreign)",value:"key_foreign"}),o===4&&l.push({label:"Integer",value:"integer"}),o===4&&l.push({label:"Decimal",value:"decimal"}),o===1&&t.maxValue<=1&&l.push({label:"Boolean",value:"boolean"}),l}function Ls(e,t){const n=[];if(!e.type.array||!t.refArray)return n;const l=t.refArray;return l.string&&n.push({label:"String",value:"string"}),l.keySelf&&n.push({label:"Key (self)",value:"key_self"}),l.keyForeign&&n.push({label:"Key (foreign)",value:"key_foreign"}),l.numeric32&&n.push({label:"Integer - 4 bytes",value:"integer_4"}),l.numeric32&&n.push({label:"Decimal - 4 bytes",value:"decimal_4"}),l.boolean&&n.push({label:"Boolean",value:"boolean"}),n}function Ps(e){const t=$([]);return ce(e).then(n=>{t.value=n}).catch(()=>{}),t}const Hs=z({setup(){const e=be("viewer"),t=g(()=>e.editHeader.value&&Me(e.editHeader.value));{let u=null;j(t,m=>{u&&(u(),u=null),m&&(u=j(m,()=>{V(e.headers),fe(e)},{deep:!0}))})}const n=g(()=>e.columnStats.value[t.value.offset]),l=g({get(){const u=t.value.type;return u.array?"array":u.string?"string":u.key?u.key.foreign?"key_foreign":"key_self":u.integer?"integer":u.decimal?"decimal":u.boolean?"boolean":void 0},set(u){const m=t.value;m.type={},u==="array"?(m.type.array=!0,m.type.byteView={array:!0}):u==="string"?m.type.string={}:u==="key_foreign"?m.type.key={foreign:!0,table:null,viewColumn:null}:u==="key_self"?m.type.key={foreign:!1,table:e.name,viewColumn:null}:u==="integer"?m.type.integer={unsigned:!1,size:m.length}:u==="decimal"?m.type.decimal={size:m.length}:u==="boolean"&&(m.type.boolean={})}}),a=g({get(){const u=t.value.type;return u.string?"string":u.key?u.key.foreign?"key_foreign":"key_self":u.integer?`integer_${u.integer.size}`:u.decimal?`decimal_${u.decimal.size}`:u.boolean?"boolean":void 0},set(u){const m=t.value;m.type={array:!0},u==="string"?m.type.string={}:u==="key_foreign"?m.type.key={foreign:!0,table:null,viewColumn:null}:u==="key_self"?m.type.key={foreign:!1,table:e.name,viewColumn:null}:u==="integer_1"?m.type.integer={unsigned:!1,size:1}:u==="integer_2"?m.type.integer={unsigned:!1,size:2}:u==="integer_4"?m.type.integer={unsigned:!1,size:4}:u==="integer_8"?m.type.integer={unsigned:!1,size:8}:u==="decimal_4"?m.type.decimal={size:4}:u==="decimal_8"?m.type.decimal={size:8}:u==="boolean"&&(m.type.boolean={})}}),o=g(()=>{const u=[],m=t.value.type;return u.push({label:"Bytes",value:"bytes"}),m.array&&u.push({label:"Var. bytes",value:"array-bytes"}),u.push({label:"Data",value:"data",disabled:!l.value||l.value==="array"&&!a.value}),u}),s=g({get(){const u=t.value.type;return u.byteView?u.byteView.array?"array-bytes":"bytes":"data"},set(u){const m=t.value.type;u==="data"?m.byteView=void 0:m.byteView={array:u==="array-bytes"}}}),i=g(()=>{const u=Y.readColumn(t.value,e.datFile);return Math.max(...t.value.type.array?u.flat():u)}),f=g(()=>{let u;if(!t.value.type.key.foreign)return u=[{value:e.name,label:e.name}],u;if(u=[{value:null,label:"rid (unknown)"}],k.value.tableStats.length){const m=Es(e.name,i.value,k.value.tableStats);u.push(...m.map(M=>({value:M.name,label:M.name})))}else t.value.type.key.table!==null&&u.push({value:t.value.type.key.table,label:t.value.type.key.table});return u}),d=g(()=>{var u;return((u=t.value.type.key)==null?void 0:u.table)?Ps(t.value.type.key.table):null}),h=g(()=>{var M,le;if(!t.value.type.key)return[];const u=[{value:null,label:"row index"}],m=t.value.type.key.foreign?(le=(M=d.value)==null?void 0:M.value)!=null?le:[]:e.headers.value;return u.push(...m.filter(H=>H.name!==null&&H.name.length&&!H.type.array).map(H=>({label:H.name,value:H.name}))),u});function c(){e.editHeader.value=null}function v(){We(t.value,e.headers.value),e.editHeader.value=null,V(e.headers),fe(e)}return{isVisible:g(()=>e.editHeader.value!=null),HEADERS_HEIGHT:J,header:t,byteViewMode:s,dataType:l,arrayType:a,close:c,remove:v,viewModeOpts:o,keyTableOpts:f,keyDisplayColumnOpts:h,dataTypeOpts:g(()=>Is(t.value,n.value,e.datFile)),arrayTypeOpts:g(()=>Ls(t.value,n.value))}}}),Ds={key:0,style:{width:"300px"},class:"relative overflow-hidden"},Fs={class:"m-2 shadow border border-gray-300 bg-white absolute inset-0 flex flex-col"},Os={class:"p-2 bg-gray-100 text-gray-600 shadow flex items-center"},As=r("span",{class:"px-2"},"Column properties",-1),Bs=r("i",{class:"codicon codicon-close"},null,-1),Vs=[Bs],Ws={key:0,class:"p-4"},Ns={key:1,class:"p-4 overflow-auto"},Ys={class:"mb-4"},js=r("label",{for:"datv-header-name"},"Name",-1),Gs={class:"mb-4 flex items-baseline"},Us=r("div",{class:"mr-2"},"View mode",-1),Xs={class:"gap-x-px flex"},qs=["onClick","disabled","textContent"],Ks={class:"mb-4"},Js={class:"mb-2 flex justify-between items-baseline"},Zs=r("span",null,"Data type",-1),Qs={class:"inline-flex items-center"},el=["value"],tl={class:"ml-2 cursor-pointer"},nl={key:0,class:"mt-3"},sl=r("div",{class:"mb-1"},"of ...",-1),ll={class:"inline-flex items-center"},al=["value"],ol={class:"ml-2 cursor-pointer"},il={key:0,class:"mb-4"},rl={class:"inline-flex items-center"},dl=r("span",{class:"ml-2 cursor-pointer"},"Unsigned",-1),ul={key:1,class:"mb-4"},cl=r("label",{for:"datv-header-key-table"},"Table",-1),fl=["value"],hl=r("hr",{class:"my-6"},null,-1),pl={key:2,class:"mb-4"},vl=r("label",{for:"datv-header-key-column"},"Display Column",-1),yl=["value"],ml={key:3,class:"mb-4"},gl=r("label",{class:"mr-4"},"Width",-1),bl=T(" chars "),wl=r("div",{class:"italic mt-2"},"(move mouse over the column name in Viewer and use `ScrollWheel`, hold `Ctrl` to increase resize step)",-1);function _l(e,t,n,l,a,o){return e.isVisible?(p(),y("div",Ds,[r("div",{style:x({height:e.HEADERS_HEIGHT+"px"}),class:"bg-gray-100"},null,4),r("div",Fs,[r("div",Os,[As,r("button",{class:"border border-gray-400 rounded-full px-3",onClick:t[0]||(t[0]=s=>e.$emit("focus-editing-header"))},"Focus"),r("button",{onClick:t[1]||(t[1]=(...s)=>e.close&&e.close(...s)),class:"px-2 py-1 ml-auto",title:"Close"},Vs)]),e.header.name===null?(p(),y("div",Ws,[r("div",null,_(e.header.length)+" bytes of unidentified data",1)])):(p(),y("div",Ns,[r("div",Ys,[js,A(r("input",{id:"datv-header-name",placeholder:"Unnamed","onUpdate:modelValue":t[2]||(t[2]=s=>e.header.name=s),class:"border p-1 mt-1 w-full focus:border-blue-500",spellcheck:"false"},null,512),[[re,e.header.name,void 0,{trim:!0}]])]),r("div",Gs,[Us,r("div",Xs,[(p(!0),y(S,null,R(e.viewModeOpts,s=>(p(),y("button",{key:s.value,class:b(["px-2",e.byteViewMode===s.value?"bg-blue-600 text-white":"bg-gray-100 hover:bg-gray-300"]),onClick:i=>e.byteViewMode=s.value,disabled:s.disabled,textContent:_(s.label)},null,10,qs))),128))])]),r("div",Ks,[r("div",Js,[Zs,r("button",{class:"text-red-700 bg-red-100 px-2",onClick:t[3]||(t[3]=(...s)=>e.remove&&e.remove(...s))},"Delete")]),r("div",null,[(p(!0),y(S,null,R(e.dataTypeOpts,s=>(p(),y("div",{key:s.value,class:"mb-0.5"},[r("label",Qs,[A(r("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=i=>e.dataType=i),value:s.value},null,8,el),[[He,e.dataType]]),r("span",tl,_(s.label),1)])]))),128)),e.arrayTypeOpts.length?(p(),y("div",nl,[sl,(p(!0),y(S,null,R(e.arrayTypeOpts,s=>(p(),y("div",{key:s.value,class:"mb-0.5"},[r("label",ll,[A(r("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=i=>e.arrayType=i),value:s.value},null,8,al),[[He,e.arrayType]]),r("span",ol,_(s.label),1)])]))),128))])):w("",!0)])]),e.header.type.integer?(p(),y("div",il,[r("label",rl,[A(r("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>e.header.type.integer.unsigned=s)},null,512),[[Rt,e.header.type.integer.unsigned]]),dl])])):w("",!0),e.header.type.key?(p(),y("div",ul,[cl,A(r("select",{id:"datv-header-key-table",class:"border mt-1 w-full focus:border-blue-500","onUpdate:modelValue":t[7]||(t[7]=s=>e.header.type.key.table=s)},[(p(!0),y(S,null,R(e.keyTableOpts,s=>(p(),y("option",{key:s.label,value:s.value},_(s.label),9,fl))),128))],512),[[Pe,e.header.type.key.table]])])):w("",!0),hl,e.keyDisplayColumnOpts.length?(p(),y("div",pl,[vl,A(r("select",{id:"datv-header-key-column",class:"border mt-1 w-full focus:border-blue-500","onUpdate:modelValue":t[8]||(t[8]=s=>e.header.type.key.viewColumn=s)},[(p(!0),y(S,null,R(e.keyDisplayColumnOpts,s=>(p(),y("option",{key:s.label,value:s.value},_(s.label),9,yl))),128))],512),[[Pe,e.header.type.key.viewColumn]])])):w("",!0),e.dataType?(p(),y("div",ml,[gl,A(r("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>e.header.textLength=s),class:"border w-16 text-center"},null,512),[[re,e.header.textLength,void 0,{number:!0}]]),bl,wl])):w("",!0)]))])])):w("",!0)}var $l=E(Hs,[["render",_l]]);const Sl=Math.ceil(O*3);function kl(e,t,n,l,a){const o=[];let s=0;for(const i of n){const f=he(i);if(i.type.byteView&&!i.type.byteView.array){let d=s;for(let h=0;h<i.length;++h){const c=f.hasBorder&&h===0,v=O*3+(c?X:0);if(Math.ceil(d)+v<l){d+=v;continue}const u=i.offset+h;if(o.push({offset:u,selected:e[u],border:c,widthPx:Sl,leftPx:Math.ceil(d),text:String(u%100).padStart(2,"0"),stat:t[u],key:!1}),d+=v,Math.ceil(d)>=a)return o}}else s+f.borderWidth>=l&&o.push({offset:i.offset,selected:!1,border:f.hasBorder,widthPx:f.paddingWidth,leftPx:s,text:String(i.offset%100).padStart(2,"0"),key:i.type.key!=null});if(s+=f.borderWidth,s>=a)return o}return o}function xl(e,t){const n=e.map(a=>({max:a.maxValue.toString(16).padStart(2,"0"),array:!1,string:!1,nullable:!1,zero:a.maxValue===0})),{fieldSize:l}=t;for(let a=0;a<e.length;++a){const o=e[a];if(o.refString)for(let s=0;s<l.STRING;++s)n[a+s].string=!0;if(o.refArray)for(let s=0;s<l.ARRAY;++s)n[a+s].array=!0;if(o.nullableMemsize)for(let s=0;s<t.memsize;++s)n[a+s].nullable=!0}return n}const Cl="_rowsOverlay_wksgp_2";var Tl={rowsOverlay:Cl};const Ml=z({components:{ResizeObserver:je,CanvasScroll:Je,ViewerActions:Yn,ViewerHead:zs,HeaderProps:$l},emits:["update:kaState"],props:{args:{type:Object,required:!0},kaState:{type:Object,default:void 0}},setup(e,t){let n;e.kaState?n=e.kaState:(n=vn(e.args.fullPath,e.args.fileContent),t.emit("update:kaState",n)),Et("viewer",n);const l=q(null),a=q(null);ze(()=>{a.value.scrollTo(n.scrollPos.x,n.scrollPos.y)});const o=g(()=>n.rowSorting.value?n.rowSorting.value:Array.from({length:n.datFile.rowCount},(C,B)=>B)),s=q(0),i=q(0);function f(C){s.value=C.width,i.value=C.height}const{scrollPos:d}=n;function h(C){d.x=C.x,d.y=C.y}const c=g(()=>hs(n.headers.value)),v=g(()=>n.datFile.rowCount*I),u=g(()=>os(n.datFile.rowCount)),m=g(()=>Math.max(0,s.value-u.value)),M=g(()=>Math.max(0,i.value-J));j([m,M],()=>{const C=window.devicePixelRatio;l.value.style.width=m.value+"px",l.value.style.height=M.value+"px",l.value.width=m.value*C,l.value.height=M.value*C,l.value.getContext("2d",{alpha:!1}).scale(C,C),xe()});const le=g(()=>xl(n.columnStats.value,n.datFile)),H=g(()=>kl(n.columnSelection.value,le.value,n.headers.value,d.x,d.x+Math.min(c.value,m.value)));j([d,H,o,n.selectedRow],()=>{xe()});function xe(){const C=l.value.getContext("2d",{alpha:!1});us({left:d.x,paintWidth:m.value,top:pe.value.top,rows:pe.value.ids,columns:H.value,viewer:n,ctx:C})}const pe=g(()=>{const C=d.y,B=Math.ceil(M.value/I)+1,N=Math.floor(C/I);return{top:N*I-C,ids:o.value.slice(N,N+B)}});function yt(){const C=n.editHeader.value,N=ot(n.headers.value,null,0,0+1/0).find(Z=>Z.offset===C.offset);a.value.scrollTo(N.leftPx-m.value*.33,void 0)}function mt(C){const{selectedRow:B}=n,N=Math.floor((C.offsetY+d.y)/I),Z=o.value[N];B.value=B.value!==Z?Z:null}return{headerBlockStyle:g(()=>({height:J+"px",width:s.value+"px"})),headerOverlayContentStyle:g(()=>({left:u.value+"px",height:J+"px",width:m.value+"px"})),scrollableStyle:g(()=>({top:J+"px",left:u.value+"px"})),scrollablePaintSize:g(()=>({width:m.value,height:M.value})),scrollableFullSize:g(()=>({width:c.value,height:v.value})),rowsOverlayStyle:g(()=>({top:J+"px",width:u.value+"px",height:M.value+"px",fontFamily:U,fontSize:W+"px",lineHeight:I+"px"})),handleScroll:h,handleResize:f,renderItems:pe,canvasRef:l,renderColumns:H,scrollLeft:g(()=>d.x),rowsWidth:g(()=>Math.min(c.value,m.value)),LINE_HEIGHT:I,canvasScroll:a,rowsNumberWidth:at(n.datFile.rowCount)+"px",focusEditingHeader:yt,handleCanvasClick:mt}}}),zl={class:"flex flex-1"},Rl=["textContent"];function El(e,t,n,l,a,o){const s=L("viewer-actions"),i=L("viewer-head"),f=L("canvas-scroll"),d=L("resize-observer"),h=L("header-props");return p(),y(S,null,[D(s),r("div",zl,[D(d,{onResize:e.handleResize,class:"flex-1 min-h-0 relative"},{default:K(()=>[r("div",{class:"bg-gray-100 absolute",style:x(e.headerBlockStyle)},[D(i,{style:x(e.headerOverlayContentStyle),left:e.scrollLeft,width:e.rowsWidth,columns:e.renderColumns},null,8,["style","left","width","columns"])],4),D(f,{ref:"canvasScroll",class:"absolute bg-white",onScroll:e.handleScroll,style:x(e.scrollableStyle),"paint-size":e.scrollablePaintSize,"full-size":e.scrollableFullSize},{default:K(()=>[r("canvas",{ref:"canvasRef",onClick:t[0]||(t[0]=(...c)=>e.handleCanvasClick&&e.handleCanvasClick(...c))},null,512)]),_:1},8,["onScroll","style","paint-size","full-size"]),r("div",{class:b(e.$style.rowsOverlay),style:x(e.rowsOverlayStyle)},[r("div",{class:"absolute",style:x({transform:`translate(0, ${e.renderItems.top}px)`})},[(p(!0),y(S,null,R(e.renderItems.ids,(c,v)=>(p(),y("div",{key:c,style:x({transform:`translate(0, ${v*e.LINE_HEIGHT}px)`,width:e.rowsNumberWidth,position:"absolute"}),textContent:_(c)},null,12,Rl))),128))],4)],6)]),_:1},8,["onResize"]),D(h,{onFocusEditingHeader:e.focusEditingHeader},null,8,["onFocusEditingHeader"])])],64)}const rt={};rt.$style=Tl;var dt=E(Ml,[["render",El],["__cssModules",rt]]);const Il="_input_16vaf_2",Ll="_label_16vaf_20",Pl="_importVariant_16vaf_26";var Hl={input:Il,label:Ll,importVariant:Pl};const Dl=z({setup(){const e=$(localStorage.getItem("POE_PATCH_VER")||""),t=$(""),n=$(!1),l=$(!1);e.value&&!k.value&&o(),ue.value.length||s(),i();async function a(f){const d=f.target.files[0],h=new Uint8Array(await d.arrayBuffer()),c=d.name;ne({id:`file@${c}`,title:c,type:dt,args:{fileContent:h,fullPath:c}})}async function o(){let f;try{n.value=!0,f=await we(e.value,"_.index.bin")}finally{n.value=!1}try{await Kt(f),localStorage.setItem("POE_PATCH_VER",e.value)}catch(d){throw window.alert(d.message),d}}async function s(){l.value=!0;const d=await(await fetch("https://poe-bundles.snos.workers.dev/schema.min.json")).json();d.version===It.SCHEMA_VERSION?ue.value=d.tables:console.warn("Latest schema version is not supported."),l.value=!1}async function i(){const d=await(await fetch("https://raw.githubusercontent.com/poe-tool-dev/latest-patch-version/main/latest.txt")).text();t.value=d}return{poePatch:e,latestPoEPatch:t,isCdnImportRunning:n,isFetchingSchema:l,handleFile:a,cdnImport:o}}}),Fl={class:"p-4 overflow-auto border-l flex-1 text-base"},Ol={class:"flex gap-x-4 items-baseline mt-4"},Al=r("div",{class:"max-w-xl mb-4 font-semibold"},"Useful when a new league is released. While the update is still downloading, you can review files and fix schema directly from the update servers.",-1),Bl={class:"inline-flex items-baseline pb-2"},Vl={style:{width:"200px"},class:"my-1"},Wl={style:{width:"100px"},class:"m-1"},Nl={style:{width:"220px"},class:"my-1"},Yl=["disabled","loading"],jl={key:0},Gl=T(" Latest PoE patch is "),Ul={class:"px-1 border border-gray-300 rounded"},Xl={class:"flex gap-x-4 items-baseline mt-4 border-b pb-3"},ql={class:"flex items-baseline"},Kl=r("span",{class:"pr-2"},"or just",-1),Jl=r("label",{class:"bg-gray-100 py-1 px-2 cursor-pointer hover:bg-gray-300",style:{width:"200px"},for:"import-local-file"},"Pick a local dat file",-1),Zl={class:"mt-3 flex gap-x-2 items-center"},Ql={key:0,class:"codicon codicon-loading animate-spin"},ea={key:1,class:"codicon codicon-check"},ta={key:0},na={key:1},sa=r("a",{href:"https://github.com/poe-tool-dev/dat-schema",class:"underline",target:"_blank"},"github.com/poe-tool-dev/dat-schema",-1);function la(e,t,n,l,a,o){return p(),y("div",Fl,[r("div",Ol,[r("div",{class:b(e.$style.importVariant)},"1",2),r("div",null,[Al,r("div",Bl,[r("div",Vl,[r("input",{value:"patchcdn.pathofexile.com/",readonly:"",class:b(e.$style.input)},null,2),r("label",{class:b(e.$style.label)},"Patch CDN",2)]),r("div",Wl,[A(r("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.poePatch=s),placeholder:"3.12.x.x.x",class:b(e.$style.input)},null,2),[[re,e.poePatch,void 0,{trim:!0}]]),r("label",{class:b(e.$style.label)},"Patch #",2)]),r("div",Nl,[r("input",{value:"/Bundles2/_.index.bin",readonly:"",class:b(e.$style.input)},null,2),r("label",{class:b(e.$style.label)},"Index",2)]),r("button",{class:"ml-1 py-1 px-3 bg-blue-600 text-white hover:bg-blue-800",onClick:t[1]||(t[1]=(...s)=>e.cdnImport&&e.cdnImport(...s)),disabled:e.isCdnImportRunning,loading:e.isCdnImportRunning},_(e.isCdnImportRunning?"Wait...":"Import"),9,Yl)]),e.latestPoEPatch&&e.poePatch!==e.latestPoEPatch?(p(),y("div",jl,[Gl,r("code",Ul,_(e.latestPoEPatch),1)])):w("",!0)])]),r("div",Xl,[r("div",{class:b(e.$style.importVariant)},"2",2),r("div",ql,[Kl,Jl,r("input",{class:"hidden",id:"import-local-file",type:"file",accept:".dat,.dat64",onInput:t[2]||(t[2]=(...s)=>e.handleFile&&e.handleFile(...s))},null,32)])]),r("div",Zl,[e.isFetchingSchema?(p(),y("i",Ql)):(p(),y("i",ea)),r("div",null,[e.isFetchingSchema?(p(),y("span",ta," Downloading schema from ")):(p(),y("span",na," Downloaded schema from ")),sa])])])}const ut={};ut.$style=Hl;var ct=E(Dl,[["render",la],["__cssModules",ut]]);const ee=$("poe-dat-viewer@import");function te(e){ee.value=e}const P=$([{id:"poe-dat-viewer@import",title:"Import",type:ct,args:void 0,kaState:void 0}]);function ne(e){P.value.find(n=>n.id===e.id)||P.value.push({id:e.id,title:e.title,type:e.type,args:e.args,kaState:void 0}),te(e.id),V(P)}function aa(e){const t=P.value.findIndex(n=>n.id===e);e===ee.value&&(t+1<P.value.length?te(P.value[t+1].id):te(t!==0?P.value[t-1].id:null)),P.value=P.value.filter(n=>n.id!==e)}const Se=$(!1),ke=$(0),oa=$(0),se=$(0),ia=z({setup(){return{timeLeft:g(()=>{!se.value&&k.value.tableStats.length&&(se.value=Date.now()/1e3);const t=Date.now()/1e3,n=ke.value*(t-se.value)/k.value.tableStats.length;return Math.max(Math.ceil(n-t+se.value),0)}),totalTables:ke,isPreloading:Se,preloadDataTables:async()=>{se.value=0,oa.value=Date.now()/1e3,Se.value=!0,await Jt(ke),Se.value=!1},tables:g(()=>k.value.tableStats)}}}),ra={class:"p-4 overflow-auto border-l flex-1 text-base"},da={key:1,class:"flex items-center gap-x-4"},ua=r("i",{class:"codicon codicon-loading animate-spin"},null,-1),ca={key:0},fa={class:"border mt-4"},ha=r("thead",null,[r("tr",null,[r("th",{class:"border-b px-4"},"Name"),r("th",{class:"border-b px-4"},"Rows"),r("th",{class:"border-b px-8"},"Valid"),r("th",{class:"border-b px-4"},"More data")])],-1),pa={class:"border-b px-4"},va={class:"border-b px-4 text-right"},ya={key:0},ma=r("td",{colspan:"2",class:"px-8 py-4"},"Waiting for preload...",-1),ga=[ma];function ba(e,t,n,l,a,o){return p(),y("div",ra,[!e.isPreloading&&!e.tables.length?(p(),y("button",{key:0,class:"py-1 px-3 bg-blue-600 text-white hover:bg-blue-800",onClick:t[0]||(t[0]=(...s)=>e.preloadDataTables&&e.preloadDataTables(...s))},"Preload Data tables")):e.tables.length!==e.totalTables?(p(),y("div",da,[ua,r("div",null,[T(_(e.tables.length)+" / "+_(e.totalTables)+" tables",1),e.tables.length?(p(),y("span",ca,", estimated "+_(e.timeLeft)+" sec",1)):w("",!0)])])):w("",!0),r("table",fa,[ha,r("tbody",null,[(p(!0),y(S,null,R(e.tables,s=>(p(),y("tr",{key:s.name},[r("td",pa,_(s.name),1),r("td",va,_(s.totalRows),1),r("td",{class:b(["border-b px-4 text-center",{"bg-red-400":!s.headersValid}])},_(s.headersValid),3),r("td",{class:b(["border-b px-4 text-center",{"bg-yellow-300":s.increasedRowLength}])},_(s.increasedRowLength),3)]))),128)),e.tables.length?w("",!0):(p(),y("tr",ya,ga))])])])}var wa=E(ia,[["render",ba]]);const _a="_titlebar_v2ooq_2",$a="_tab_v2ooq_12",Sa="_active_v2ooq_21",ka="_rightBtn_v2ooq_31";var xa={titlebar:_a,tab:$a,active:Sa,rightBtn:ka};const Ca=z({setup(){const e=g(()=>P.value.map(l=>({id:l.id,title:l.title,isActive:l.id===ee.value})));function t(){ne({id:"poe-dat-viewer@import",title:"Import",type:ct,args:void 0})}function n(){ne({id:"poe-dat-viewer@data-tables",title:"Data Tables",type:wa,args:void 0})}return{tabs:e,setActiveTab:te,closeTab:aa,openImport:t,openDataTables:n,showDataTables:g(()=>k.value!=null&&ue.value.length)}}}),Ta={class:"flex overflow-hidden divide-x divide-gray-600"},Ma=["onClick","onMouseup"],za=["onClick"],Ra=r("i",{class:"codicon codicon-close"},null,-1),Ea=[Ra],Ia={class:"flex p-1.5 flex-shrink-0 gap-x-1"},La=r("i",{class:"codicon codicon-cloud-download"},null,-1),Pa=T(" Import"),Ha=[La,Pa],Da=r("i",{class:"codicon codicon-table"},null,-1),Fa=T(" Data Tables"),Oa=[Da,Fa];function Aa(e,t,n,l,a,o){return p(),y("div",{class:b(e.$style.titlebar)},[r("div",Ta,[(p(!0),y(S,null,R(e.tabs,s=>(p(),y("div",{key:s.id,class:b([e.$style.tab,{[e.$style.active]:s.isActive}])},[r("button",{class:"pl-3 h-full",onClick:i=>e.setActiveTab(s.id),onMouseup:Lt(i=>e.closeTab(s.id),["middle"])},_(s.title),41,Ma),r("button",{class:"mx-2 w-7 h-7 hover:bg-gray-500 text-center",title:"Close",onClick:i=>e.closeTab(s.id)},Ea,8,za)],2))),128))]),r("div",Ia,[r("button",{class:b(e.$style.rightBtn),onClick:t[0]||(t[0]=(...s)=>e.openImport&&e.openImport(...s))},Ha,2),e.showDataTables?(p(),y("button",{key:0,class:b(e.$style.rightBtn),onClick:t[1]||(t[1]=(...s)=>e.openDataTables&&e.openDataTables(...s))},Oa,2)):w("",!0)])],2)}const ft={};ft.$style=xa;var Ba=E(Ca,[["render",Aa],["__cssModules",ft]]);const Va=()=>z({components:{ResizeObserver:je,CanvasScroll:Je},props:{items:{type:Array,required:!0},itemHeight:{type:Number,required:!0},scrollableProps:{type:Object,default:()=>({})}},setup(e){const t=ie({width:0,height:0}),n=g(()=>({width:t.width,height:e.items.length*e.itemHeight}));function l(s){t.width=s.width,t.height=s.height}const a=q(null),o=g(()=>{var h,c;const s=(c=(h=a.value)==null?void 0:h.scrollPos.y)!=null?c:0,i=Math.ceil(t.height/e.itemHeight)+1,f=Math.floor(s/e.itemHeight),d=f*e.itemHeight-s;return e.items.slice(f,f+i).map((v,u)=>({top:d+u*e.itemHeight,item:v}))});return{handleResize:l,paintSize:t,fullSize:n,scrollable:a,renderItems:o}}}),Wa=Va();function Na(e,t,n,l,a,o){const s=L("canvas-scroll"),i=L("resize-observer");return p(),me(i,{onResize:e.handleResize,class:"relative"},{default:K(()=>[D(s,Pt({ref:"scrollable"},e.scrollableProps,{class:"absolute","paint-size":e.paintSize,"full-size":e.fullSize}),{default:K(()=>[ge(e.$slots,"default",{entries:e.renderItems})]),_:3},16,["paint-size","full-size"])]),_:3},8,["onResize"])}var Ya=E(Wa,[["render",Na]]);function ja(){return Date.now()}function Ga(e,t){const n=Date.now()-t;console.log(`${e}. Done in -> ${n} ms`)}function ht(e,t){const n=ja(),l=t();return Ga(e,n),l}const Ua="_treeToggle_2880p_2",Xa="_searchInput_2880p_12",qa="_itemBtn_2880p_25",Ka="_active_2880p_39";var Ja={treeToggle:Ua,searchInput:Xa,itemBtn:qa,active:Ka};function Za(){const e=$("");j(k,()=>{e.value=""});const t=g(()=>{if(!k.value)return[];if(e.value==="")return ht("Getting root dirs",()=>Ht(k.value.pathReps,k.value.dirsInfo)).map(o=>({label:o,fullPath:o,isFile:!1})).sort((o,s)=>o.label.localeCompare(s.label));const l=ht(`Getting "${e.value}" dir`,()=>Dt(e.value,k.value.pathReps,k.value.dirsInfo));return[{label:"../",fullPath:e.value.indexOf("/")===-1?"":e.value.split("/").slice(0,-1).join("/"),isFile:!1},...l.dirs.map(a=>({label:a.substr(e.value.length+1),fullPath:a,isFile:!1})).sort((a,o)=>a.label.localeCompare(o.label)),...l.files.map(a=>({label:a.substr(e.value.length+1),fullPath:a,isFile:!0,isActive:`bundles@${a}`===ee.value})).sort((a,o)=>a.label.localeCompare(o.label))]});async function n(l){if(!l.isFile)e.value=l.fullPath;else{const a=await Ye(l.fullPath);l.fullPath.endsWith(".dat")||l.fullPath.endsWith(".dat64")?ne({id:`bundles@${l.fullPath}`,title:l.label,type:dt,args:{fileContent:a,fullPath:l.fullPath}}):Ee.saveAs(new File([a],l.fullPath.substring(l.fullPath.lastIndexOf("/")+1),{type:"application/octet-stream"}))}}return{currentDir:e,tree:t,handleTreeNav:n}}const Qa=z({components:{VirtualScroll:Ya},setup(){const e=$(!0);function t(){e.value=!e.value}const n=g(()=>Boolean(k.value)),{tree:l,handleTreeNav:a,currentDir:o}=Za(),s=$(".dat64"),i=g(()=>o.value.startsWith("Data")?[".dat",".dat64",".datl",".datl64"].map(h=>({value:h,active:s.value===h,handleClick:()=>{s.value=h}})):null),f=$(""),d=g(()=>{const h=f.value.toLowerCase(),c=i.value?s.value:"";return l.value.filter(v=>v.label.toLowerCase().includes(h)&&(v.isFile?v.label.endsWith(c):!0))});return{showTree:e,toggleTree:t,tree:d,handleTreeNav:a,searchText:f,isIndexLoaded:n,extensionOpts:i}}}),eo={class:"flex p-1 items-center mb-px"},to=r("i",{class:"codicon codicon-list-flat"},null,-1),no=[to],so={key:0,class:"flex gap-x-1 border-b pb-1.5 px-2 justify-end"},lo=["onClick","textContent"],ao={key:1,class:"italic text-center text-gray-500 p-2"},oo={key:2,class:"italic text-center text-gray-500 p-2"},io=["onClick"],ro={key:0,class:"codicon codicon-folder pr-3"};function uo(e,t,n,l,a,o){const s=L("virtual-scroll");return p(),y("div",{class:"layout-column flex-shrink-0",style:x({width:e.showTree?"300px":void 0})},[r("div",eo,[r("button",{title:"Toggle tree visibility",class:b(e.$style.treeToggle),onClick:t[0]||(t[0]=(...i)=>e.toggleTree&&e.toggleTree(...i))},no,2),e.showTree?A((p(),y("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=i=>e.searchText=i),placeholder:"Search in current folder",class:b(e.$style.searchInput),type:"search",spellcheck:"false"},null,2)),[[re,e.searchText,void 0,{trim:!0}]]):w("",!0)]),e.showTree?(p(),y(S,{key:0},[e.extensionOpts?(p(),y("div",so,[(p(!0),y(S,null,R(e.extensionOpts,i=>(p(),y("button",{key:i.value,onClick:i.handleClick,class:b(["px-2",i.active?"bg-gray-200":"hover:bg-gray-100"]),textContent:_(i.value)},null,10,lo))),128))])):w("",!0),e.isIndexLoaded?w("",!0):(p(),y("div",ao,"Waiting for Index bundle...")),e.isIndexLoaded&&!e.tree.length?(p(),y("div",oo,"No results found")):w("",!0),D(s,{class:"flex-1","scrollable-props":{style:"background: #fff;",widthY:10},items:e.tree,"item-height":22},{default:K(i=>[(p(!0),y(S,null,R(i.entries,f=>(p(),y("button",{key:f.item.fullPath,class:b({[e.$style.itemBtn]:!0,[e.$style.active]:f.item.isActive}),style:x({transform:`translate(0, ${f.top}px`}),onClick:d=>e.handleTreeNav(f.item)},[f.item.isFile?w("",!0):(p(),y("i",ro)),T(_(f.item.label),1)],14,io))),128))]),_:1},8,["items"])],64)):w("",!0)],4)}const pt={};pt.$style=Ja;var co=E(Qa,[["render",uo],["__cssModules",pt]]);const fo="_notification_eng9d_2";var ho={notification:fo};const po=z({setup(){return F}}),vo=r("div",{class:"bg-gray-200 h-1"},null,-1),yo={class:"p-3"},mo={class:"font-semibold truncate"},go={class:"text-grey text-sm"},bo=T("Downloading...");function wo(e,t,n,l,a,o){return e.active?(p(),y("div",{key:0,class:b(e.$style.notification)},[e.totalSize?(p(),y(S,{key:0},[vo,r("div",{class:"bg-blue-500 h-1 absolute top-0",style:x({width:`${e.received/e.totalSize*100}%`})},null,4)],64)):w("",!0),r("div",yo,[r("div",mo,_(e.bundleName),1),r("div",go,[e.totalSize?(p(),y(S,{key:0},[T(_((e.totalSize/1e6).toFixed(1))+" MB",1)],64)):(p(),y(S,{key:1},[bo],64))])])],2)):w("",!0)}const vt={};vt.$style=ho;var _o=E(po,[["render",wo],["__cssModules",vt]]),$o="/poe-dat-viewer/assets/discord-badge.9068e0df.svg";const So=z({components:{IndexTree:co,ViewerTabs:Ba,DownloadProgress:_o},setup(){return{activeTab:g(()=>P.value.find(t=>t.id===ee.value)),appVersion:"3.3.0"}}}),ko={class:"layout-column flex-1 min-w-0"},xo={class:"layout-column flex-1 min-h-0"},Co={key:1,class:"bg-gray-50 flex-1 text-lg text-gray-500 flex items-center justify-center"},To={class:"app-footer"},Mo=r("a",{class:"q-link text-white border-b",href:"https://github.com/SnosMe/poe-dat-viewer"},"GitHub",-1),zo=r("a",{href:"https://discord.gg/SJjBdT3",class:"flex ml-8"},[r("img",{src:$o})],-1);function Ro(e,t,n,l,a,o){const s=L("index-tree"),i=L("viewer-tabs"),f=L("download-progress");return p(),y(S,null,[D(s),r("div",ko,[D(i),r("div",xo,[e.activeTab?(p(),me(Re(e.activeTab.type),{args:e.activeTab.args,key:e.activeTab.id,"ka-state":e.activeTab.kaState,"onUpdate:ka-state":t[0]||(t[0]=d=>e.activeTab.kaState=d)},null,8,["args","ka-state"])):(p(),y("div",Co,"The viewer is ready to fulfill your wishes \u{1F47E}"))]),r("div",To,[r("div",null,[T("Made by Alexander Drozdov, v"+_(e.appVersion)+" ",1),Mo]),zo])]),D(f)],64)}var Eo=E(So,[["render",Ro]]);Ft(Eo).mount("#app");
